<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>LUXIOU | å…¨æ¯é›·è¾¾è¯Šæ–­ç³»ç»Ÿ</title>
    <style>
        :root { --primary: #00f2fe; --highlight: #00ff88; --bg: #0b0f19; --card: rgba(22, 30, 46, 0.98); }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { background: var(--bg); color: #e2e8f0; font-family: -apple-system, sans-serif; margin: 0; padding: 10px; padding-top: 75px; overflow-x: hidden; }
        
        .back-btn { position: fixed; top: 15px; left: 15px; z-index: 5000; background: rgba(0,0,0,0.6); color: #fff; padding: 10px 18px; border-radius: 50px; text-decoration: none; font-size: 13px; border: 1px solid rgba(255,255,255,0.4); backdrop-filter: blur(10px); font-weight: bold; }

        .case-wrap { max-width: 600px; margin: 0 auto; background: rgba(30, 41, 59, 0.5); border-radius: 24px; padding: 12px; border: 1px solid rgba(255,255,255,0.05); }
        
        /* é¡¶éƒ¨å¯¼èˆª */
        .category-box { display: flex; gap: 8px; overflow-x: auto; margin-bottom: 15px; scrollbar-width: none; }
        .cat-item { flex: 0 0 auto; padding: 8px 16px; background: var(--card); border-radius: 50px; font-size: 11px; color: #64748b; border: 1px solid #333; }
        .cat-item.active { background: var(--primary); color: #000; font-weight: bold; }

        /* æ ¸å¿ƒæŒ‡æ ‡ */
        .metrics-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 15px; }
        .metric-item { background: var(--card); padding: 12px 5px; border-radius: 12px; text-align: center; border: 1px solid rgba(255,255,255,0.05); }
        .metric-item span { display: block; font-size: 10px; color: #64748b; }
        .metric-item strong { display: block; font-size: 16px; color: var(--primary); font-weight: 800; }

        /* å…¨æ¯å¯¹æ¯”åŒº */
        .comparison-stage { position: relative; width: 100%; height: 520px; background: #000; border-radius: 20px; overflow: hidden; display: flex; align-items: center; justify-content: center; }
        .img-layer { position: absolute; width: 100%; height: 100%; background-size: contain; background-repeat: no-repeat; background-position: center; transition: 0.3s ease; }
        #radarCanvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 15; pointer-events: none; }

        .side-params { position: absolute; z-index: 20; display: flex; width: 100%; height: 100%; pointer-events: none; }
        .params-column { position: absolute; top: 0; display: flex; flex-direction: column; gap: 0; pointer-events: auto; }
        .col-left { left: 0px; }
        .col-right { right: 0px; text-align: right; }

        /* å¤§å­—å·æ ‡ç­¾ */
        .param-tag { font-size: 11px; padding: 8px 12px; min-width: 115px; background: rgba(0,0,0,0.85); border-bottom: 0.25px solid rgba(255,255,255,0.05); display: flex; flex-direction: column; }
        .tag-l { border-left: 5px solid #fff; }
        .tag-r { border-right: 5px solid var(--primary); align-items: flex-end; }
        .param-tag label { color: #888; font-size: 10px; margin-bottom: 2px; }
        .param-tag b { font-size: 18px; color: var(--primary); font-weight: 900; letter-spacing: 0.5px; }
        .diff-val { font-size: 12px; color: var(--highlight); font-weight: 900; margin-top: 1px; }

        .slider-wrap { margin-top: 15px; padding: 15px; background: var(--card); border-radius: 15px; border: 1px solid #333; }
        .slider-label { display: flex; justify-content: space-between; font-size: 11px; color: var(--primary); font-weight: bold; margin-bottom: 10px; }
        input[type=range] { width: 100%; -webkit-appearance: none; background: #222; height: 6px; border-radius: 5px; outline: none; }
        input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; width: 28px; height: 28px; background: var(--primary); border-radius: 50%; box-shadow: 0 0 15px var(--primary); cursor: pointer; }

        .action-group { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-top: 15px; }
        .btn-act { background: var(--card); border: 1px solid #333; border-radius: 12px; padding: 12px; text-align: center; font-size: 11px; color: #e2e8f0; cursor: pointer; }
        .btn-save { background: var(--primary); color: #000; font-weight: bold; border: none; }

        #vaultList { height: 200px; overflow-y: auto; margin-top: 15px; }
        .vault-item { background: #1e293b; padding: 15px; border-radius: 12px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; border: 1px solid #333; }
    </style>
</head>
<body>
    <a href="./index.html" class="back-btn">è¿”å›ä¸­æ¢</a>
    <div class="case-wrap">
        <div class="category-box">
            <div class="cat-item active" onclick="loadCaseData('posture', this)">ä½“æ€çŸ«æ­£</div>
            <div class="cat-item" onclick="loadCaseData('shoulder', this)">ç›´è§’è‚©</div>
            <div class="cat-item" onclick="loadCaseData('postpartum', this)">äº§ååº·å¤</div>
            <div class="cat-item" onclick="loadCaseData('muscle', this)">å¢è‚Œä¸“åœº</div>
            <div class="cat-item" onclick="loadCaseData('abs', this)">é©¬ç”²çº¿</div>
        </div>

        <div class="metrics-grid">
            <div class="metric-item"><span>ä½“é‡</span><strong id="val_weight">-2.1kg</strong></div>
            <div class="metric-item"><span>ä½“è„‚</span><strong id="val_fat">-3.5%</strong></div>
            <div class="metric-item"><span>å‘¨æœŸ</span><strong id="val_week">8å‘¨</strong></div>
        </div>

        <div class="comparison-stage">
            <div class="img-layer" id="layerB" style="background-image:url('case_before.jpg'); opacity:1;"></div>
            <div class="img-layer" id="layerA" style="background-image:url('case_after.jpg'); opacity:0;"></div>
            <canvas id="radarCanvas"></canvas>
            <div class="side-params">
                <div class="params-column col-left" id="colL"></div>
                <div class="params-column col-right" id="colR"></div>
            </div>
        </div>

        <div class="slider-wrap">
            <div class="slider-label"><span>BEFORE</span><span>æ»‘åŠ¨æŸ¥çœ‹é›·è¾¾èœ•å˜å¼•å¯¼</span><span>AFTER</span></div>
            <input type="range" min="0" max="100" value="0" id="fadeSlider">
        </div>

        <div class="action-group">
            <div class="btn-act" onclick="document.getElementById('fileB').click()">ğŸ“· ä¼ å‰ç…§<input type="file" id="fileB" hidden onchange="loadImg(this,'layerB')"></div>
            <div class="btn-act" onclick="document.getElementById('fileA').click()">ğŸ“· ä¼ åç…§<input type="file" id="fileA" hidden onchange="loadImg(this,'layerA')"></div>
            <div class="btn-act btn-save" onclick="saveToVault()">ğŸ’¾ ä¿å­˜å…¥åº“</div>
        </div>

        <div id="vaultList"></div>
    </div>

    <script>
        // è§£å‰–å­¦åæ ‡æ˜ å°„è¡¨ï¼šæ ¹æ®äººä½“ä¸­å¿ƒç‚¹å®šä½ (x, y ç™¾åˆ†æ¯”)
        const coordinateMap = {
            posture: [0.15, 0.25, 0.35, 0.55, 0.65, 0.78], // å¯¹åº” 6 ä¸ªç»´åº¦æŒ‡å‘çš„è§£å‰–ç‚¹
            shoulder: [0.22, 0.2, 0.28, 0.35, 0.18, 0.4],
            postpartum: [0.55, 0.6, 0.5, 0.65, 0.45, 0.7]
        };

        const canvas = document.getElementById('radarCanvas');
        const ctx = canvas.getContext('2d');

        function drawRadar(targets) {
            canvas.width = canvas.offsetWidth; canvas.height = canvas.offsetHeight;
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            // çº¿æ¡æ ·å¼ï¼šé«˜èƒ½è§å…‰è‰²
            ctx.strokeStyle = "rgba(0, 255, 136, 0.6)"; 
            ctx.lineWidth = 1.5; ctx.setLineDash([6, 4]);

            targets.forEach((yPct, i) => {
                const startY = (i * 55) + 35; // å¯¹åº”åˆ—è¡¨é¡¹å‚ç›´ä¸­å¿ƒ
                // å·¦ä¾§è¿çº¿
                ctx.beginPath(); ctx.moveTo(115, startY);
                ctx.lineTo(canvas.width * 0.5, canvas.height * yPct); ctx.stroke();
                // å³ä¾§è¿çº¿
                ctx.beginPath(); ctx.moveTo(canvas.width - 115, startY);
                ctx.lineTo(canvas.width * 0.5, canvas.height * yPct); ctx.stroke();
                // ç»˜åˆ¶è§£å‰–é”šç‚¹
                ctx.fillStyle = "#00ff88"; ctx.setLineDash([]);
                ctx.beginPath(); ctx.arc(canvas.width * 0.5, canvas.height * yPct, 4, 0, Math.PI*2); ctx.fill();
                ctx.strokeStyle = "#fff"; ctx.stroke();
            });
        }

        function loadCaseData(key, el) {
            const d = {
                posture: { labels: ["å¤´å‰å¼•", "åœ†è‚©è§’", "é«˜ä½è‚©", "éª¨ç›†å‰", "è„ŠæŸ±ä¾§", "å‡èƒ¯å®½"], pre: ["8.5cm","25Â°","2.5cm","18Â°","12Â°","98cm"], post: ["2.1cm","8Â°","0.2cm","7Â°","2Â°","91cm"], units: ["cm","Â°","cm","Â°","Â°","cm"] },
                shoulder: { labels: ["ä¸€å­—è‚©", "æ–œæ–¹è‚Œ", "é”éª¨å±•", "è‚©å³°å·®", "é¢ˆæ ¹å®½", "å¹³æ•´åº¦"], pre: ["145Â°","5.8cm","150Â°","1.5cm","14cm","12mm"], post: ["178Â°","3.1cm","175Â°","0.2cm","11.5cm","4mm"], units: ["Â°","cm","Â°","cm","cm","mm"] }
            }[key] || { labels: ["ç»´åº¦1", "ç»´åº¦2", "ç»´åº¦3", "ç»´åº¦4", "ç»´åº¦5", "ç»´åº¦6"], pre: Array(6).fill("-"), post: Array(6).fill("-"), units: Array(6).fill("") };

            if(el) { document.querySelectorAll('.cat-item').forEach(i => i.classList.remove('active')); el.classList.add('active'); }
            let hL = '', hR = '';
            for(let i=0; i<6; i++) {
                hL += `<div class="param-tag tag-l"><label>${d.labels[i]}(å‰)</label><b>${d.pre[i]}</b></div>`;
                hR += `<div class="param-tag tag-r"><label>${d.labels[i]}(å)</label><b>${d.post[i]}</b><div class="diff-val">æ”¹å–„ä¸­</div></div>`;
            }
            document.getElementById('colL').innerHTML = hL;
            document.getElementById('colR').innerHTML = hR;
            // å»¶è¿Ÿé‡ç»˜ç¡®ä¿ DOM åŠ è½½
            setTimeout(() => drawRadar(coordinateMap[key] || [0.5,0.5,0.5,0.5,0.5,0.5]), 100);
        }

        function loadImg(i, t) { if(i.files[0]){ const r=new FileReader(); r.onload=e=>document.getElementById(t).style.backgroundImage=`url('${e.target.result}')`; r.readAsDataURL(i.files[0]); } }
        document.getElementById('fadeSlider').oninput = e => {
            const v = e.target.value / 100;
            document.getElementById('layerA').style.opacity = v;
            document.getElementById('layerB').style.opacity = 1 - v;
        };
        window.onload = () => loadCaseData('posture');
    </script>
</body>
</html>
