<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>ç§äººå®šåˆ¶é«˜ç«¯è¯¾ç¨‹</title>
    <style>
        /* é¡¶çº§é¦™æ§Ÿé»‘é‡‘é…è‰² */
        :root { --primary: #D4AF37; --accent: #C5A059; --bg: #050505; --surface: #121212; --text-main: #E2E8F0; --text-sub: #8A92A3; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; margin: 0; padding: 0; }
        
        body { background: var(--bg); color: var(--text-main); font-family: "DIN Alternate", "Helvetica Neue", sans-serif; overflow-x: hidden; -webkit-font-smoothing: antialiased; }
        
        .header-brand { width: 100%; height: 60px; display: flex; align-items: center; justify-content: center; background: rgba(5, 5, 5, 0.85); position: sticky; top: 0; z-index: 50; border-bottom: 1px solid rgba(212, 175, 55, 0.15); backdrop-filter: blur(15px);}
        .brand-text { font-size: 18px; font-weight: 900; color: var(--primary); letter-spacing: 2px; }
        
        .intro-sec { padding: 25px 20px 15px; text-align: center; }
        .main-title { font-size: 22px; font-weight: 900; color: #fff; margin-bottom: 8px; letter-spacing: 1px;}
        .sub-title { font-size: 12px; color: var(--text-sub); line-height: 1.5; }

        .gallery-container { padding: 10px 15px 100px; display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        
        .sol-card { position: relative; height: 180px; border-radius: 16px; overflow: hidden; display: flex; flex-direction: column; justify-content: flex-end; cursor: pointer; border: 1px solid rgba(255,255,255,0.08); box-shadow: inset 0 0 30px rgba(0,0,0,0.8), 0 10px 20px rgba(0,0,0,0.5); transition: 0.3s; background: linear-gradient(145deg, #18181C, #050505); }
        .sol-card:active { transform: scale(0.96); border-color: var(--primary); box-shadow: 0 5px 15px rgba(212,175,55,0.2); }
        
        .watermark { position: absolute; right: -20px; bottom: -20px; width: 140px; height: 140px; opacity: 0.04; z-index: 1; pointer-events: none; }
        .watermark svg { width: 100%; height: 100%; fill: none; stroke: var(--primary); stroke-width: 1; }

        .card-content { padding: 15px; position: relative; z-index: 2; }
        .c-icon { margin-bottom: 10px; display: flex; align-items: center; }
        .c-icon svg { width: 28px; height: 28px; stroke: var(--primary); filter: drop-shadow(0 0 6px rgba(212,175,55,0.8)); }
        .c-title { font-size: 15px; font-weight: 900; color: #fff; margin-bottom: 6px; letter-spacing: 1px;}
        .c-desc { font-size: 11px; color: #888; line-height: 1.4; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }

        .detail-modal { position: fixed; top: 100vh; left: 0; width: 100%; height: 100vh; background: var(--bg); z-index: 999; transition: top 0.5s cubic-bezier(0.2, 0.8, 0.2, 1); display: flex; flex-direction: column; }
        .detail-modal.show { top: 0; }

        .modal-header { height: 60px; display: flex; justify-content: space-between; align-items: center; padding: 0 20px; background: rgba(5,5,5,0.95); border-bottom: 1px solid rgba(212,175,55,0.2); backdrop-filter: blur(10px); }
        .modal-title { font-size: 16px; font-weight: bold; color: var(--primary); }
        .close-btn { color: #fff; font-size: 24px; font-weight: bold; background: none; border: none; padding: 0 10px; }

        .modal-body { flex: 1; overflow-y: auto; padding: 20px 20px 140px; -webkit-overflow-scrolling: touch; }
        
        .hero-banner { border: 1px solid rgba(212, 175, 55, 0.3); border-radius: 16px; padding: 25px 20px; margin-bottom: 25px; background: linear-gradient(145deg, #16161A, #050505); box-shadow: 0 10px 30px rgba(0,0,0,0.5); position: relative; overflow: hidden;}
        .hero-watermark { position: absolute; right: -30px; top: -30px; width: 150px; height: 150px; opacity: 0.03; pointer-events: none; }
        .hero-watermark svg { width: 100%; height: 100%; fill: none; stroke: var(--primary); stroke-width: 1; }
        .m-hero-title { font-size: 22px; font-weight: 900; color: #fff; margin-bottom: 10px; letter-spacing: 1px; position: relative; z-index: 2;}
        .m-hero-desc { font-size: 13px; color: var(--text-sub); line-height: 1.6; position: relative; z-index: 2;}
        
        .phase-title-main { font-size: 14px; color: #888; margin-bottom: 15px; display: flex; align-items: center; gap: 8px; border-top: 1px solid #222; padding-top: 25px; letter-spacing: 1px;}
        
        .phase-box { border: 1px solid rgba(255,255,255,0.05); border-radius: 12px; padding: 20px; position: relative; margin-bottom: 20px; background: #0a0a0c; cursor: pointer; transition: 0.3s; box-shadow: 0 5px 15px rgba(0,0,0,0.5); }
        .phase-box.selected { border-color: rgba(212,175,55,0.6); background: linear-gradient(145deg, rgba(212,175,55,0.08), #050505); box-shadow: 0 10px 25px rgba(212,175,55,0.15); }
        
        .combo-box { border: 1px dashed rgba(212,175,55,0.4); background: linear-gradient(145deg, #18150D, #0A0A0C); margin-top: 30px; }
        .combo-box.selected { border: 1px solid var(--primary); background: linear-gradient(145deg, #2A2210, #0A0A0C); box-shadow: 0 10px 25px rgba(212,175,55,0.25); }

        .check-circle { position: absolute; top: 20px; right: 20px; width: 22px; height: 22px; border-radius: 50%; border: 2px solid #444; display: flex; align-items: center; justify-content: center; transition: 0.3s; }
        .phase-box.selected .check-circle { border-color: var(--primary); background: var(--primary); }
        .check-circle::after { content: 'âœ“'; color: #000; font-size: 14px; font-weight: 900; opacity: 0; transition: 0.3s; margin-top: 2px;}
        .phase-box.selected .check-circle::after { opacity: 1; }

        .p-step { font-size: 11px; color: #888; font-weight: bold; letter-spacing: 2px; margin-bottom: 12px;}
        .phase-box.selected .p-step { color: var(--primary); }
        
        .p-cycle-highlight { display: flex; flex-direction: column; gap: 6px; background: linear-gradient(90deg, rgba(212, 175, 55, 0.1), transparent); border-left: 3px solid #444; padding: 10px 12px; margin-bottom: 18px; border-radius: 0 8px 8px 0; transition: 0.3s; }
        .phase-box.selected .p-cycle-highlight { border-left-color: var(--primary); background: linear-gradient(90deg, rgba(212, 175, 55, 0.2), transparent); }
        .cycle-row { display: flex; align-items: center; gap: 8px; font-size: 14px; font-weight: 900; color: #888; letter-spacing: 1px; transition: 0.3s;}
        .phase-box.selected .cycle-row { color: #fff; }
        .cycle-row .icon { font-size: 16px; color: #555; margin-top: -2px; transition: 0.3s;}
        .phase-box.selected .cycle-row .icon { color: var(--primary); }
        .cycle-row .highlight-text { color: #888; }
        .phase-box.selected .cycle-row .highlight-text { color: var(--primary); text-shadow: 0 0 10px rgba(212,175,55,0.4); }
        
        .p-name { font-size: 18px; font-weight: 900; color: #888; margin-bottom: 15px; transition: 0.3s;}
        .phase-box.selected .p-name { color: #fff; }
        
        .sales-points { display: flex; flex-direction: column; gap: 12px; opacity: 0.5; transition: 0.3s; }
        .phase-box.selected .sales-points { opacity: 1; }
        .sp-row { display: flex; align-items: flex-start; gap: 10px; font-size: 13px; line-height: 1.6; }
        .sp-tag { flex-shrink: 0; font-size: 11px; font-weight: bold; padding: 3px 8px; border-radius: 4px; border: 1px solid; }
        .tag-goal { color: #aaa; border-color: #555; background: rgba(255,255,255,0.05); }
        .tag-tech { color: #C5A059; border-color: rgba(212,175,55,0.4); background: rgba(212,175,55,0.05); }
        .tag-feel { color: #000; border-color: var(--primary); background: var(--primary); }
        .sp-text { color: #ccc; }
        .sp-text strong { color: var(--primary); font-weight: bold; text-shadow: 0 0 8px rgba(212,175,55,0.3); }

        /* æ•™ç»ƒé…è¯¾æ»‘åŠ¨æ­¥è¿›å™¨ */
        .custom-builder { margin-top: 15px; border-top: 1px dashed rgba(212,175,55,0.3); padding-top: 15px; display: flex; flex-direction: column; gap: 12px; }
        .cb-item { display: flex; justify-content: space-between; align-items: center; background: rgba(0,0,0,0.5); padding: 10px 12px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.05);}
        .cb-label { font-size: 14px; color: #fff; font-weight: bold; display: flex; flex-direction: column; gap: 4px;}
        .cb-label span { font-size: 10px; color: var(--primary); font-weight: normal; opacity: 0.9; margin-top: 2px;}
        .cb-ctrl { display: flex; align-items: center; background: #111; border-radius: 8px; border: 1px solid rgba(212,175,55,0.3); overflow: hidden; flex-shrink: 0;}
        .cb-btn { width: 34px; height: 34px; display: flex; justify-content: center; align-items: center; color: var(--primary); font-size: 18px; font-weight: bold; cursor: pointer; user-select: none; }
        .cb-btn:active { background: rgba(212,175,55,0.2); }
        .cb-input { width: 40px; text-align: center; background: #000; border: none; border-left: 1px solid #333; border-right: 1px solid #333; color: #fff; font-size: 16px; font-weight: 900; padding: 6px 0; outline: none; pointer-events: none;}

        /* è§†è§‰æŠ•å°„åŒº */
        .visual-feedback-section { margin-top: 30px; background: #0a0a0c; border: 1px solid rgba(212, 175, 55, 0.15); border-radius: 16px; padding: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .fb-header { text-align: center; font-size: 15px; font-weight: 900; color: var(--primary); margin-bottom: 15px; letter-spacing: 2px; }
        .visual-card { width: 100%; height: 300px; border-radius: 12px; overflow: hidden; position: relative; border: 1px solid rgba(255,255,255,0.1); background: #111;}
        .visual-img { width: 100%; height: 100%; object-fit: cover; filter: brightness(0.7) contrast(1.1); transition: all 0.5s ease-in-out; }
        .visual-overlay { position: absolute; bottom: 0; left: 0; width: 100%; padding: 40px 15px 15px; background: linear-gradient(to top, rgba(0,0,0,0.95), rgba(0,0,0,0.6), transparent); display: flex; flex-direction: column; justify-content: flex-end; }
        .visual-title { color: var(--primary); font-size: 20px; font-weight: 900; letter-spacing: 1px; margin-bottom: 6px; text-shadow: 0 2px 5px rgba(0,0,0,0.8);}
        .visual-desc { color: #ddd; font-size: 13px; line-height: 1.5; text-shadow: 0 1px 3px rgba(0,0,0,0.8); }

        /* è´­ç‰©è½¦åº•æ  */
        .checkout-bar { position: fixed; bottom: 0; left: 0; width: 100%; padding: 15px 20px 25px; background: rgba(10, 10, 12, 0.98); border-top: 1px solid rgba(212,175,55,0.3); box-shadow: 0 -10px 30px rgba(0,0,0,0.8); z-index: 100; backdrop-filter: blur(15px); display: flex; justify-content: space-between; align-items: center; }
        .checkout-info { display: flex; flex-direction: column; gap: 4px; }
        .c-info-label { font-size: 11px; color: #888; font-weight: bold; letter-spacing: 1px; }
        .c-info-val { font-size: 15px; font-weight: 900; color: #fff; display: flex; align-items: baseline; gap: 4px;}
        .c-info-val span { font-size: 11px; color: #888; font-weight: normal; }
        .btn-checkout { background: linear-gradient(135deg, var(--primary), #AA8A2A); color: #000; border: none; padding: 14px 18px; border-radius: 12px; font-size: 14px; font-weight: 900; box-shadow: 0 8px 20px rgba(212, 175, 55, 0.3); cursor: pointer; transition: 0.3s; }
        .btn-checkout:active { transform: scale(0.96); }
        .btn-checkout.disabled { background: #333; color: #666; box-shadow: none; pointer-events: none; }

        /* ğŸš¨ é€¼å•å¼¹çª—æ ·å¼ */
        .upsell-overlay { position: fixed; top:0; left:0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; opacity: 0; pointer-events: none; transition: 0.4s; backdrop-filter: blur(5px); }
        .upsell-overlay.show { opacity: 1; pointer-events: auto; }
        
        .upsell-modal { position: fixed; bottom: -100%; left: 0; width: 100%; background: linear-gradient(180deg, #1A1A20, #0A0A0C); border-top: 1px solid var(--primary); border-radius: 24px 24px 0 0; z-index: 1001; padding: 25px 20px 40px; transition: 0.5s cubic-bezier(0.2, 0.8, 0.2, 1); box-shadow: 0 -10px 40px rgba(212,175,55,0.15); max-height: 90vh; overflow-y: auto;}
        .upsell-modal.show { bottom: 0; }
        
        .up-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 15px; }
        .up-title { font-size: 18px; font-weight: 900; color: #fff; letter-spacing: 1px; }
        .up-sub { font-size: 11px; color: #aaa; margin-top: 6px; line-height: 1.5; }
        .up-close { color: #888; font-size: 28px; background: none; border: none; padding: 0; line-height: 1; cursor: pointer; }

        /* å¡ç‰‡æ˜ç»†é‡æ„ï¼šåŸä»· vs ç‰¹æƒä»·å¯¹æ¯” */
        .up-card { background: #111; border-radius: 12px; padding: 15px; border: 1px solid #333; margin-bottom: 12px; position: relative; overflow: hidden; }
        .up-card.anchor { background: linear-gradient(145deg, #18181A, #0A0A0C); border-color: #444; }
        .up-card.premium { border-color: rgba(212,175,55,0.8); background: linear-gradient(145deg, #241D10, #0A0A0C); box-shadow: 0 5px 20px rgba(212,175,55,0.15); margin-top: 12px; margin-bottom: 12px; transform: scale(1.02);}
        .up-card.premium::before { content: 'â˜… æ ¸å¿ƒä¸»æ¨ï¼Œæœ€é…ç›®æ ‡'; position: absolute; top: 0; right: 0; background: linear-gradient(90deg, var(--accent), var(--primary)); color: #000; font-size: 10px; font-weight: bold; padding: 4px 12px; border-radius: 0 0 0 12px; }
        .up-card.basic { background: #0A0A0C; border-style: dashed; border-color: #555; }
        
        .uc-title { font-size: 15px; font-weight: 900; color: #fff; margin-bottom: 8px; display: flex; align-items: center; gap: 6px;}
        .premium .uc-title { color: var(--primary); font-size: 16px;}
        
        /* é€æ˜å¯¹æ¯”æ¸…å• */
        .uc-breakdown { background: rgba(0,0,0,0.4); border-radius: 8px; padding: 10px; margin-bottom: 12px; border: 1px solid rgba(255,255,255,0.05); }
        .uc-brk-row { display: flex; justify-content: space-between; font-size: 12px; color: #888; margin-bottom: 6px; }
        .uc-brk-row:last-child { margin-bottom: 0; }
        .uc-brk-row.hl { color: var(--primary); font-weight: bold; }
        .uc-brk-row del { color: #666; }

        .uc-footer { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 12px; border-top: 1px dashed rgba(255,255,255,0.1); padding-top: 12px;}
        .uc-sessions { font-size: 22px; font-weight: 900; color: #fff; }
        .premium .uc-sessions { font-size: 24px; color: var(--primary); }
        .uc-sessions span { font-size: 12px; font-weight: normal; color: #888; }
        
        .uc-price-box { text-align: right; }
        .uc-ori-total { font-size: 11px; color: #888; text-decoration: line-through; margin-bottom: 2px; }
        .uc-new-total { font-size: 22px; font-weight: 900; color: #fff; }
        .premium .uc-new-total { font-size: 26px; color: #fff; text-shadow: 0 0 10px rgba(212,175,55,0.4);}

        .uc-btn { width: 100%; padding: 12px; border-radius: 8px; font-size: 14px; font-weight: bold; border: none; cursor: pointer; position: relative; z-index: 10;}
        .anchor .uc-btn { background: #333; color: #fff; }
        .premium .uc-btn { background: linear-gradient(135deg, var(--primary), #AA8A2A); color: #000; box-shadow: 0 4px 15px rgba(212,175,55,0.3);}
        .basic .uc-btn { background: transparent; color: #aaa; border: 1px solid #555; }
        
        /* ğŸš¨ ç»ˆææ ¸æ­¦ï¼šå…¨å±ç”µå­ç­¾ååˆåŒå° */
        .sig-modal { position: fixed; top: 100vh; left: 0; width: 100%; height: 100vh; background: #08080A; z-index: 2000; transition: top 0.4s cubic-bezier(0.2, 0.8, 0.2, 1); display: flex; flex-direction: column; }
        .sig-modal.show { top: 0; }
        .sig-header { height: 60px; display: flex; justify-content: space-between; align-items: center; padding: 0 20px; background: rgba(5,5,5,0.95); border-bottom: 1px solid rgba(212,175,55,0.3); }
        .sig-title { font-size: 16px; font-weight: bold; color: var(--primary); }
        .sig-content { padding: 20px; flex: 1; display: flex; flex-direction: column; }
        
        .sig-summary { background: linear-gradient(145deg, #18181A, #0A0A0C); padding: 20px; border-radius: 12px; margin-bottom: 20px; border: 1px solid rgba(212,175,55,0.3); box-shadow: 0 10px 30px rgba(0,0,0,0.5);}
        .sig-sum-title { color: #fff; font-size: 14px; margin-bottom: 10px; font-weight: bold;}
        .sig-sum-data { display: flex; justify-content: space-between; align-items: flex-end; border-top: 1px dashed rgba(255,255,255,0.1); padding-top: 15px; margin-top: 10px;}
        .sig-sum-name { font-size: 16px; color: var(--primary); font-weight: 900;}
        .sig-sum-price { font-size: 24px; color: #fff; font-weight: 900;}

        .sig-pad-container { flex: 1; border: 1px dashed #555; border-radius: 12px; background: #111; position: relative; overflow: hidden; box-shadow: inset 0 0 20px rgba(0,0,0,0.8);}
        #sigCanvas { width: 100%; height: 100%; touch-action: none; cursor: crosshair;}
        .sig-placeholder { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #444; font-size: 24px; font-weight: bold; pointer-events: none; letter-spacing: 2px;}
        
        .sig-actions { display: flex; gap: 15px; margin-top: 20px; margin-bottom: 30px; }
        .btn-clear { flex: 1; background: #222; color: #fff; padding: 16px; border-radius: 12px; text-align: center; border: 1px solid #444; font-weight: bold; font-size: 15px;}
        .btn-confirm-sig { flex: 2; background: linear-gradient(135deg, var(--primary), #AA8A2A); color: #000; padding: 16px; border-radius: 12px; text-align: center; border: none; font-weight: 900; font-size: 16px; box-shadow: 0 5px 20px rgba(212,175,55,0.3);}
    </style>
</head>
<body>

    <div class="header-brand">
        <div class="brand-text">ç§äººå®šåˆ¶é«˜ç«¯è¯¾ç¨‹</div>
    </div>

    <div class="intro-sec">
        <div class="main-title">å…­å¤§å°Šäº«é‡å¡‘çŸ©é˜µ</div>
        <div class="sub-title">ç³»ç»Ÿå·²æ ¹æ®æ‚¨çš„åŒ»å­¦æ’æŸ¥ä¸ä½“æ€è¯„ä¼°ï¼Œå¼€æ”¾ä»¥ä¸‹é¶å‘é‡å¡‘æ–¹æ¡ˆã€‚</div>
    </div>

    <div class="gallery-container">
        <div class="sol-card" onclick="openDetail('posture')">
            <div class="watermark"><svg viewBox="0 0 24 24"><path d="M12 5v14"/><path d="M8 9l4-4 4 4"/><path d="M8 19l4 4 4-4"/></svg></div>
            <div class="card-content"><div class="c-icon"><svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 5v14"/><path d="M8 9l4-4 4 4"/><path d="M8 19l4 4 4-4"/></svg></div><div class="c-title">ä½“æ€çŸ«æ­£ä¸ç»“æ„ä¼˜åŒ–</div><div class="c-desc">æ¾è§£å—é™ç­‹è†œï¼Œé‡å»ºè„ŠæŸ±ä¸­ç«‹ä½ï¼Œå½»åº•æ‹”é™¤è‚©é¢ˆè…°èƒŒç–¼ç—›æ ¹æºã€‚</div></div>
        </div>
        <div class="sol-card" onclick="openDetail('fatloss')">
            <div class="watermark"><svg viewBox="0 0 24 24"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"/></svg></div>
            <div class="card-content"><div class="c-icon"><svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"/></svg></div><div class="c-title">é«˜æ•ˆç‡ƒè„‚ä¸ä»£è°¢æ¿€æ´»</div><div class="c-desc">çªç ´é¡½å›ºå¹³å°æœŸï¼Œç§‘å­¦å‰¥ç¦»å†…è„è„‚è‚ªï¼Œæ‰“é€ å…¨å¤©å€™é«˜ä»£è°¢ä½“è´¨ã€‚</div></div>
        </div>
        <div class="sol-card" onclick="openDetail('shape')">
            <div class="watermark"><svg viewBox="0 0 24 24"><path d="M5 22h14"/><path d="M5 2h14"/><path d="M17 22v-4.172a2 2 0 0 0-.586-1.414L12 12l-4.414 4.414A2 2 0 0 0 7 17.828V22"/><path d="M7 2v4.172a2 2 0 0 0 .586 1.414L12 12l4.414-4.414A2 2 0 0 0 17 6.172V2"/></svg></div>
            <div class="card-content"><div class="c-icon"><svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 22h14"/><path d="M5 2h14"/><path d="M17 22v-4.172a2 2 0 0 0-.586-1.414L12 12l-4.414 4.414A2 2 0 0 0 7 17.828V22"/><path d="M7 2v4.172a2 2 0 0 0 .586 1.414L12 12l4.414-4.414A2 2 0 0 0 17 6.172V2"/></svg></div><div class="c-title">Så‹æ›²çº¿ç²¾é›•è®­ç»ƒ</div><div class="c-desc">ä¸“æ”»èœœæ¡ƒè‡€ã€é©¬ç”²çº¿ä¸ç›´è§’è‚©ï¼Œé€šè¿‡è‚Œè‚¥å¤§å¡«å……å¡‘é€ æè‡´æ¯”ä¾‹ã€‚</div></div>
        </div>
        <div class="sol-card" onclick="openDetail('postpartum')">
            <div class="watermark"><svg viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg></div>
            <div class="card-content"><div class="c-icon"><svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg></div><div class="c-title">äº§åæ ¸å¿ƒä¸ä½“å½¢æ¢å¤</div><div class="c-desc">é¿å¼€é«˜å±å·è…¹ï¼Œå†…æºæ€§é—­åˆè…¹ç›´è‚Œï¼Œå®‰å…¨æœ‰æ•ˆåœ°æ¢å¤ç›†åº•è‚Œæœºèƒ½ã€‚</div></div>
        </div>
        <div class="sol-card" onclick="openDetail('rehab')">
            <div class="watermark"><svg viewBox="0 0 24 24"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg></div>
            <div class="card-content"><div class="c-icon"><svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg></div><div class="c-title">è¿åŠ¨åŠŸèƒ½æå‡ä¸é˜²æŠ¤</div><div class="c-desc">æ¶ˆé™¤å…³èŠ‚å¼¹å“ä¸è¿åŠ¨åˆºç—›ï¼Œå¼ºåŒ–æ·±å±‚å°è‚Œç¾¤ï¼Œé‡å»ºå…³èŠ‚åŠ›å­¦æŠ¤ç”²ã€‚</div></div>
        </div>
        <div class="sol-card" onclick="openDetail('antiaging')">
            <div class="watermark"><svg viewBox="0 0 24 24"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg></div>
            <div class="card-content"><div class="c-icon"><svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg></div><div class="c-title">æ´»åŠ›ä½“èƒ½ä¸çŠ¶æ€ç„•æ–°</div><div class="c-desc">é€šè¿‡æŠ—é˜»åŠ›åˆºæ¿€æˆéª¨ç»†èƒï¼Œæå‡éª¨å¯†åº¦ä¸å¿ƒè‚ºå¼•æ“ï¼Œå¯¹æŠ—æœºèƒ½è¡°è€ã€‚</div></div>
        </div>
    </div>

    <div class="detail-modal" id="detailModal">
        <div class="modal-header">
            <div class="modal-title" id="m-header-title">å®šåˆ¶è·¯å¾„æ¨æ¼”</div>
            <button class="close-btn" onclick="closeDetail()">Ã—</button>
        </div>
        
        <div class="modal-body" id="modalBody"></div>
        
        <div class="checkout-bar">
            <div class="checkout-info">
                <div class="c-info-label">æ ¸ç®—æ€»è®¡éœ€é…è¯¾æ—¶</div>
                <div class="c-info-val" id="calc-val">-- <span>èŠ‚</span></div>
            </div>
            <button class="btn-checkout disabled" id="btn-checkout" onclick="showUpsellModal()">
                è·å–æ–°å®¢æ™ºèƒ½æŠ¥ä»· â”
            </button>
        </div>
    </div>

    <div class="upsell-overlay" id="upsellOverlay" onclick="closeUpsellModal()"></div>
    <div class="upsell-modal" id="upsellModal">
        <div class="up-header">
            <div>
                <div class="up-title">âœ¦ æ™ºèƒ½åŒ¹é…åˆ†è½¨æ–¹æ¡ˆ âœ¦</div>
                <div class="up-sub" id="up-sub-text">ç³»ç»Ÿå·²ä¸ºæ‚¨æ¥å…¥ <strong style="color:var(--primary)">ã€é¦–æ¬¡å»ºæ¡£ä¸“äº« Â¥350/èŠ‚èµ·ã€‘</strong> ç ´å†°è´¹ç‡ï¼š</div>
            </div>
            <button class="up-close" onclick="closeUpsellModal()">Ã—</button>
        </div>
        
        <div id="standard-upsell-content">
            <div class="up-card anchor">
                <div class="uc-title">æ–¹æ¡ˆä¸€ï¼šæè‡´é‡å¡‘åŒ… (é«˜é˜¶é”šå®š)</div>
                <div class="uc-breakdown">
                    <div class="uc-brk-row"><span>å¸¸è§„é˜¶æ¢¯å•ä»·:</span> <span><del id="up-a-unit-ori">Â¥400/èŠ‚</del></span></div>
                    <div class="uc-brk-row hl"><span>é¦–è´­ç ´å†°å•ä»·:</span> <span id="up-a-unit-new">Â¥350/èŠ‚</span></div>
                </div>
                <div class="uc-footer">
                    <div class="uc-sessions" id="up-a-sessions">-- <span>èŠ‚</span></div>
                    <div class="uc-price-box">
                        <div class="uc-ori-total" id="up-a-ori">åŸæ€»ä»· Â¥--</div>
                        <div class="uc-new-total">Â¥ <span id="up-a-new">--</span></div>
                    </div>
                </div>
                <button class="uc-btn" id="btn-sign-a">é€‰æ‹©æ­¤æ–¹æ¡ˆç­¾å• â”</button>
            </div>

            <div class="up-card premium">
                <div class="uc-title">æ–¹æ¡ˆäºŒï¼šé»„é‡‘å‘¨æœŸæ ¸å¿ƒåŒ…</div>
                <div class="uc-breakdown">
                    <div class="uc-brk-row"><span>å¸¸è§„é˜¶æ¢¯å•ä»·:</span> <span><del id="up-b-unit-ori">Â¥420/èŠ‚</del></span></div>
                    <div class="uc-brk-row hl"><span>é¦–è´­ç ´å†°å•ä»·:</span> <span id="up-b-unit-new">Â¥350/èŠ‚</span></div>
                </div>
                <div class="uc-footer">
                    <div class="uc-sessions" id="up-b-sessions">-- <span>èŠ‚</span></div>
                    <div class="uc-price-box">
                        <div class="uc-ori-total" id="up-b-ori">åŸæ€»ä»· Â¥--</div>
                        <div class="uc-new-total">Â¥ <span id="up-b-new">--</span></div>
                    </div>
                </div>
                <button class="uc-btn" id="btn-sign-b">ç¡®è®¤ä¸»æ¨æ–¹æ¡ˆå¹¶ç­¾çº¦ â”</button>
            </div>

            <div class="up-card basic">
                <div class="uc-title">æ–¹æ¡ˆä¸‰ï¼šä½é—¨æ§›å¯åŠ¨åŒ…</div>
                <div class="uc-breakdown">
                    <div class="uc-brk-row"><span>å¸¸è§„é˜¶æ¢¯å•ä»·:</span> <span><del id="up-c-unit-ori">Â¥440/èŠ‚</del></span></div>
                    <div class="uc-brk-row hl"><span>é¦–è´­ç ´å†°å•ä»·:</span> <span id="up-c-unit-new">Â¥350/èŠ‚</span></div>
                </div>
                <div class="uc-footer">
                    <div class="uc-sessions" id="up-c-sessions">-- <span>èŠ‚</span></div>
                    <div class="uc-price-box">
                        <div class="uc-ori-total" id="up-c-ori">åŸä»· Â¥--</div>
                        <div class="uc-new-total">Â¥ <span id="up-c-new">--</span></div>
                    </div>
                </div>
                <button class="uc-btn" id="btn-sign-c">å…ˆé€‰æ­¤æ–¹æ¡ˆä½é£é™©å¯åŠ¨ â”</button>
            </div>
        </div>

        <div id="custom-upsell-content" style="display:none;">
            <div class="up-card premium" style="margin-top:0;">
                <div class="uc-title">æ‚¨çš„ä¸“å±ï¼šé«˜å®šç§äº«ç»„åˆåŒ…</div>
                <div style="font-size:12px; color:#aaa; margin-bottom: 15px;">æ•™ç»ƒä¸ºæ‚¨é‡èº«è°ƒé…çš„é¡¶çº§å¤åˆè®­ç»ƒè®¡åˆ’</div>
                
                <div class="uc-breakdown" id="custom-breakdown-details" style="background: rgba(255,255,255,0.03); border: 1px solid rgba(212,175,55,0.3);">
                    </div>

                <div class="uc-footer">
                    <div class="uc-sessions" style="font-size:20px; line-height: 1.2;">æ–°å®¢ç ´å†°<br><span style="color:var(--primary)">æè‡´æ ¸ç®—</span></div>
                    <div class="uc-price-box">
                        <div class="uc-ori-total" id="up-custom-ori" style="font-size:13px;">å¸¸è§„æ‰§è¡Œæ€»ä»· Â¥--</div>
                        <div class="uc-new-total" style="font-size:30px;">Â¥ <span id="up-custom-new">--</span></div>
                    </div>
                </div>
                <button class="uc-btn" id="btn-sign-custom">ç¡®è®¤ä¸“å±ç»„åˆæ–¹æ¡ˆå¹¶ç­¾çº¦ â”</button>
            </div>
        </div>
    </div>

    <div class="sig-modal" id="signatureModal">
        <div class="sig-header">
            <div class="sig-title">âœ¦ ç”µå­åˆåŒç­¾ç½²ä¸­å¿ƒ âœ¦</div>
            <button class="close-btn" onclick="closeSignature()" style="font-size: 28px; color: #888;">Ã—</button>
        </div>
        <div class="sig-content">
            <div class="sig-summary">
                <div class="sig-sum-title">å³å°†ä¸ºæ‚¨é”å®šä»¥ä¸‹ä¸“å±é‡å¡‘æ–¹æ¡ˆï¼š</div>
                <div style="font-size:12px; color:#888;">æ‰€å±ä½“ç³»: <span id="sig-sys-name" style="color:#ccc;"></span></div>
                <div class="sig-sum-data">
                    <div class="sig-sum-name" id="sig-pkg-name">é»„é‡‘å‘¨æœŸæ ¸å¿ƒåŒ… <span style="font-size:12px; color:#fff;">(48èŠ‚)</span></div>
                    <div class="sig-sum-price" id="sig-pkg-price">Â¥ 16,800</div>
                </div>
            </div>
            
            <div class="sig-pad-container">
                <div class="sig-placeholder">è¯·åœ¨æ­¤å¤„æ‰‹å†™ç­¾å</div>
                <canvas id="sigCanvas"></canvas>
            </div>
            
            <div class="sig-actions">
                <button class="btn-clear" onclick="clearCanvas()">é‡æ–°ç­¾å</button>
                <button class="btn-confirm-sig" onclick="submitSignature()">ç¡®è®¤ä¿å­˜å¹¶ç”ŸæˆåˆåŒ</button>
            </div>
        </div>
    </div>

    <script>
        const priceTiers = {
            'regular': [ { t: 100, p: 350 }, { t: 72, p: 380 }, { t: 48, p: 400 }, { t: 24, p: 420 }, { t: 0, p: 440 } ],
            'feature': [ { t: 100, p: 380 }, { t: 72, p: 400 }, { t: 48, p: 420 }, { t: 24, p: 440 }, { t: 0, p: 460 } ]
        };
        const standardPackages = [12, 24, 48, 72, 100, 150];

        function getUnitPrice(sessions, type) {
            if(sessions <= 0) return 0;
            for (let tier of priceTiers[type]) {
                if (sessions >= tier.t) return tier.p;
            }
            return priceTiers[type][priceTiers[type].length - 1].p;
        }
        function formatMoney(num) {
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }
        function getMonthlyPrice(m) {
            if(m === 1) return 3888;
            if(m === 2) return 7200;
            if(m === 3) return 9600;
            if(m >= 6) return 18000;
            return m * 3888;
        }

        // å®Œç¾å¤åŸå¸¦åŠ ç²—çš„è¯­æ–™å’Œå¥³æ¨¡å›¾ç‰‡
        const planData = {
            'posture': {
                type: 'feature', icon: '<svg viewBox="0 0 24 24"><path d="M12 5v14"/><path d="M8 9l4-4 4 4"/><path d="M8 19l4 4 4-4"/></svg>',
                title: 'ä½“æ€çŸ«æ­£ä¸ç»“æ„ä¼˜åŒ–', desc: 'ç‰©ç†å±‚é¢çš„ç»“æ„é‡ç»„ï¼Œå½»åº•åˆ‡æ–­ç–¼ç—›ä»£å¿ã€‚',
                p1_name: 'ç­‹è†œè§£ç»‘ä¸ç—›ç‚¹æ¸…é›¶', p1_time: 'é¦–æœˆçªå‡» (ç¬¬ 1-4 å‘¨)', p1_sessions: '12 - 16 èŠ‚', p1_min: 12, p1_max: 16,
                p1_goal: '<strong>æ‰“ç ´éª¨éª¼é”™è¯¯æ’åˆ—</strong>ï¼Œæ¢å¤å…³èŠ‚æ´»åŠ¨åº¦ã€‚', p1_tech: 'æ·±å±‚å‰¥ç¦»èƒ¸å°è‚Œä¸é«‚è…°è‚Œã€‚', p1_feel: 'ç»ƒå®Œæ„Ÿè§‰<strong>è‚©é¢ˆå½»åº•æ”¾æ¾</strong>ã€‚',
                p2_name: 'å¼±ç‚¹å”¤é†’ä¸æ ¸å¿ƒé‡æ„', p2_time: 'æ·±åº¦é‡å¡‘ (ç¬¬ 2-3 ä¸ªæœˆ)', p2_sessions: '24 - 36 èŠ‚', p2_min: 24, p2_max: 36,
                p2_goal: '<strong>æ¿€æ´»ä¼‘çœ çš„è‚Œè‚‰</strong>ï¼Œå»ºç«‹å¤©ç„¶è‚Œè‚‰å†…è¡£ã€‚', p2_tech: 'æ™®æ‹‰æå­¤ç«‹æ€§å‹Ÿé›†è…¹æ¨ªè‚Œã€‚', p2_feel: 'æ ¸å¿ƒäº§ç”Ÿ<strong>å¼ºçƒˆçš„æ”¯æ’‘æ„Ÿ</strong>ã€‚',
                p3_name: 'åŠ¨ä½œæ¨¡å¼å›ºåŒ–å®šå‹', p3_time: 'åŠå¹´å›ºåŒ– (ç¬¬ 4-6 ä¸ªæœˆ)', p3_sessions: '48 - 72 èŠ‚', p3_min: 48, p3_max: 72,
                p3_goal: 'å°†æ­£ç¡®æ’åˆ—<strong>åˆ»å…¥ç¥ç»æ½œæ„è¯†</strong>ã€‚', p3_tech: 'å¤åˆæŠ—é˜»ç»“åˆç”Ÿæ´»è½¨è¿¹äºŒæ¬¡é‡å¡‘ã€‚', p3_feel: 'ä¸è‡ªè§‰åœ°<strong>ä¿æŒæŒºæ‹”é«˜å§¿æ€</strong>ã€‚',
                img1: 'https://images.unsplash.com/photo-1518611012118-696072aa579a?auto=format&fit=crop&w=600&q=80', 
                img2: 'https://images.unsplash.com/photo-1599901860904-17e6ed7083a0?auto=format&fit=crop&w=600&q=80', 
                img3: 'https://images.unsplash.com/photo-1552196563-55cd4e45efb3?auto=format&fit=crop&w=600&q=80', 
                txt1: 'åˆæœŸæ”¹å–„ï¼šå¼‚å¸¸å¼ åŠ›é‡Šæ”¾ï¼Œè‚©é¢ˆèˆ’å±•', txt2: 'è¿›é˜¶èœ•å˜ï¼šæ ¸å¿ƒå»ºç«‹ï¼Œæ°”è´¨åˆæ˜¾', txt3: 'ç»ˆæå®šå‹ï¼šè„ŠæŸ±å®Œç¾ä¸­ç«‹ï¼Œç»ç¾èƒŒå½±'
            },
            'fatloss': {
                type: 'regular', icon: '<svg viewBox="0 0 24 24"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"/></svg>',
                title: 'é«˜æ•ˆç‡ƒè„‚ä¸ä»£è°¢æ¿€æ´»', desc: 'é‡å†™èº«ä½“åŸºå› ï¼Œæ‰“é€ â€œ24å°æ—¶æŒç»­ç‡ƒè„‚çš„ç«ç‚‰â€ã€‚',
                p1_name: 'ç³–åŸæ’ç©ºä¸ä»£è°¢å”¤é†’', p1_time: 'é¦–æœˆçªå‡» (ç¬¬ 1-4 å‘¨)', p1_sessions: '12 - 16 èŠ‚', p1_min: 12, p1_max: 16,
                p1_goal: '<strong>å¼ºè¡Œåˆ‡å…¥è„‚è‚ªæ°§åŒ–é€šé“</strong>ã€‚', p1_tech: 'å¾ªç¯æŠ—é˜»é…åˆä½GIé¥®é£Ÿå¹²é¢„ã€‚', p1_feel: 'è¿…é€Ÿ<strong>æ’å¹²ä½“å†…é¡½å›ºæ°´è‚¿</strong>ï¼Œä½“é‡æ‰ç§¤å¿«ã€‚',
                p2_name: 'é«˜å®¹é‡é¡½å›ºè„‚è‚ªå‰¥ç¦»', p2_time: 'æé€Ÿç‡ƒè„‚ (ç¬¬ 2-3 ä¸ªæœˆ)', p2_sessions: '24 - 36 èŠ‚', p2_min: 24, p2_max: 36,
                p2_goal: 'é¶å‘æ¸…ç†å†…è„è„‚è‚ªï¼Œ<strong>å¼ºåŠ›çªç ´å¹³å°æœŸ</strong>ã€‚', p2_tech: 'HIITæ¿€å‘å¼ºçƒˆè¿åŠ¨åç‡ƒæ•ˆåº”ã€‚', p2_feel: '<strong>è…°è…¹å›´åº¦æ˜æ˜¾ç¼©å°</strong>ï¼Œç©¿è¡£å®½æ¾ã€‚',
                p3_name: 'æ˜“ç˜¦ä½“è´¨ç»ˆæå®šå‹', p3_time: 'å¹´åº¦å›ºåŒ– (ç¬¬ 4-12 ä¸ªæœˆ)', p3_sessions: '48 - 100 èŠ‚', p3_min: 48, p3_max: 100,
                p3_goal: 'è®©èº«ä½“åœ¨<strong>ç¡çœ ä¸­æŒç»­ç‡ƒçƒ§çƒ­é‡</strong>ã€‚', p3_tech: 'è‚Œè‚¥å¤§è®­ç»ƒæå‡æ•´ä½“è‚Œè‚‰å‚¨å¤‡ã€‚', p3_feel: '<strong>å¶å°”æ”¾çºµåƒå–ä¸å†åå¼¹</strong>ã€‚',
                img1: 'https://images.unsplash.com/photo-1584735175315-9d5df23860e6?auto=format&fit=crop&w=600&q=80', 
                img2: 'https://images.unsplash.com/photo-1608228079968-c7681eaef81e?auto=format&fit=crop&w=600&q=80', 
                img3: 'https://images.unsplash.com/photo-1508215885820-4585e5610ea0?auto=format&fit=crop&w=600&q=80', 
                txt1: 'åˆæœŸæ•ˆæœï¼šæ°´è‚¿æ’ç©ºï¼Œä½“èƒ½æé€Ÿå”¤é†’', txt2: 'è¿›é˜¶æ•ˆæœï¼šå›´åº¦ç¼©å°ï¼Œå†…è„è„‚è‚ªå¤§é‡å‰¥ç¦»', txt3: 'ç»ˆæå®šå‹ï¼šä½“è„‚é™è‡³é»„é‡‘ç‚¹ï¼Œé©¬ç”²çº¿æ¸…æ™°'
            },
            'shape': {
                type: 'regular', icon: '<svg viewBox="0 0 24 24"><path d="M5 22h14"/><path d="M5 2h14"/><path d="M17 22v-4.172a2 2 0 0 0-.586-1.414L12 12l-4.414 4.414A2 2 0 0 0 7 17.828V22"/><path d="M7 2v4.172a2 2 0 0 0 .586 1.414L12 12l4.414-4.414A2 2 0 0 0 17 6.172V2"/></svg>',
                title: 'Så‹æ›²çº¿ç²¾é›•è®­ç»ƒ', desc: 'ç‰©ç†å‰¥ç¦»ä¸3Då¡«å……ï¼Œæ‰“é€ æå…·è§†è§‰æ€ä¼¤åŠ›çš„èº«ææ¯”ä¾‹ã€‚',
                p1_name: 'ç›®æ ‡é¶å‘æé€Ÿæ¿€æ´»', p1_time: 'é¦–æœˆå”¤é†’ (ç¬¬ 1-4 å‘¨)', p1_sessions: '12 - 16 èŠ‚', p1_min: 12, p1_max: 16,
                p1_goal: 'çº æ­£é”™è¯¯å‘åŠ›ï¼Œé¿å…<strong>â€œç»ƒè‡€å…ˆç²—è…¿â€</strong>ã€‚', p1_tech: 'å­¤ç«‹å”¤é†’è‡€å¤§è‚Œä¸Šéƒ¨ä¸ä¸‰è§’è‚Œä¸­æŸã€‚', p1_feel: 'ä½“ä¼šåˆ°ç›®æ ‡è‚Œè‚‰çš„<strong>æ·±å±‚é…¸èƒ€æ³µæ„Ÿ</strong>ã€‚',
                p2_name: 'å¼±ç‚¹åŒºåŸŸ3Dç‰©ç†å¡«å……', p2_time: 'ç»´åº¦ç”Ÿé•¿ (ç¬¬ 2-3 ä¸ªæœˆ)', p2_sessions: '24 - 36 èŠ‚', p2_min: 24, p2_max: 36,
                p2_goal: 'è¿«ä½¿è‚Œçº¤ç»´è¶…é‡æ¢å¤ï¼Œå®ç°<strong>å±€éƒ¨çš„é¥±æ»¡å¡«å……</strong>ã€‚', p2_tech: 'æ¸è¿›å¼è¶…è´Ÿè·ï¼Œè¿ç”¨æ…¢é€Ÿç¦»å¿ƒæ§åˆ¶ã€‚', p2_feel: '<strong>èœœæ¡ƒè‡€é€æ¸é¥±æ»¡ä¸Šç¿˜</strong>ï¼Œè‚©çº¿å¹³ç›´ã€‚',
                p3_name: 'è§†è§‰æ¯”ä¾‹æ‹‰æ‰¯ç²¾é›•', p3_time: 'å¹´åº¦å›ºåŒ– (ç¬¬ 4-12 ä¸ªæœˆ)', p3_sessions: '48 - 100 èŠ‚', p3_min: 48, p3_max: 100,
                p3_goal: 'å¼ºè¡Œå‘ˆç°å‡º<strong>æè‡´çš„æ¼æ–—å½¢æ›²çº¿</strong>ã€‚', p3_tech: 'å¼ºåŒ–èƒŒéƒ¨é˜”åº¦ï¼Œæè‡´å‹ç¼©è…°å›´æ•°æ®ã€‚', p3_feel: 'Sæ›²çº¿å®Œå…¨å›ºåŒ–ï¼Œ<strong>æ‹ç…§è‡ªå¸¦é«˜çº§æ„Ÿ</strong>ã€‚',
                img1: 'https://images.unsplash.com/photo-1574680096145-d05b474e2155?auto=format&fit=crop&w=600&q=80', 
                img2: 'https://images.unsplash.com/photo-1583454110551-21f2fa2afe61?auto=format&fit=crop&w=600&q=80', 
                img3: 'https://images.unsplash.com/photo-1605296867304-46d5465a13f1?auto=format&fit=crop&w=600&q=80', 
                txt1: 'åˆæœŸå”¤é†’ï¼šè‡€éƒ¨è‚Œè‚‰è‹é†’ï¼Œå‘åŠ›æ„Ÿå»ºç«‹', txt2: 'è¿›é˜¶å¡«å……ï¼šå±€éƒ¨é¥±æ»¡åº¦æå‡ï¼Œè‡€çº¿æ‹‰é«˜', txt3: 'ç»ˆæå®šå‹ï¼šç»ç¾è…°è‡€æ¯”ï¼Œæå…·è§†è§‰æ€ä¼¤åŠ›'
            },
            'postpartum': {
                type: 'feature', icon: '<svg viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>',
                title: 'äº§åæ ¸å¿ƒä¸ä½“å½¢æ¢å¤', desc: 'æ— ç—›å®‰å…¨ç¼åˆè…¹ç›´è‚Œè£‚éš™ï¼ŒåŠ©æ‚¨é‡è¿”å°‘å¥³çº§å¥åº·ä½“æ€ã€‚',
                p1_name: 'ç›†åº•è‚Œä¸å†…æºå®‰å…¨ä¿®å¤', p1_time: 'é¦–æœˆå†…æºä¿®å¤ (1-4å‘¨)', p1_sessions: '10 - 15 èŠ‚', p1_min: 10, p1_max: 15,
                p1_goal: 'é‡å»ºç›†åº•åŠŸèƒ½ï¼Œ<strong>ç»å¯¹ç¦æ­¢ä¼ ç»Ÿå·è…¹</strong>ã€‚', p1_tech: 'æ¨ªå‘å‘¼å¸æ³•æ¸©å’Œå”¤é†’è…¹æ¨ªè‚Œã€‚', p1_feel: '<strong>æ¼å°¿æ”¹å–„</strong>ï¼Œæ ¸å¿ƒè„å™¨æœ‰æ˜æ˜¾å½’ä½æ„Ÿã€‚',
                p2_name: 'è…¹ç›´è‚Œç‰©ç†é—­åˆ', p2_time: 'é»„é‡‘æ¢å¤ (ç¬¬ 2-3 ä¸ªæœˆ)', p2_sessions: '20 - 30 èŠ‚', p2_min: 20, p2_max: 30,
                p2_goal: 'å®‰å…¨ç¼åˆè…¹éƒ¨è£‚éš™ï¼Œæ”¹å–„<strong>éª¨ç›†è¿‡åº¦å‰å€¾</strong>ã€‚', p2_tech: 'æŠ—æ—‹è½¬ä¸æŠ—ä¼¸å±•è®­ç»ƒï¼Œå¼ºåŒ–æ·±å±‚æ ¸å¿ƒã€‚', p2_feel: 'è…¹ç›´è‚Œé—´è·è‚‰çœ¼æ”¶çª„ï¼Œ<strong>è…°èƒŒé…¸ç—›å¤§å¹…ç¼“è§£</strong>ã€‚',
                p3_name: 'æ¸©å’Œå‡è„‚ä¸çš®è‚¤æ”¶ç´§', p3_time: 'åŠå¹´å·©å›º (ç¬¬ 4-6 ä¸ªæœˆ)', p3_sessions: '40 - 60 èŠ‚', p3_min: 40, p3_max: 60,
                p3_goal: 'åœ¨å®‰å…¨å‰æä¸‹ï¼Œ<strong>å‰¥ç¦»å­•æœŸå›¤ç§¯è„‚è‚ª</strong>ã€‚', p3_tech: 'æ— è·³è·ƒæ¸©å’ŒæŠ—é˜»ä»£è°¢ç»„ã€‚', p3_feel: 'é€æ­¥<strong>ç©¿å›å­•å‰å°ºç è¡£æœ</strong>ï¼Œçš®è‚¤æ¢å¤ç´§è‡´ã€‚',
                img1: 'https://images.unsplash.com/photo-1609899536866-99396547465a?auto=format&fit=crop&w=600&q=80', 
                img2: 'https://images.unsplash.com/photo-1517836357463-d25dfeac3438?auto=format&fit=crop&w=600&q=80', 
                img3: 'https://images.unsplash.com/photo-1506126613408-eca07ce68773?auto=format&fit=crop&w=600&q=80', 
                txt1: 'åˆæœŸæ¢å¤ï¼šç›†åº•æ¿€æ´»ï¼Œå†…æºæ€§åŠŸèƒ½é‡å»º', txt2: 'è¿›é˜¶ç¼åˆï¼šè…¹ç›´è‚Œé—­åˆï¼Œæ ¸å¿ƒåŠ›é‡å›å½’', txt3: 'ç»ˆæä½“æ€ï¼šé‡è¿”å°‘å¥³æ—¶ä»£ç´§è‡´èº«å‹'
            },
            'rehab': {
                type: 'feature', icon: '<svg viewBox="0 0 24 24"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>',
                title: 'è¿åŠ¨åŠŸèƒ½æå‡ä¸é˜²æŠ¤', desc: 'ç²¾å‡†ç¥ç»è‚Œè‚‰è°ƒæ§ï¼Œé‡å»ºå—æŸå…³èŠ‚åŠ›å­¦ç¨³å®šæ€§ã€‚',
                p1_name: 'ç‚ç—‡æ¶ˆé™¤ä¸ä»£å¿åˆ‡æ–­', p1_time: 'é¦–æœˆé•‡ç—› (ç¬¬ 1-4 å‘¨)', p1_sessions: '10 - 15 èŠ‚', p1_min: 10, p1_max: 15,
                p1_goal: 'æ‰¾å‡ºå¼•èµ·ç–¼ç—›çš„<strong>é”™è¯¯å‘åŠ›æº</strong>ã€‚', p1_tech: 'æ¿€ç—›ç‚¹æŒ‰å‹æŠ€æœ¯é‡Šæ”¾ä»£å¿å…³èŠ‚ã€‚', p1_feel: '<strong>å¼¹å“æ˜æ˜¾å‡å°‘</strong>ï¼Œå°–é”åˆºç—›æ„Ÿæ¶ˆå¤±ã€‚',
                p2_name: 'å—æŸå…³èŠ‚è‚Œè‚‰æŠ¤ç”²æ„å»º', p2_time: 'æŠ¤ç”²å¼ºåŒ– (ç¬¬ 2-3 ä¸ªæœˆ)', p2_sessions: '20 - 30 èŠ‚', p2_min: 20, p2_max: 30,
                p2_goal: 'å¢å¼ºéŸ§å¸¦å¼ºåº¦ï¼Œæ‰“é€ <strong>ç”Ÿç‰©å­¦æŠ¤è†æŠ¤è…°</strong>ã€‚', p2_tech: 'æ— ç—›è§’åº¦å†…ç­‰é•¿æ”¶ç¼©å¼ºåŒ–æ·±å±‚å°è‚Œç¾¤ã€‚', p2_feel: 'å…³èŠ‚äº§ç”Ÿ<strong>æå¼ºåŒ…è£¹æ„Ÿ</strong>ï¼Œå‘åŠ›ä¸å‘è™šã€‚',
                p3_name: 'åŠ¨æ€è„±æ•ä¸èµ›åœºé‡è¿”', p3_time: 'åŠå¹´é‡è¿” (ç¬¬ 4-6 ä¸ªæœˆ)', p3_sessions: '40 - 60 èŠ‚', p3_min: 40, p3_max: 60,
                p3_goal: 'é‡å»ºæœ¬ä½“æ„Ÿè§‰ï¼Œ<strong>é€‚åº”å¤æ‚è¿åŠ¨è½¨è¿¹</strong>ã€‚', p3_tech: 'é—­é“¾ä¸ä¸å¹³è¡¡ä»‹è´¨é«˜é˜¶ç¥ç»è°ƒæ§ã€‚', p3_feel: 'èƒ½<strong>æå…¶è‡ªä¿¡åœ°å®Œæˆå¤æ‚åŠ¨ä½œ</strong>ï¼Œæ— æƒ§æŸä¼¤ã€‚',
                img1: 'https://images.unsplash.com/photo-1609899517237-77d357b03007?auto=format&fit=crop&w=600&q=80', 
                img2: 'https://images.unsplash.com/photo-1571019614242-c5c5dee9f50b?auto=format&fit=crop&w=600&q=80', 
                img3: 'https://images.unsplash.com/photo-1552674605-db6ffd4facb5?auto=format&fit=crop&w=600&q=80', 
                txt1: 'åˆæœŸé•‡ç—›ï¼šè½¯ç»„ç»‡å‹åŠ›é‡Šæ”¾ï¼Œç–¼ç—›æ¶ˆå¤±', txt2: 'è¿›é˜¶æŠ¤ç”²ï¼šå…³èŠ‚å‘¨å›´åŠ›é‡å¢å¼ºï¼Œå»ºç«‹ä¿æŠ¤', txt3: 'æ»¡è¡€é‡è¿”ï¼šæ— æƒ§ä»»ä½•å‘åŠ›ï¼Œé‡è¿”é«˜å¼ºåº¦'
            },
            'antiaging': {
                type: 'regular', icon: '<svg viewBox="0 0 24 24"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>',
                title: 'æ´»åŠ›ä½“èƒ½ä¸çŠ¶æ€ç„•æ–°', desc: 'æå‡éª¨å¯†åº¦ä¸è‚Œè‚‰å‚¨å¤‡ï¼Œä¸ºæ‚¨æ‰“é€ ä¸è€çš„è‚‰ä½“ç›”ç”²ã€‚',
                p1_name: 'æœºèƒ½å”¤é†’ä¸æ¶¦æ»‘ç³»ç»Ÿ', p1_time: 'é¦–æœˆæ¶¦æ»‘ (1-4å‘¨)', p1_sessions: '12 - 16 èŠ‚', p1_min: 12, p1_max: 16,
                p1_goal: 'ä¿ƒè¿›æ»‘æ¶²åˆ†æ³Œï¼Œ<strong>å…¨é¢æ¢å¤ç”Ÿé”ˆå¡é¡¿çš„æœºèƒ½</strong>ã€‚', p1_tech: 'å…³èŠ‚æ´»åŠ¨åº¦æ‰“ç£¨ä¸å…¨èº«ç­‹è†œé“¾æ‹‰ä¼¸ã€‚', p1_feel: '<strong>æ™¨èµ·åƒµç¡¬æ„Ÿæ¶ˆå¤±ï¼Œæ·±åº¦ç¡çœ å»¶é•¿</strong>ã€‚',
                p2_name: 'éª¨å¯†åº¦ä¸é˜²æµå¤±å‚¨å¤‡', p2_time: 'å‚¨å¤‡æ„å»º (ç¬¬ 2-3 ä¸ªæœˆ)', p2_sessions: '24 - 36 èŠ‚', p2_min: 24, p2_max: 36,
                p2_goal: 'åˆºæ¿€æˆéª¨ç»†èƒæ´»è·ƒï¼Œ<strong>æš´åŠ›å¯¹æŠ—è‚Œè‚‰èç¼©</strong>ã€‚', p2_tech: 'é‡ç‰©æŠ—é˜»é…åˆæ…¢é€Ÿç¦»å¿ƒæ”¶ç¼©æŠ€æœ¯ã€‚', p2_feel: 'æ‹é‡ç‰©ä¸åƒåŠ›ï¼Œ<strong>ä¸‹æ¥¼æ¢¯è†ç›–ç»ä¸å‘è½¯</strong>ã€‚',
                p3_name: 'å¼•æ“é‡ç½®ä¸è·å°”è’™å”¤é†’', p3_time: 'å¹´åº¦å†»é¾„ (4-12æœˆ)', p3_sessions: '72 - 150 èŠ‚', p3_min: 72, p3_max: 150,
                p3_goal: 'æå‡æœ€å¤§æ‘„æ°§é‡ï¼Œç”±å†…è€Œå¤–ç„•å‘<strong>æè‡´å¹´è½»æ€</strong>ã€‚', p3_tech: 'ç¨³æ€æœ‰æ°§é…åˆå¿ƒç‡å˜å¼‚ç‡ç§‘å­¦ç›‘æ§ã€‚', p3_feel: 'çˆ¬æ¥¼æ¢¯ä¸å–˜ï¼Œ<strong>æ°”è‰²çº¢æ¶¦ï¼Œç²¾åŠ›çˆ†è¡¨</strong>ã€‚',
                img1: 'https://images.unsplash.com/photo-1576678927484-cc907957088c?auto=format&fit=crop&w=600&q=80', 
                img2: 'https://images.unsplash.com/photo-1534438327276-14e5300c3a48?auto=format&fit=crop&w=600&q=80', 
                img3: 'https://images.unsplash.com/photo-1553532070-539150b2077d?auto=format&fit=crop&w=600&q=80', 
                txt1: 'åˆæœŸå”¤é†’ï¼šå…³èŠ‚æ¶¦æ»‘ï¼Œèº«ä½“æ¢å¤æŸ”éŸ§è‡ªç”±', txt2: 'è¿›é˜¶å‚¨å¤‡ï¼šéª¨å¯†æå‡ï¼Œè‚Œè‚‰å¼ åŠ›é‡è¿”å¹´è½»', txt3: 'é€†é¾„å†»é¾„ï¼šå¿ƒè‚ºå¼•æ“é‡ç½®ï¼Œç»å¯¹å·…å³°æ´»åŠ›'
            }
        };

        let currentPlanKey = '';
        let globalTotalMin = 0;
        let globalTotalMax = 0;

        function openDetail(key) {
            currentPlanKey = key;
            const data = planData[key];
            const modal = document.getElementById('detailModal');
            const body = document.getElementById('modalBody');
            
            body.innerHTML = `
                <div class="hero-banner">
                    <div class="hero-watermark">${data.icon}</div>
                    <div class="m-hero-title">${data.title}</div>
                    <div class="m-hero-desc">${data.desc}</div>
                </div>
                
                <div class="phase-title-main">è¯·ç‚¹é€‰æ‚¨æœŸæœ›è¾¾æˆçš„é‡å¡‘ç›®æ ‡é˜¶æ®µï¼š</div>
                
                <div class="phase-box selected" data-phase="1" data-min="${data.p1_min}" data-max="${data.p1_max}" onclick="togglePhase(this, event)">
                    <div class="check-circle"></div>
                    <div class="p-step">â— PHASE 01 / é˜¶æ®µä¸€</div>
                    <div class="p-cycle-highlight">
                        <div class="cycle-row"><span class="icon">â±</span> å‘¨æœŸï¼š<span class="highlight-text">${data.p1_time}</span></div>
                        <div class="cycle-row"><span class="icon">ğŸ¯</span> è¯¾æ—¶ï¼š<span class="highlight-text">${data.p1_sessions}</span></div>
                    </div>
                    <div class="p-name">${data.p1_name}</div>
                    <div class="sales-points">
                        <div class="sp-row"><div class="sp-tag tag-goal">ç›®æ ‡</div><div class="sp-text">${data.p1_goal}</div></div>
                        <div class="sp-row"><div class="sp-tag tag-tech">æŠ€æœ¯</div><div class="sp-text">${data.p1_tech}</div></div>
                        <div class="sp-row"><div class="sp-tag tag-feel">ä½“æ„Ÿ</div><div class="sp-text">${data.p1_feel}</div></div>
                    </div>
                </div>

                <div class="phase-box" data-phase="2" data-min="${data.p2_min}" data-max="${data.p2_max}" onclick="togglePhase(this, event)">
                    <div class="check-circle"></div>
                    <div class="p-step">â— PHASE 02 / é˜¶æ®µäºŒ</div>
                    <div class="p-cycle-highlight">
                        <div class="cycle-row"><span class="icon">â±</span> å‘¨æœŸï¼š<span class="highlight-text">${data.p2_time}</span></div>
                        <div class="cycle-row"><span class="icon">ğŸ¯</span> è¯¾æ—¶ï¼š<span class="highlight-text">${data.p2_sessions}</span></div>
                    </div>
                    <div class="p-name">${data.p2_name}</div>
                    <div class="sales-points">
                        <div class="sp-row"><div class="sp-tag tag-goal">ç›®æ ‡</div><div class="sp-text">${data.p2_goal}</div></div>
                        <div class="sp-row"><div class="sp-tag tag-tech">æŠ€æœ¯</div><div class="sp-text">${data.p2_tech}</div></div>
                        <div class="sp-row"><div class="sp-tag tag-feel">ä½“æ„Ÿ</div><div class="sp-text">${data.p2_feel}</div></div>
                    </div>
                </div>

                <div class="phase-box" data-phase="3" data-min="${data.p3_min}" data-max="${data.p3_max}" onclick="togglePhase(this, event)">
                    <div class="check-circle"></div>
                    <div class="p-step">â— PHASE 03 / é˜¶æ®µä¸‰</div>
                    <div class="p-cycle-highlight">
                        <div class="cycle-row"><span class="icon">â±</span> å‘¨æœŸï¼š<span class="highlight-text">${data.p3_time}</span></div>
                        <div class="cycle-row"><span class="icon">ğŸ¯</span> è¯¾æ—¶ï¼š<span class="highlight-text">${data.p3_sessions}</span></div>
                    </div>
                    <div class="p-name">${data.p3_name}</div>
                    <div class="sales-points">
                        <div class="sp-row"><div class="sp-tag tag-goal">ç›®æ ‡</div><div class="sp-text">${data.p3_goal}</div></div>
                        <div class="sp-row"><div class="sp-tag tag-tech">æŠ€æœ¯</div><div class="sp-text">${data.p3_tech}</div></div>
                        <div class="sp-row"><div class="sp-tag tag-feel">ä½“æ„Ÿ</div><div class="sp-text">${data.p3_feel}</div></div>
                    </div>
                </div>

                <div class="phase-box combo-box" id="phase-4-box" onclick="togglePhase(this, event)">
                    <div class="check-circle"></div>
                    <div class="p-step">â˜… ç‰¹æ®Šé€šé“ / æ•™ç»ƒä¸“å±å®šåˆ¶ç»„åˆåŒ…</div>
                    <div class="p-name" style="margin-bottom: 15px;">çªç ´å•ä¸€å±€é™ï¼Œå…¨æ¯æ–¹æ¡ˆæ‰˜ç®¡</div>
                    
                    <div class="custom-builder">
                        <div class="cb-item">
                            <div class="cb-label">å¸¸è§„è®­ç»ƒè¯¾ <span>(å‡è„‚/å¢è‚Œ/å¡‘å½¢ <strong style="color:var(--primary);">60åˆ†é’Ÿ/èŠ‚</strong>)</span></div>
                            <div class="cb-ctrl">
                                <div class="cb-btn" onclick="chgVal('cb-reg', -1, event)">-</div>
                                <input id="cb-reg" class="cb-input" value="0" readonly>
                                <div class="cb-btn" onclick="chgVal('cb-reg', 1, event)">+</div>
                            </div>
                        </div>
                        <div class="cb-item">
                            <div class="cb-label">ç‰¹è‰²å¹²é¢„è¯¾ <span>(æ‹‰ä¼¸/æ™®æ‹‰æ/æ‹³å‡»ç­‰ <strong style="color:var(--primary);">45åˆ†é’Ÿ/èŠ‚</strong>)</span></div>
                            <div class="cb-ctrl">
                                <div class="cb-btn" onclick="chgVal('cb-feat', -1, event)">-</div>
                                <input id="cb-feat" class="cb-input" value="0" readonly>
                                <div class="cb-btn" onclick="chgVal('cb-feat', 1, event)">+</div>
                            </div>
                        </div>
                        <div class="cb-item">
                            <div class="cb-label">åŒ…æœˆå‘¨æœŸè¯¾ <span>(æè‡´é«˜é¢‘æ‰“å¡ <strong style="color:var(--primary);">45åˆ†é’Ÿ/èŠ‚ï¼ŒæŒ‰æœˆ</strong>)</span></div>
                            <div class="cb-ctrl">
                                <div class="cb-btn" onclick="chgVal('cb-mon', -1, event)">-</div>
                                <input id="cb-mon" class="cb-input" value="0" readonly>
                                <div class="cb-btn" onclick="chgVal('cb-mon', 1, event)">+</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="visual-feedback-section">
                    <div class="fb-header">âœ¦ AI ç›®æ ‡å½¢æ€è§†è§‰æŠ•å°„ âœ¦</div>
                    <div class="visual-card">
                        <img id="visual-img" class="visual-img" src="${data.img1}" alt="å½¢æ€æ¼”å˜">
                        <div class="visual-overlay">
                            <div class="visual-title" id="visual-title">PHASE 01: åŸºç¡€é‡å¡‘</div>
                            <div class="visual-desc" id="visual-desc">${data.txt1}</div>
                        </div>
                    </div>
                </div>
            `;
            
            modal.classList.add('show');
            updateCheckout(); 
        }

        function closeDetail() {
            document.getElementById('detailModal').classList.remove('show');
        }

        // æ­¥æ•°è°ƒæ•´é€»è¾‘ (æ­¥é•¿ä¸º1)
        function chgVal(id, delta, e) {
            if(e) e.stopPropagation(); 
            let el = document.getElementById(id);
            let val = parseInt(el.value) + delta;
            if (val < 0) val = 0;
            el.value = val;
            
            let box = document.getElementById('phase-4-box');
            let totalCustom = parseInt(document.getElementById('cb-reg').value) + parseInt(document.getElementById('cb-feat').value) + parseInt(document.getElementById('cb-mon').value);
            
            if (totalCustom > 0) {
                box.classList.add('selected');
                document.querySelectorAll('.phase-box:not(.combo-box)').forEach(b => b.classList.remove('selected'));
            } else if (totalCustom === 0) {
                box.classList.remove('selected');
            }
            
            updateCheckout();
        }

        function togglePhase(el, e) {
            if(e) e.stopPropagation();

            if (el.id === 'phase-4-box') {
                document.querySelectorAll('.phase-box:not(.combo-box)').forEach(b => b.classList.remove('selected'));
                el.classList.toggle('selected');
                if (el.classList.contains('selected') && document.getElementById('cb-reg').value == 0 && document.getElementById('cb-feat').value == 0 && document.getElementById('cb-mon').value == 0) {
                    document.getElementById('cb-reg').value = 1; 
                } else if (!el.classList.contains('selected')) {
                    document.getElementById('cb-reg').value = 0;
                    document.getElementById('cb-feat').value = 0;
                    document.getElementById('cb-mon').value = 0;
                }
            } else {
                let cb = document.getElementById('phase-4-box');
                if(cb) {
                    cb.classList.remove('selected');
                    document.getElementById('cb-reg').value = 0;
                    document.getElementById('cb-feat').value = 0;
                    document.getElementById('cb-mon').value = 0;
                }
                el.classList.toggle('selected');
            }
            updateCheckout();
        }

        function updateCheckout() {
            let totalMin = 0;
            let totalMax = 0;
            let maxPhaseSelected = 0;
            
            let customBox = document.getElementById('phase-4-box');
            let isCustom = customBox && customBox.classList.contains('selected');

            if (isCustom) {
                let r = parseInt(document.getElementById('cb-reg').value);
                let f = parseInt(document.getElementById('cb-feat').value);
                let m = parseInt(document.getElementById('cb-mon').value);
                let customTotal = r + f + (m * 12); 
                totalMin = customTotal;
                totalMax = customTotal;
                maxPhaseSelected = 4;
            } else {
                document.querySelectorAll('.phase-box.selected:not(.combo-box)').forEach(box => {
                    totalMin += parseInt(box.getAttribute('data-min'));
                    totalMax += parseInt(box.getAttribute('data-max'));
                    let p = parseInt(box.getAttribute('data-phase'));
                    if(p > maxPhaseSelected) maxPhaseSelected = p;
                });
            }
            
            globalTotalMin = totalMin;
            globalTotalMax = totalMax;
            
            const btn = document.getElementById('btn-checkout');
            const valDisplay = document.getElementById('calc-val');
            const data = planData[currentPlanKey];

            const vImg = document.getElementById('visual-img');
            const vTitle = document.getElementById('visual-title');
            const vDesc = document.getElementById('visual-desc');

            if(maxPhaseSelected === 0) {
                vImg.style.filter = 'brightness(0.3) grayscale(1)';
                vTitle.innerText = 'è¯·é€‰æ‹©æ‚¨çš„èœ•å˜ç›®æ ‡';
                vDesc.innerText = 'ç‚¹é€‰ä¸Šæ–¹é˜¶æ®µï¼ŒAIå°†ä¸ºæ‚¨æŠ•å°„å¯¹åº”å½¢æ€';
                valDisplay.innerHTML = '<span style="color:#666; font-size:12px;">å¾…é€‰æ‹©ç›®æ ‡é˜¶æ®µ</span>';
                btn.classList.add('disabled');
            } else {
                vImg.style.filter = 'brightness(0.8) contrast(1.1)';
                if(maxPhaseSelected === 1) {
                    vImg.src = data.img1; vTitle.innerText = 'PHASE 01: åŸºç¡€è¾¾æˆ'; vDesc.innerText = data.txt1;
                } else if(maxPhaseSelected === 2) {
                    vImg.src = data.img2; vTitle.innerText = 'PHASE 02: è¿›é˜¶èœ•å˜'; vDesc.innerText = data.txt2;
                } else {
                    vImg.src = data.img3; 
                    if(maxPhaseSelected === 3) {
                        vTitle.innerText = 'PHASE 03: ç»ˆå±€å®šå‹'; vDesc.innerText = data.txt3;
                    } else {
                        vTitle.innerText = 'âœ¦ é¡¶çº§ç§æ•™VIPæ‰˜ç®¡ âœ¦'; vDesc.innerText = 'çªç ´å•ä¸€ç“¶é¢ˆï¼Œé‡èº«å®šåˆ¶å…¨æ¯å·…å³°çŠ¶æ€';
                    }
                }
                
                if(totalMin === totalMax && isCustom) {
                    valDisplay.innerHTML = `${totalMin} <span>èŠ‚ (å«åŒ…æœˆæŠ˜ç®—)</span>`;
                } else {
                    valDisplay.innerHTML = `${totalMin} - ${totalMax} <span>èŠ‚</span>`;
                }
                
                btn.classList.remove('disabled');
                if(navigator.vibrate) navigator.vibrate(50);
            }
        }

        // ğŸš¨ å¼¹çª—é€»è¾‘ (ä¿®å¤ä¸é‡æ„)
        function showUpsellModal() {
            if(globalTotalMax === 0) return;
            
            let customBox = document.getElementById('phase-4-box');
            let isCustom = customBox && customBox.classList.contains('selected');
            const data = planData[currentPlanKey];

            if (isCustom) {
                // ====== æ•™ç»ƒä¸“å±é«˜å®šå• ======
                document.getElementById('standard-upsell-content').style.display = 'none';
                document.getElementById('custom-upsell-content').style.display = 'block';
                document.getElementById('up-sub-text').innerHTML = `ç³»ç»Ÿå·²ä¸ºæ‚¨æ ¸ç®—ä»¥ä¸‹ <strong style="color:var(--primary)">é«˜å®šç§äº«ç»„åˆ</strong>ï¼Œå«ä¸“å±ç ´å†°ç¦åˆ©ï¼š`;

                let r = parseInt(document.getElementById('cb-reg').value);
                let f = parseInt(document.getElementById('cb-feat').value);
                let m = parseInt(document.getElementById('cb-mon').value);

                let oriReg = r * getUnitPrice(r, 'regular');
                let oriFeat = f * getUnitPrice(f, 'feature');
                let oriMon = m > 0 ? getMonthlyPrice(m) : 0;
                let totalOri = oriReg + oriFeat + oriMon;

                let newReg = r * 350;
                let newFeat = f * 380; 
                let newMon = oriMon; 
                let totalNew = newReg + newFeat + newMon;

                let bHtml = '';
                if(r > 0) bHtml += `<div class="uc-brk-row"><span>å¸¸è§„è¯¾ (60åˆ†é’Ÿ/èŠ‚)</span> <span class="hl">${r} èŠ‚</span></div>`;
                if(f > 0) bHtml += `<div class="uc-brk-row"><span>ç‰¹è‰²è¯¾ (45åˆ†é’Ÿ/èŠ‚)</span> <span class="hl">${f} èŠ‚</span></div>`;
                if(m > 0) {
                    bHtml += `<div class="uc-brk-row" style="margin-top:4px;"><span>åŒ…æœˆå¡ (45åˆ†é’Ÿ/èŠ‚)</span> <span class="hl">${m} ä¸ªæœˆ</span></div>`;
                    bHtml += `<div style="text-align:right; font-size:10px; color:#888; margin-top:-4px;">(å«åŒ…æœˆè´¹ç”¨ Â¥${formatMoney(newMon)})</div>`;
                }

                document.getElementById('custom-breakdown-details').innerHTML = bHtml;
                document.getElementById('up-custom-ori').innerText = `å¸¸è§„æ‰§è¡Œæ€»ä»· Â¥${formatMoney(totalOri)}`;
                document.getElementById('up-custom-new').innerText = formatMoney(totalNew);
                
                // ç»‘å®šç­¾åé¡µäº‹ä»¶
                document.getElementById('btn-sign-custom').onclick = function() {
                    openSignature('é«˜å®šç§äº«ç»„åˆåŒ…', (r+f) + 'èŠ‚ + ' + m + 'ä¸ªæœˆ', 'Â¥ ' + formatMoney(totalNew));
                };

            } else {
                // ====== æ ‡å‡†å¿ƒç†å­¦ä¸‰è½¨æ–¹æ¡ˆ ======
                document.getElementById('standard-upsell-content').style.display = 'block';
                document.getElementById('custom-upsell-content').style.display = 'none';
                document.getElementById('up-sub-text').innerHTML = `ç³»ç»Ÿå·²ä¸ºæ‚¨æ¥å…¥ <strong style="color:var(--primary)">ã€é¦–æ¬¡å»ºæ¡£ä¸“äº«ã€‘</strong> ç ´å†°è´¹ç‡ï¼š`;

                let pkgEntry = 12, pkgCore = 48, pkgAnchor = 72;
                
                for(let i=standardPackages.length-1; i>=0; i--) {
                    if(globalTotalMin >= standardPackages[i]) { pkgEntry = standardPackages[i]; break; }
                }
                for(let i=0; i<standardPackages.length; i++) {
                    if(globalTotalMax <= standardPackages[i]) { pkgCore = standardPackages[i]; break; }
                }
                if(globalTotalMax > standardPackages[standardPackages.length-1]) pkgCore = standardPackages[standardPackages.length-1];
                if(pkgCore <= pkgEntry) {
                    let idx = standardPackages.indexOf(pkgEntry);
                    pkgCore = standardPackages[Math.min(idx+1, standardPackages.length-1)];
                }
                let coreIdx = standardPackages.indexOf(pkgCore);
                pkgAnchor = standardPackages[Math.min(coreIdx+1, standardPackages.length-1)];
                if(pkgAnchor === pkgCore) {
                    if(coreIdx > 1) {
                        pkgEntry = standardPackages[coreIdx-2];
                        pkgCore = standardPackages[coreIdx-1];
                    }
                }

                let unitA = getUnitPrice(pkgAnchor, data.type);
                let unitB = getUnitPrice(pkgCore, data.type);
                let unitC = getUnitPrice(pkgEntry, data.type);
                
                let totalOriA = pkgAnchor * unitA;
                let totalOriB = pkgCore * unitB;
                let totalOriC = pkgEntry * unitC;

                let newbiePrice = (data.type === 'feature') ? 380 : 350;
                let totalNewA = pkgAnchor * newbiePrice;
                let totalNewB = pkgCore * newbiePrice;
                let totalNewC = pkgEntry * newbiePrice;

                // èµ‹å€¼ A
                document.getElementById('up-a-unit-ori').innerText = `Â¥${unitA}/èŠ‚`;
                document.getElementById('up-a-unit-new').innerText = `Â¥${newbiePrice}/èŠ‚`;
                document.getElementById('up-a-sessions').innerHTML = `${pkgAnchor} <span>èŠ‚</span>`;
                document.getElementById('up-a-ori').innerText = `åŸæ€»ä»· Â¥${formatMoney(totalOriA)}`;
                document.getElementById('up-a-new').innerText = formatMoney(totalNewA);
                document.getElementById('btn-sign-a').onclick = function() { openSignature('æè‡´é‡å¡‘åŒ…', pkgAnchor + 'èŠ‚', 'Â¥ ' + formatMoney(totalNewA)); };

                // èµ‹å€¼ B
                document.getElementById('up-b-unit-ori').innerText = `Â¥${unitB}/èŠ‚`;
                document.getElementById('up-b-unit-new').innerText = `Â¥${newbiePrice}/èŠ‚`;
                document.getElementById('up-b-sessions').innerHTML = `${pkgCore} <span>èŠ‚</span>`;
                document.getElementById('up-b-ori').innerText = `åŸæ€»ä»· Â¥${formatMoney(totalOriB)}`;
                document.getElementById('up-b-new').innerText = formatMoney(totalNewB);
                document.getElementById('btn-sign-b').onclick = function() { openSignature('é»„é‡‘å‘¨æœŸæ ¸å¿ƒåŒ…', pkgCore + 'èŠ‚', 'Â¥ ' + formatMoney(totalNewB)); };

                // èµ‹å€¼ C
                document.getElementById('up-c-unit-ori').innerText = `Â¥${unitC}/èŠ‚`;
                document.getElementById('up-c-unit-new').innerText = `Â¥${newbiePrice}/èŠ‚`;
                document.getElementById('up-c-sessions').innerHTML = `${pkgEntry} <span>èŠ‚</span>`;
                document.getElementById('up-c-ori').innerText = `åŸæ€»ä»· Â¥${formatMoney(totalOriC)}`;
                document.getElementById('up-c-new').innerText = formatMoney(totalNewC);
                document.getElementById('btn-sign-c').onclick = function() { openSignature('ä½é—¨æ§›å¯åŠ¨åŒ…', pkgEntry + 'èŠ‚', 'Â¥ ' + formatMoney(totalNewC)); };
            }

            document.getElementById('upsellOverlay').classList.add('show');
            document.getElementById('upsellModal').classList.add('show');
        }

        function closeUpsellModal() {
            document.getElementById('upsellOverlay').classList.remove('show');
            document.getElementById('upsellModal').classList.remove('show');
        }

        // ğŸš¨ ç»ˆææ ¸æ­¦ï¼šå…¨å±ç”µå­ç­¾åç”»å¸ƒç³»ç»Ÿ
        let sigCanvas, sigCtx, isSigning = false;

        function openSignature(pkgName, sessions, price) {
            // å…³é—­ä¸Šä¸€ä¸ªå¼¹çª—
            closeUpsellModal();
            
            // å†™å…¥æ˜ç»†æ•°æ®
            document.getElementById('sig-sys-name').innerText = planData[currentPlanKey].title;
            document.getElementById('sig-pkg-name').innerHTML = `${pkgName} <span style="font-size:14px; color:#aaa; font-weight:normal;">(${sessions})</span>`;
            document.getElementById('sig-pkg-price').innerText = price;
            
            // å¼¹å‡ºç”»æ¿
            document.getElementById('signatureModal').classList.add('show');
            
            // åˆå§‹åŒ–ç”»å¸ƒ (å¿…é¡»ç­‰åŠ¨ç”»ç»“æŸåè·å–å°ºå¯¸)
            setTimeout(() => {
                sigCanvas = document.getElementById('sigCanvas');
                sigCtx = sigCanvas.getContext('2d');
                let rect = sigCanvas.parentElement.getBoundingClientRect();
                sigCanvas.width = rect.width;
                sigCanvas.height = rect.height;
                
                sigCtx.strokeStyle = '#D4AF37'; // å°Šè´µé‡‘å¢¨æ°´
                sigCtx.lineWidth = 4;
                sigCtx.lineCap = 'round';
                sigCtx.lineJoin = 'round';
                
                // ç»‘å®šäº‹ä»¶ (é˜²é¡µé¢æ»šåŠ¨)
                sigCanvas.addEventListener('touchstart', startSign, {passive: false});
                sigCanvas.addEventListener('touchmove', drawSign, {passive: false});
                sigCanvas.addEventListener('touchend', endSign);
                sigCanvas.addEventListener('mousedown', startSign);
                sigCanvas.addEventListener('mousemove', drawSign);
                sigCanvas.addEventListener('mouseup', endSign);
                sigCanvas.addEventListener('mouseout', endSign);
            }, 400);
        }

        function closeSignature() {
            document.getElementById('signatureModal').classList.remove('show');
            clearCanvas();
        }

        function getSignPos(e) {
            let rect = sigCanvas.getBoundingClientRect();
            let x = e.clientX, y = e.clientY;
            if(e.touches && e.touches.length > 0) {
                x = e.touches[0].clientX;
                y = e.touches[0].clientY;
            }
            return { x: x - rect.left, y: y - rect.top };
        }

        function startSign(e) {
            e.preventDefault();
            isSigning = true;
            let pos = getSignPos(e);
            sigCtx.beginPath();
            sigCtx.moveTo(pos.x, pos.y);
            document.querySelector('.sig-placeholder').style.display = 'none'; // éšè—æç¤ºå­—
        }

        function drawSign(e) {
            if(!isSigning) return;
            e.preventDefault();
            let pos = getSignPos(e);
            sigCtx.lineTo(pos.x, pos.y);
            sigCtx.stroke();
        }

        function endSign() {
            isSigning = false;
            sigCtx.closePath();
        }

        function clearCanvas() {
            if(!sigCtx) return;
            sigCtx.clearRect(0, 0, sigCanvas.width, sigCanvas.height);
            document.querySelector('.sig-placeholder').style.display = 'block';
        }

        function submitSignature() {
            // è¿™é‡Œå¯ä»¥åŠ å…¥å°† Canvas è½¬åŒ–ä¸ºå›¾ç‰‡çš„é€»è¾‘: sigCanvas.toDataURL("image/png")
            alert('æ­å–œï¼åˆåŒå·²ç”Ÿæˆå¹¶é™„å¸¦æ‚¨çš„ä¸“å±ç­¾åï¼Œç³»ç»Ÿå°†è‡ªåŠ¨å½•å…¥å®¢æˆ·æ¡£æ¡ˆåº“ã€‚');
            closeSignature();
            closeDetail(); // ç­¾å®Œå›åˆ°ä¸»ç•Œé¢
        }
    </script>
</body>
</html>
