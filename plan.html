<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>ç§äººå®šåˆ¶é«˜ç«¯è¯¾ç¨‹</title>
    <style>
        /* é¡¶çº§é¦™æ§Ÿé»‘é‡‘é…è‰² */
        :root { --primary: #D4AF37; --accent: #C5A059; --bg: #050505; --surface: #121212; --text-main: #E2E8F0; --text-sub: #8A92A3; }
        
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; margin: 0; padding: 0; }
        html, body { width: 100%; max-width: 100vw; overflow-x: hidden; background: var(--bg); color: var(--text-main); font-family: "DIN Alternate", "Helvetica Neue", sans-serif; -webkit-font-smoothing: antialiased; }
        
        .header-brand { width: 100%; height: 60px; display: flex; align-items: center; justify-content: center; background: rgba(5, 5, 5, 0.85); position: sticky; top: 0; z-index: 50; border-bottom: 1px solid rgba(212, 175, 55, 0.15); backdrop-filter: blur(15px);}
        .brand-text { font-size: 18px; font-weight: 900; color: var(--primary); letter-spacing: 2px; }
        
        .intro-sec { padding: 25px 20px 15px; text-align: center; }
        .main-title { font-size: 22px; font-weight: 900; color: #fff; margin-bottom: 8px; letter-spacing: 1px;}
        .sub-title { font-size: 12px; color: var(--text-sub); line-height: 1.5; }

        .gallery-container { padding: 10px 15px 100px; display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        
        .sol-card { position: relative; height: 180px; border-radius: 16px; overflow: hidden; display: flex; flex-direction: column; justify-content: flex-end; cursor: pointer; border: 1px solid rgba(255,255,255,0.08); box-shadow: inset 0 0 30px rgba(0,0,0,0.8), 0 10px 20px rgba(0,0,0,0.5); transition: 0.3s; background: linear-gradient(145deg, #18181C, #050505); }
        .sol-card:active { transform: scale(0.96); border-color: var(--primary); box-shadow: 0 5px 15px rgba(212,175,55,0.2); }
        
        .watermark { position: absolute; right: -15px; bottom: -15px; width: 140px; height: 140px; opacity: 0.25; z-index: 1; pointer-events: none; transition: transform 0.5s ease, opacity 0.5s ease; filter: drop-shadow(0 0 8px rgba(212,175,55,0.2)); }
        .watermark img { width: 100%; height: 100%; object-fit: contain; }
        .sol-card:active .watermark { opacity: 0.4; transform: scale(1.1) translate(-5px, -5px); }

        .card-content { padding: 15px; position: relative; z-index: 2; }
        .c-icon { margin-bottom: 10px; display: flex; align-items: center; }
        .c-icon svg { width: 28px; height: 28px; stroke: var(--primary); filter: drop-shadow(0 0 6px rgba(212,175,55,0.8)); }
        .c-title { font-size: 15px; font-weight: 900; color: #fff; margin-bottom: 6px; letter-spacing: 1px;}
        .c-desc { font-size: 11px; color: #aaa; line-height: 1.4; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }

        .detail-modal { position: fixed; top: 100vh; left: 0; width: 100%; height: 100vh; background: var(--bg); z-index: 999; transition: top 0.5s cubic-bezier(0.2, 0.8, 0.2, 1); display: flex; flex-direction: column; overflow-x: hidden; }
        .detail-modal.show { top: 0; }

        .modal-header { height: 60px; display: flex; justify-content: space-between; align-items: center; padding: 0 20px; background: rgba(5,5,5,0.95); border-bottom: 1px solid rgba(212,175,55,0.2); backdrop-filter: blur(10px); flex-shrink: 0;}
        .modal-title { font-size: 16px; font-weight: bold; color: var(--primary); }
        .close-btn { color: #fff; font-size: 24px; font-weight: bold; background: none; border: none; padding: 0 10px; cursor: pointer;}

        .modal-body { flex: 1; overflow-y: auto; overflow-x: hidden; padding: 20px 20px 140px; -webkit-overflow-scrolling: touch; }
        
        .hero-banner { border: 1px solid rgba(212, 175, 55, 0.3); border-radius: 16px; padding: 25px 20px; margin-bottom: 20px; background: linear-gradient(145deg, #16161A, #050505); box-shadow: 0 10px 30px rgba(0,0,0,0.5); position: relative; overflow: hidden;}
        .hero-watermark { position: absolute; right: -20px; top: -20px; width: 140px; height: 140px; opacity: 0.15; pointer-events: none; filter: drop-shadow(0 0 15px rgba(255,255,255,0.1)); }
        .hero-watermark img { width: 100%; height: 100%; object-fit: contain; }
        .m-hero-title { font-size: 22px; font-weight: 900; color: #fff; margin-bottom: 10px; letter-spacing: 1px; position: relative; z-index: 2;}
        .m-hero-desc { font-size: 13px; color: var(--text-sub); line-height: 1.6; position: relative; z-index: 2;}
        
        .freq-panel { background: rgba(212,175,55,0.05); border: 1px solid rgba(212,175,55,0.3); border-radius: 12px; padding: 15px 10px; margin-bottom: 25px; box-shadow: inset 0 0 20px rgba(0,0,0,0.5); }
        .freq-title { font-size: 13px; color: var(--primary); font-weight: bold; margin-bottom: 12px; padding-left: 5px; display: flex; align-items: center; gap: 6px;}
        .freq-group { display: flex; gap: 6px; }
        .freq-btn { flex: 1; text-align: center; padding: 8px 0; border-radius: 8px; background: #111; border: 1px solid #333; color: #888; font-size: 13px; font-weight: 900; cursor: pointer; transition: 0.3s; line-height: 1.3;}
        .freq-btn span { font-size: 9px; font-weight: normal; color: #666; display: block; transform: scale(0.9);}
        .freq-btn.active { background: linear-gradient(135deg, #2A2210, #0A0A0C); border-color: var(--primary); color: var(--primary); box-shadow: 0 4px 10px rgba(212,175,55,0.2);}
        .freq-btn.active span { color: #aaa; }

        .phase-title-main { font-size: 14px; color: #888; margin-bottom: 15px; display: flex; align-items: center; gap: 8px; border-top: 1px solid #222; padding-top: 25px; letter-spacing: 1px;}
        
        .phase-box { border: 1px solid rgba(255,255,255,0.05); border-radius: 12px; padding: 20px 50px 20px 20px; position: relative; margin-bottom: 20px; background: #0a0a0c; cursor: pointer; transition: 0.3s; box-shadow: 0 5px 15px rgba(0,0,0,0.5); }
        .phase-box.selected { border-color: rgba(212,175,55,0.6); background: linear-gradient(145deg, rgba(212,175,55,0.08), #050505); box-shadow: 0 10px 25px rgba(212,175,55,0.15); }
        
        .combo-box { border: 1px dashed rgba(212,175,55,0.4); background: linear-gradient(145deg, #18150D, #0A0A0C); margin-top: 30px; }
        .combo-box.selected { border: 1px solid var(--primary); background: linear-gradient(145deg, #2A2210, #0A0A0C); box-shadow: 0 10px 25px rgba(212,175,55,0.25); }

        .check-circle { position: absolute; top: 20px; right: 20px; width: 22px; height: 22px; border-radius: 50%; border: 2px solid #444; display: flex; align-items: center; justify-content: center; transition: 0.3s; pointer-events: none;}
        .phase-box.selected .check-circle { border-color: var(--primary); background: var(--primary); }
        .check-circle::after { content: 'âœ“'; color: #000; font-size: 14px; font-weight: 900; opacity: 0; transition: 0.3s; margin-top: 2px;}
        .phase-box.selected .check-circle::after { opacity: 1; }

        .p-step { font-size: 11px; color: #888; font-weight: bold; letter-spacing: 2px; margin-bottom: 12px;}
        .phase-box.selected .p-step { color: var(--primary); }
        
        .p-cycle-highlight { display: flex; flex-direction: column; gap: 6px; background: linear-gradient(90deg, rgba(212, 175, 55, 0.1), transparent); border-left: 3px solid #444; padding: 10px 12px; margin-bottom: 18px; border-radius: 0 8px 8px 0; transition: 0.3s; }
        .phase-box.selected .p-cycle-highlight { border-left-color: var(--primary); background: linear-gradient(90deg, rgba(212, 175, 55, 0.2), transparent); }
        .cycle-row { display: flex; align-items: center; gap: 8px; font-size: 14px; font-weight: 900; color: #888; letter-spacing: 1px; transition: 0.3s;}
        .phase-box.selected .cycle-row { color: #fff; }
        .cycle-row .icon { font-size: 16px; color: #555; margin-top: -2px; transition: 0.3s;}
        .phase-box.selected .cycle-row .icon { color: var(--primary); }
        .cycle-row .highlight-text { color: #888; }
        .phase-box.selected .cycle-row .highlight-text { color: var(--primary); text-shadow: 0 0 10px rgba(212,175,55,0.4); }
        
        .p-name { font-size: 18px; font-weight: 900; color: #888; margin-bottom: 15px; transition: 0.3s;}
        .phase-box.selected .p-name { color: #fff; }
        
        .sales-points { display: flex; flex-direction: column; gap: 12px; opacity: 0.5; transition: 0.3s; }
        .phase-box.selected .sales-points { opacity: 1; }
        .sp-row { display: flex; align-items: flex-start; gap: 10px; font-size: 13px; line-height: 1.6; }
        .sp-tag { flex-shrink: 0; font-size: 11px; font-weight: bold; padding: 3px 8px; border-radius: 4px; border: 1px solid; margin-top: 2px;}
        .tag-goal { color: #aaa; border-color: #555; background: rgba(255,255,255,0.05); }
        .tag-tech { color: #C5A059; border-color: rgba(212,175,55,0.4); background: rgba(212,175,55,0.05); }
        .tag-feel { color: #000; border-color: var(--primary); background: var(--primary); }
        
        .sp-text { color: #ccc; flex: 1; border-bottom: 1px dashed rgba(212,175,55,0.2); padding-bottom: 3px; outline: none; transition: 0.3s; cursor: text; min-height: 22px;}
        .sp-text:focus { border-bottom: 1px solid var(--primary); background: rgba(255,255,255,0.05); padding: 4px 6px; border-radius: 4px; color: #fff;}
        .sp-text strong { color: var(--primary); font-weight: bold; text-shadow: 0 0 8px rgba(212,175,55,0.3); }

        .custom-builder { margin-top: 15px; border-top: 1px dashed rgba(212,175,55,0.3); padding-top: 15px; display: flex; flex-direction: column; gap: 12px; }
        .cb-item { display: flex; justify-content: space-between; align-items: center; background: rgba(0,0,0,0.5); padding: 10px 12px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.05);}
        .cb-label { font-size: 14px; color: #fff; font-weight: bold; display: flex; flex-direction: column; gap: 4px;}
        .cb-label span { font-size: 10px; color: var(--primary); font-weight: normal; opacity: 0.9; margin-top: 2px;}
        .cb-ctrl { display: flex; align-items: center; background: #111; border-radius: 8px; border: 1px solid rgba(212,175,55,0.3); overflow: hidden; flex-shrink: 0;}
        .cb-btn { width: 34px; height: 34px; display: flex; justify-content: center; align-items: center; color: var(--primary); font-size: 18px; font-weight: bold; cursor: pointer; user-select: none; }
        .cb-btn:active { background: rgba(212,175,55,0.2); }
        .cb-input { width: 45px; text-align: center; background: #000; border: none; border-left: 1px solid #333; border-right: 1px solid #333; color: #fff; font-size: 16px; font-weight: 900; padding: 6px 0; outline: none; pointer-events: auto; touch-action: manipulation;}
        .cb-input::-webkit-outer-spin-button, .cb-input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        .cb-input[type=number] { -moz-appearance: textfield; }

        .visual-feedback-section { margin-top: 30px; background: #0a0a0c; border: 1px solid rgba(212, 175, 55, 0.15); border-radius: 16px; padding: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .fb-header { text-align: center; font-size: 15px; font-weight: 900; color: var(--primary); margin-bottom: 15px; letter-spacing: 2px; }
        
        /* è€æ¿é€šé“æŒ‰é’®ï¼šæ‰€æœ‰æ¿å—é€šç”¨ */
        .admin-upload-btn { background: linear-gradient(135deg, rgba(212,175,55,0.1), rgba(212,175,55,0.05)); border: 1px dashed var(--primary); color: var(--primary); text-align: center; padding: 12px; border-radius: 8px; font-size: 13px; font-weight: bold; cursor: pointer; margin-bottom: 15px; transition: 0.3s; letter-spacing: 1px; box-shadow: 0 4px 10px rgba(0,0,0,0.5);}
        .admin-upload-btn:active { background: rgba(212,175,55,0.2); transform: scale(0.98); }

        .visual-card { width: 100%; height: 320px; border-radius: 12px; overflow: hidden; position: relative; border: 1px solid rgba(255,255,255,0.1); background: #111;}
        .visual-img { width: 100%; height: 100%; object-fit: cover; transition: all 0.5s ease-in-out; }
        
        .scanning-line { position: absolute; top: -10%; left: 0; width: 100%; height: 2px; background: rgba(212, 175, 55, 0.9); box-shadow: 0 0 25px 8px rgba(212, 175, 55, 0.5); opacity: 0; z-index: 5; pointer-events: none;}
        @keyframes aiScan { 0% { top: -10%; opacity: 0; } 10% { opacity: 1; } 90% { opacity: 1; } 100% { top: 110%; opacity: 0; } }
        .scanning-active .scanning-line { animation: aiScan 1.5s ease-in-out; }
        .scanning-active .visual-img { filter: brightness(1.05) saturate(1.05); transform: scale(1.05); }

        .visual-overlay { position: absolute; bottom: 0; left: 0; width: 100%; padding: 40px 15px 15px; background: linear-gradient(to top, rgba(0,0,0,0.9), rgba(0,0,0,0.3), transparent); display: flex; flex-direction: column; justify-content: flex-end; z-index: 10; pointer-events: none;}
        .visual-title { color: var(--primary); font-size: 20px; font-weight: 900; letter-spacing: 1px; margin-bottom: 6px; text-shadow: 0 2px 5px rgba(0,0,0,0.8);}
        .visual-desc { color: #fff; font-size: 13px; line-height: 1.5; text-shadow: 0 1px 3px rgba(0,0,0,0.8); font-weight: bold;}

        .checkout-bar { position: fixed; bottom: 0; left: 0; width: 100%; padding: 15px 20px 25px; background: rgba(10, 10, 12, 0.98); border-top: 1px solid rgba(212,175,55,0.3); box-shadow: 0 -10px 30px rgba(0,0,0,0.8); z-index: 100; backdrop-filter: blur(15px); display: flex; justify-content: space-between; align-items: center; }
        .checkout-info { display: flex; flex-direction: column; gap: 4px; }
        .c-info-label { font-size: 11px; color: #888; font-weight: bold; letter-spacing: 1px; }
        .c-info-val { font-size: 15px; font-weight: 900; color: #fff; display: flex; align-items: baseline; gap: 4px;}
        .c-info-val span { font-size: 11px; color: #888; font-weight: normal; }
        .btn-checkout { background: linear-gradient(135deg, var(--primary), #AA8A2A); color: #000; border: none; padding: 14px 18px; border-radius: 12px; font-size: 14px; font-weight: 900; box-shadow: 0 8px 20px rgba(212, 175, 55, 0.3); cursor: pointer; transition: 0.3s; }
        .btn-checkout:active { transform: scale(0.96); }
        .btn-checkout.disabled { background: #333; color: #666; box-shadow: none; pointer-events: none; }

        /* ğŸš¨ ä¸“å±è§†è§‰é…ç½®å° (æ–°åŠ å…¥çš„ç‹¬ç«‹æ¨¡å—) */
        .admin-modal-wrap { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 3000; display: none; flex-direction: column; justify-content: center; align-items: center; padding: 20px; backdrop-filter: blur(10px); opacity: 0; transition: opacity 0.3s;}
        .admin-modal-wrap.show { display: flex; opacity: 1;}
        .admin-modal-content { background: #111; border: 1px solid var(--primary); border-radius: 16px; width: 100%; max-width: 400px; padding: 20px; box-shadow: 0 10px 40px rgba(212,175,55,0.3); max-height: 90vh; overflow-y: auto;}
        .admin-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px dashed rgba(212,175,55,0.3); padding-bottom: 15px; margin-bottom: 15px;}
        .admin-title { color: var(--primary); font-size: 18px; font-weight: bold;}
        .admin-close { color: #888; font-size: 28px; cursor: pointer; line-height: 1;}
        .admin-subtitle { color: #fff; font-size: 14px; margin-bottom: 15px; text-align: center; font-weight: bold;}
        .admin-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;}
        .admin-slot { background: #000; border: 1px solid #333; border-radius: 10px; padding: 10px; display: flex; flex-direction: column; align-items: center;}
        .slot-title { color: #888; font-size: 12px; margin-bottom: 8px;}
        .slot-img { width: 100%; height: 120px; object-fit: cover; border-radius: 6px; margin-bottom: 10px; border: 1px solid #222;}
        .slot-btn { background: #222; color: #fff; border: 1px solid #444; border-radius: 6px; padding: 8px; width: 100%; font-size: 12px; cursor: pointer;}
        .slot-btn:active { background: var(--primary); color: #000;}
        .admin-save-btn { width: 100%; background: linear-gradient(135deg, var(--primary), #AA8A2A); color: #000; border: none; padding: 14px; border-radius: 10px; font-size: 16px; font-weight: 900; box-shadow: 0 5px 15px rgba(212, 175, 55, 0.3); cursor: pointer;}

        .upsell-overlay { position: fixed; top:0; left:0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 1000; opacity: 0; pointer-events: none; transition: 0.4s; backdrop-filter: blur(8px); }
        .upsell-overlay.show { opacity: 1; pointer-events: auto; }
        
        .upsell-modal { position: fixed; bottom: -100%; left: 0; width: 100%; background: linear-gradient(180deg, #121215, #050505); border-top: 1px solid var(--primary); border-radius: 24px 24px 0 0; z-index: 1001; padding: 25px 20px 30px; transition: 0.5s cubic-bezier(0.2, 0.8, 0.2, 1); box-shadow: 0 -10px 50px rgba(212,175,55,0.15); max-height: 90vh; overflow-y: hidden; overflow-x: hidden; display: flex; flex-direction: column;}
        .upsell-modal.show { bottom: 0; }
        
        .up-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 15px; flex-shrink: 0;}
        .up-title { font-size: 18px; font-weight: 900; color: #fff; letter-spacing: 1px; }
        .up-sub { font-size: 11px; color: #aaa; margin-top: 6px; line-height: 1.5; }
        .up-close { color: #888; font-size: 28px; background: none; border: none; padding: 0; line-height: 1; cursor: pointer; }
        .upsell-cards-container { overflow-y: auto; overflow-x: hidden; padding-bottom: 10px; flex: 1; -webkit-overflow-scrolling: touch; padding-top: 10px;}
        
        .dash-card { background: linear-gradient(145deg, #16161A, #0A0A0C); border: 2px solid #222; border-radius: 16px; padding: 32px 15px 15px; position: relative; margin-bottom: 15px; transition: 0.3s; opacity: 0.6; cursor: pointer; box-shadow: 0 5px 15px rgba(0,0,0,0.5);}
        .dash-card.selected-card { opacity: 1; border-color: var(--primary); background: linear-gradient(145deg, #1F1910, #0A0A0C); box-shadow: 0 10px 30px rgba(212,175,55,0.2); transform: scale(1.02); }
        .check-ribbon { display: none; position: absolute; top: -2px; left: -2px; background: linear-gradient(135deg, var(--accent), var(--primary)); color: #000; font-size: 10px; font-weight: bold; padding: 4px 12px; border-radius: 14px 0 14px 0; z-index: 10;}
        .selected-card .check-ribbon { display: block; }
        .save-tag { position: absolute; top: -2px; right: -2px; background: linear-gradient(135deg, #FF4B40, #D91D12); color: #fff; font-size: 10px; font-weight: 900; padding: 4px 12px; border-radius: 0 14px 0 14px; z-index: 10; box-shadow: -2px 2px 10px rgba(217, 29, 18, 0.3);}
        .dash-card.basic .save-tag { background: #444; color: #aaa; box-shadow: none;}

        .dc-title { font-size: 16px; font-weight: 900; color: #fff; margin-bottom: 4px; display: flex; align-items: center; gap: 6px; margin-top: 5px;}
        .selected-card .dc-title { color: var(--primary); }
        .dc-subtitle { font-size: 11px; color: #888; margin-bottom: 15px; line-height: 1.4;}
        .dc-flex { display: flex; justify-content: space-between; align-items: flex-end; border-bottom: 1px dashed rgba(255,255,255,0.1); padding-bottom: 12px; margin-bottom: 12px;}
        .dc-ses { font-size: 36px; font-weight: 900; color: #fff; line-height: 1;}
        .selected-card .dc-ses { color: var(--primary); }
        .dc-ses span { font-size: 12px; font-weight: normal; color: #888; margin-left: 4px;}
        .dc-right { text-align: right; }
        .dc-ori { font-size: 12px; color: #666; text-decoration: line-through; margin-bottom: 4px;}
        .dc-new { font-size: 28px; font-weight: 900; color: #fff; display: flex; align-items: baseline; justify-content: flex-end; gap: 2px;}
        .selected-card .dc-new { color: var(--primary); text-shadow: 0 0 15px rgba(212, 175, 55, 0.4);}
        .dc-new span { font-size: 16px; }
        .dc-footer { display: flex; justify-content: space-between; align-items: center; font-size: 11px;}
        .dc-f-ori { color: #888; }
        .dc-f-ori del { color: #666; margin-left: 4px;}
        .dc-f-new { color: var(--primary); font-weight: bold; font-size: 13px;}
        .basic .dc-f-new { color: #aaa; }
        .urgency-rule { background: rgba(212,175,55,0.08); border: 1px dashed rgba(212,175,55,0.4); border-radius: 6px; padding: 10px; margin-top: 15px; font-size: 10px; color: #aaa; line-height: 1.6; }
        .urgency-rule strong { color: var(--primary); }

        .upsell-action-bar { position: sticky; bottom: 0; background: linear-gradient(to top, #050505 85%, transparent); padding: 15px 0 0 0; margin-top: 5px; flex-shrink: 0;}
        .btn-confirm-master { width: 100%; background: linear-gradient(135deg, var(--primary), #AA8A2A); color: #000; border: none; padding: 16px; border-radius: 12px; font-size: 16px; font-weight: 900; box-shadow: 0 8px 25px rgba(212, 175, 55, 0.3); cursor: pointer; transition: 0.3s; }
        .btn-confirm-master:active { transform: scale(0.98); }

        .sig-modal { position: fixed; top: 100vh; left: 0; width: 100%; height: 100vh; background: #08080A; z-index: 2000; transition: top 0.4s cubic-bezier(0.2, 0.8, 0.2, 1); display: flex; flex-direction: column; overflow-x: hidden;}
        .sig-modal.show { top: 0; }
        .sig-header { height: 60px; display: flex; justify-content: space-between; align-items: center; padding: 0 20px; background: rgba(5,5,5,0.95); border-bottom: 1px solid rgba(212,175,55,0.3); flex-shrink:0;}
        .sig-title { font-size: 16px; font-weight: bold; color: var(--primary); }
        .sig-content { padding: 20px; flex: 1; display: flex; flex-direction: column; overflow-y: auto;}
        
        .sig-pad-wrap { flex: 1; display: flex; flex-direction: column; min-height: 300px;}
        .sig-summary { background: linear-gradient(145deg, #18181A, #0A0A0C); padding: 20px; border-radius: 12px; margin-bottom: 20px; border: 1px solid rgba(212,175,55,0.3); box-shadow: 0 10px 30px rgba(0,0,0,0.5);}
        .sig-sum-title { color: #fff; font-size: 14px; margin-bottom: 10px; font-weight: bold;}
        .sig-sum-data { display: flex; justify-content: space-between; align-items: flex-end; border-top: 1px dashed rgba(255,255,255,0.1); padding-top: 15px; margin-top: 10px;}
        .sig-sum-name { font-size: 16px; color: var(--primary); font-weight: 900;}
        .sig-sum-price { font-size: 24px; color: #fff; font-weight: 900;}
        .sig-pad-container { flex: 1; border: 1px dashed #555; border-radius: 12px; background: #111; position: relative; overflow: hidden; box-shadow: inset 0 0 20px rgba(0,0,0,0.8); min-height: 250px;}
        #sigCanvas { width: 100%; height: 100%; touch-action: none; cursor: crosshair; display: block;}
        .sig-placeholder { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #444; font-size: 24px; font-weight: bold; pointer-events: none; letter-spacing: 2px;}
        
        .sig-actions { display: flex; gap: 15px; margin-top: 20px; margin-bottom: 10px; flex-shrink:0;}
        .btn-clear { flex: 1; background: #222; color: #fff; padding: 16px; border-radius: 12px; text-align: center; border: 1px solid #444; font-weight: bold; font-size: 15px; cursor:pointer;}
        .btn-confirm-sig { flex: 2; background: linear-gradient(135deg, var(--primary), #AA8A2A); color: #000; padding: 16px; border-radius: 12px; text-align: center; border: none; font-weight: 900; font-size: 16px; box-shadow: 0 5px 20px rgba(212,175,55,0.3); cursor:pointer;}
    </style>
</head>
<body>

    <div class="header-brand">
        <div class="brand-text">ç§äººå®šåˆ¶é«˜ç«¯è¯¾ç¨‹</div>
    </div>

    <div class="intro-sec">
        <div class="main-title">å…­å¤§å°Šäº«é‡å¡‘çŸ©é˜µ</div>
        <div class="sub-title">ç³»ç»Ÿå·²æ ¹æ®æ‚¨çš„åŒ»å­¦æ’æŸ¥ä¸ä½“æ€è¯„ä¼°ï¼Œå¼€æ”¾ä»¥ä¸‹é¶å‘é‡å¡‘æ–¹æ¡ˆã€‚</div>
    </div>

    <div class="gallery-container">
        <div class="sol-card" onclick="openDetail('posture')">
            <div class="watermark"><img src="https://cdn-icons-png.flaticon.com/512/16292/16292717.png" alt="bg"></div>
            <div class="card-content"><div class="c-icon"><svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 5v14"/><path d="M8 9l4-4 4 4"/><path d="M8 19l4 4 4-4"/></svg></div><div class="c-title">ä½“æ€çŸ«æ­£ä¸ç»“æ„ä¼˜åŒ–</div><div class="c-desc">æ¾è§£å—é™ç­‹è†œï¼Œé‡å»ºè„ŠæŸ±ä¸­ç«‹ä½ï¼Œå½»åº•æ‹”é™¤è‚©é¢ˆè…°èƒŒç–¼ç—›æ ¹æºã€‚</div></div>
        </div>
        <div class="sol-card" onclick="openDetail('fatloss')">
            <div class="watermark"><img src="https://cdn-icons-png.flaticon.com/512/12805/12805546.png" alt="bg"></div>
            <div class="card-content"><div class="c-icon"><svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"/></svg></div><div class="c-title">é«˜æ•ˆç‡ƒè„‚ä¸ä»£è°¢æ¿€æ´»</div><div class="c-desc">çªç ´é¡½å›ºå¹³å°æœŸï¼Œç§‘å­¦å‰¥ç¦»å†…è„è„‚è‚ªï¼Œæ‰“é€ å…¨å¤©å€™é«˜ä»£è°¢ä½“è´¨ã€‚</div></div>
        </div>
        <div class="sol-card" onclick="openDetail('shape')">
            <div class="watermark"><img src="https://cdn-icons-png.flaticon.com/512/3340/3340004.png" alt="bg"></div>
            <div class="card-content"><div class="c-icon"><svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 22h14"/><path d="M5 2h14"/><path d="M17 22v-4.172a2 2 0 0 0-.586-1.414L12 12l-4.414 4.414A2 2 0 0 0 7 17.828V22"/><path d="M7 2v4.172a2 2 0 0 0 .586 1.414L12 12l4.414-4.414A2 2 0 0 0 17 6.172V2"/></svg></div><div class="c-title">Så‹æ›²çº¿ç²¾é›•è®­ç»ƒ</div><div class="c-desc">ä¸“æ”»èœœæ¡ƒè‡€ã€é©¬ç”²çº¿ä¸ç›´è§’è‚©ï¼Œé€šè¿‡è‚Œè‚¥å¤§å¡«å……å¡‘é€ æè‡´æ¯”ä¾‹ã€‚</div></div>
        </div>
        <div class="sol-card" onclick="openDetail('postpartum')">
            <div class="watermark"><img src="https://cdn-icons-png.flaticon.com/512/779/779980.png" alt="bg"></div>
            <div class="card-content"><div class="c-icon"><svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg></div><div class="c-title">äº§åæ ¸å¿ƒä¸ä½“å½¢æ¢å¤</div><div class="c-desc">é¿å¼€é«˜å±å·è…¹ï¼Œå†…æºæ€§é—­åˆè…¹ç›´è‚Œï¼Œå®‰å…¨æœ‰æ•ˆåœ°æ¢å¤ç›†åº•è‚Œæœºèƒ½ã€‚</div></div>
        </div>
        <div class="sol-card" onclick="openDetail('rehab')">
            <div class="watermark"><img src="https://cdn-icons-png.flaticon.com/512/2906/2906460.png" alt="bg"></div>
            <div class="card-content"><div class="c-icon"><svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg></div><div class="c-title">è¿åŠ¨åŠŸèƒ½æå‡ä¸é˜²æŠ¤</div><div class="c-desc">æ¶ˆé™¤å…³èŠ‚å¼¹å“ä¸è¿åŠ¨åˆºç—›ï¼Œå¼ºåŒ–æ·±å±‚å°è‚Œç¾¤ï¼Œé‡å»ºå…³èŠ‚åŠ›å­¦æŠ¤ç”²ã€‚</div></div>
        </div>
        <div class="sol-card" onclick="openDetail('antiaging')">
            <div class="watermark"><img src="https://cdn-icons-png.flaticon.com/512/8407/8407060.png" alt="bg"></div>
            <div class="card-content"><div class="c-icon"><svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg></div><div class="c-title">æ´»åŠ›ä½“èƒ½ä¸çŠ¶æ€ç„•æ–°</div><div class="c-desc">é€šè¿‡æŠ—é˜»åŠ›åˆºæ¿€æˆéª¨ç»†èƒï¼Œæå‡éª¨å¯†åº¦ä¸å¿ƒè‚ºå¼•æ“ï¼Œå¯¹æŠ—æœºèƒ½è¡°è€ã€‚</div></div>
        </div>
    </div>

    <div class="detail-modal" id="detailModal">
        <div class="modal-header">
            <div class="modal-title" id="m-header-title">å®šåˆ¶è·¯å¾„æ¨æ¼”</div>
            <button class="close-btn" onclick="closeDetail()">Ã—</button>
        </div>
        <div class="modal-body" id="modalBody"></div>
        <div class="checkout-bar">
            <div class="checkout-info">
                <div class="c-info-label">ç³»ç»Ÿæ ¸ç®—é¢„ä¼°è¯¾æ—¶</div>
                <div class="c-info-val" id="calc-val">-- <span>èŠ‚</span></div>
            </div>
            <button class="btn-checkout disabled" id="btn-checkout" onclick="showUpsellModal()">è·å–æ™ºèƒ½æŠ¥ä»·æ–¹æ¡ˆ â”</button>
        </div>
    </div>

    <div class="admin-modal-wrap" id="adminModalWrap">
        <div class="admin-modal-content">
            <div class="admin-header">
                <div class="admin-title">âœ¦ ä¸“å±è§†è§‰é…ç½®å° âœ¦</div>
                <div class="admin-close" onclick="closeAdmin()">Ã—</div>
            </div>
            <div class="admin-subtitle" id="admin-subtitle">å½“å‰é…ç½®ï¼šä½“æ€çŸ«æ­£ä¸ç»“æ„ä¼˜åŒ–</div>
            
            <div class="admin-grid">
                <div class="admin-slot">
                    <div class="slot-title">å¯¹åº”ï¼šé˜¶æ®µä¸€</div>
                    <img id="admin-prev-1" src="" class="slot-img">
                    <button class="slot-btn" onclick="document.getElementById('file-1').click()">é€‰æ‹©æ­¤å›¾</button>
                    <input type="file" id="file-1" accept="image/*" style="display:none" onchange="processAdminImg(event, 1)">
                </div>
                <div class="admin-slot">
                    <div class="slot-title">å¯¹åº”ï¼šé˜¶æ®µäºŒ</div>
                    <img id="admin-prev-2" src="" class="slot-img">
                    <button class="slot-btn" onclick="document.getElementById('file-2').click()">é€‰æ‹©æ­¤å›¾</button>
                    <input type="file" id="file-2" accept="image/*" style="display:none" onchange="processAdminImg(event, 2)">
                </div>
                <div class="admin-slot">
                    <div class="slot-title">å¯¹åº”ï¼šé˜¶æ®µä¸‰</div>
                    <img id="admin-prev-3" src="" class="slot-img">
                    <button class="slot-btn" onclick="document.getElementById('file-3').click()">é€‰æ‹©æ­¤å›¾</button>
                    <input type="file" id="file-3" accept="image/*" style="display:none" onchange="processAdminImg(event, 3)">
                </div>
                <div class="admin-slot">
                    <div class="slot-title">å¯¹åº”ï¼šé˜¶æ®µå››</div>
                    <img id="admin-prev-4" src="" class="slot-img">
                    <button class="slot-btn" onclick="document.getElementById('file-4').click()">é€‰æ‹©æ­¤å›¾</button>
                    <input type="file" id="file-4" accept="image/*" style="display:none" onchange="processAdminImg(event, 4)">
                </div>
            </div>
            
            <button class="admin-save-btn" onclick="saveAdmin()">ä¿å­˜å¹¶åº”ç”¨è‡³å½“å‰æ–¹æ¡ˆ â”</button>
        </div>
    </div>

    <script>
        const priceTiers = {
            'regular': [ { t: 100, p: 350 }, { t: 72, p: 380 }, { t: 48, p: 400 }, { t: 24, p: 420 }, { t: 0, p: 440 } ],
            'feature': [ { t: 100, p: 380 }, { t: 72, p: 400 }, { t: 48, p: 420 }, { t: 24, p: 440 }, { t: 0, p: 460 } ]
        };

        function getUnitPrice(sessions, type) {
            if(sessions <= 0) return 0;
            for (let tier of priceTiers[type]) {
                if (sessions >= tier.t) return tier.p;
            }
            return priceTiers[type][priceTiers[type].length - 1].p;
        }
        function formatMoney(num) { return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ","); }
        function getMonthlyPrice(m) {
            if(m === 1) return 3888; if(m === 2) return 7200; if(m === 3) return 9600; if(m >= 6) return 18000;
            return m * 3888;
        }

        // ğŸš¨ 24å¼ çº¯å¥³æ€§é«˜çº§æ„Ÿå›¾ç‰‡ï¼ˆå»é™¤å‹æŠ‘é»‘è¾¹ï¼Œé˜³å…‰è‡ªä¿¡æ€§æ„Ÿï¼‰
        const planData = {
            'posture': {
                type: 'feature', icon: '<img src="https://cdn-icons-png.flaticon.com/512/16292/16292717.png">',
                title: 'ä½“æ€çŸ«æ­£ä¸ç»“æ„ä¼˜åŒ–', desc: 'ç‰©ç†å±‚é¢çš„ç»“æ„é‡ç»„ï¼Œå½»åº•åˆ‡æ–­ç–¼ç—›ä»£å¿ã€‚',
                p1_name: 'ç­‹è†œè§£ç»‘ä¸ç—›ç‚¹æ¸…é›¶', p1_w: 4, p1_goal: '<strong>æ‰“ç ´éª¨éª¼é”™è¯¯æ’åˆ—</strong>ï¼Œæ¢å¤å…³èŠ‚æ´»åŠ¨åº¦ã€‚', p1_tech: 'æ·±å±‚å‰¥ç¦»èƒ¸å°è‚Œä¸é«‚è…°è‚Œã€‚', p1_feel: 'ç»ƒå®Œæ„Ÿè§‰<strong>è‚©é¢ˆå½»åº•æ”¾æ¾</strong>ã€‚',
                p2_name: 'å¼±ç‚¹å”¤é†’ä¸æ ¸å¿ƒé‡æ„', p2_w: 12, p2_goal: '<strong>æ¿€æ´»ä¼‘çœ çš„è‚Œè‚‰</strong>ï¼Œå»ºç«‹å¤©ç„¶è‚Œè‚‰å†…è¡£ã€‚', p2_tech: 'æ™®æ‹‰æå­¤ç«‹æ€§å‹Ÿé›†è…¹æ¨ªè‚Œã€‚', p2_feel: 'æ ¸å¿ƒäº§ç”Ÿ<strong>å¼ºçƒˆçš„æ”¯æ’‘æ„Ÿ</strong>ã€‚',
                p3_name: 'åŠ¨ä½œæ¨¡å¼åˆæ­¥å®šå‹', p3_w: 24, p3_goal: 'å°†æ­£ç¡®æ’åˆ—<strong>åˆ»å…¥ç¥ç»æ½œæ„è¯†</strong>ã€‚', p3_tech: 'å¤åˆæŠ—é˜»ç»“åˆç”Ÿæ´»è½¨è¿¹äºŒæ¬¡é‡å¡‘ã€‚', p3_feel: 'ä¸è‡ªè§‰åœ°<strong>ä¿æŒæŒºæ‹”é«˜å§¿æ€</strong>ã€‚',
                p4_name: 'å…¨æ¯ä½“æ€ç»ˆèº«ç»´ç¨³', p4_w: 48, p4_goal: '<strong>é‡å¡‘åº•å±‚ç­‹è†œå¼ åŠ›ç½‘ç»œ</strong>ï¼Œå‘Šåˆ«ä»£å¿ã€‚', p4_tech: 'é«˜é˜¶åŠ¨æ€æ§åˆ¶ä¸å…¨æ¯ç¨³å®šè®­ç»ƒã€‚', p4_feel: '<strong>æ°”è´¨äº§ç”Ÿè‚‰çœ¼å¯è§çš„é«˜çº§èœ•å˜</strong>ã€‚',
                // ä»åŸºç¡€ä¼¸å±• -> è‡ªä¿¡ç«™å§¿ -> ç»ç¾å¤©é¹…é¢ˆ
                img1: 'https://images.unsplash.com/photo-1544367567-0f2fcb009e0b?auto=format&fit=crop&w=800&q=80', 
                img2: 'https://images.unsplash.com/photo-1518611012118-696072aa579a?auto=format&fit=crop&w=800&q=80', 
                img3: 'https://images.unsplash.com/photo-1552196563-55cd4e45efb3?auto=format&fit=crop&w=800&q=80', 
                img4: 'https://images.unsplash.com/photo-1506126613408-eca07ce68773?auto=format&fit=crop&w=800&q=80',
                txt1: 'åˆæœŸæ”¹å–„ï¼šå¼‚å¸¸å¼ åŠ›é‡Šæ”¾ï¼Œè‚©é¢ˆèˆ’å±•', txt2: 'è¿›é˜¶èœ•å˜ï¼šæ ¸å¿ƒå»ºç«‹ï¼Œæ°”è´¨åˆæ˜¾', txt3: 'æ·±åº¦å®šå‹ï¼šè„ŠæŸ±å®Œç¾ä¸­ç«‹ï¼Œèˆ’å±•ä¼˜é›…', txt4: 'å¹´åº¦ç»´ç¨³ï¼šä»éª¨éª¼åˆ°æ°”è´¨çš„ç»ˆæå‡å'
            },
            'fatloss': {
                type: 'regular', icon: '<img src="https://cdn-icons-png.flaticon.com/512/12805/12805546.png">',
                title: 'é«˜æ•ˆç‡ƒè„‚ä¸ä»£è°¢æ¿€æ´»', desc: 'é‡å†™èº«ä½“åŸºå› ï¼Œæ‰“é€ â€œ24å°æ—¶æŒç»­ç‡ƒè„‚çš„ç«ç‚‰â€ã€‚',
                p1_name: 'ç³–åŸæ’ç©ºä¸ä»£è°¢å”¤é†’', p1_w: 4, p1_goal: '<strong>å¼ºè¡Œåˆ‡å…¥è„‚è‚ªæ°§åŒ–é€šé“</strong>ã€‚', p1_tech: 'å¾ªç¯æŠ—é˜»é…åˆä½GIé¥®é£Ÿå¹²é¢„ã€‚', p1_feel: 'è¿…é€Ÿ<strong>æ’å¹²ä½“å†…é¡½å›ºæ°´è‚¿</strong>ï¼Œä½“é‡æ‰ç§¤å¿«ã€‚',
                p2_name: 'é«˜å®¹é‡é¡½å›ºè„‚è‚ªå‰¥ç¦»', p2_w: 12, p2_goal: 'é¶å‘æ¸…ç†å†…è„è„‚è‚ªï¼Œ<strong>å¼ºåŠ›çªç ´å¹³å°æœŸ</strong>ã€‚', p2_tech: 'HIITæ¿€å‘å¼ºçƒˆè¿åŠ¨åç‡ƒæ•ˆåº”ã€‚', p2_feel: '<strong>è…°è…¹å›´åº¦æ˜æ˜¾ç¼©å°</strong>ï¼Œç©¿è¡£å®½æ¾ã€‚',
                p3_name: 'æ˜“ç˜¦ä½“è´¨åˆæ­¥å®šå‹', p3_w: 24, p3_goal: 'æ‹‰é«˜åŸºç¡€ä»£è°¢åŸºæ•°ï¼Œè®©èº«ä½“åœ¨<strong>ç¡çœ ä¸­æŒç»­ç‡ƒçƒ§</strong>ã€‚', p3_tech: 'è‚Œè‚¥å¤§è®­ç»ƒæå‡æ•´ä½“è‚Œè‚‰å‚¨å¤‡ã€‚', p3_feel: '<strong>å¶å°”æ”¾çºµåƒå–ä¸å†åå¼¹</strong>ã€‚',
                p4_name: 'ä»£è°¢åŸºå› ç»ˆæé‡å†™', p4_w: 48, p4_goal: '<strong>å½»åº•ç»ˆç»“åå¼¹å®¿å‘½</strong>ï¼Œç»´æŒå¸¸æ€åŒ–ä½ä½“è„‚ã€‚', p4_tech: 'é«˜é˜¶ç¢³æ°´å¾ªç¯ä¸å…¨åŸŸèƒ½é‡æ¶ˆè€—è®­ç»ƒã€‚', p4_feel: 'ä½“èƒ½ç‚¸è£‚ï¼Œ<strong>æ‹¥æœ‰æ¸…æ™°çš„è…¹è‚Œçº¿æ¡</strong>ã€‚',
                // ç³»é‹å¸¦èµ·è·‘ -> æ±—æ°´ -> è¶…æ¨¡é©¬ç”²çº¿
                img1: 'https://images.unsplash.com/photo-1483721310020-03333e577078?auto=format&fit=crop&w=800&q=80', 
                img2: 'https://images.unsplash.com/photo-1571019614242-c5c5dee9f50b?auto=format&fit=crop&w=800&q=80', 
                img3: 'https://images.unsplash.com/photo-1607962837359-5da7858da5fb?auto=format&fit=crop&w=800&q=80', 
                img4: 'https://images.unsplash.com/photo-1583454110551-21f2fa2afe61?auto=format&fit=crop&w=800&q=80',
                txt1: 'åˆæœŸæ•ˆæœï¼šæ°´è‚¿æ’ç©ºï¼Œä½“èƒ½æé€Ÿå”¤é†’', txt2: 'è¿›é˜¶æ•ˆæœï¼šå›´åº¦ç¼©å°ï¼Œå†…è„è„‚è‚ªå¤§é‡å‰¥ç¦»', txt3: 'æ·±åº¦å®šå‹ï¼šä½“è„‚é™è‡³é»„é‡‘ç‚¹ï¼Œé©¬ç”²çº¿æ˜¾ç°', txt4: 'å¹´åº¦ç»´ç¨³ï¼šå¸¸æ€åŒ–æä½ä½“è„‚ï¼Œèº«æè‡ªç”±'
            },
            'shape': {
                type: 'regular', icon: '<img src="https://cdn-icons-png.flaticon.com/512/3340/3340004.png">',
                title: 'Så‹æ›²çº¿ç²¾é›•è®­ç»ƒ', desc: 'ç‰©ç†å‰¥ç¦»ä¸3Då¡«å……ï¼Œæ‰“é€ æå…·è§†è§‰æ€ä¼¤åŠ›çš„èº«ææ¯”ä¾‹ã€‚',
                p1_name: 'ç›®æ ‡é¶å‘æé€Ÿæ¿€æ´»', p1_w: 4, p1_goal: 'çº æ­£é”™è¯¯å‘åŠ›ï¼Œé¿å…<strong>â€œç»ƒè‡€å…ˆç²—è…¿â€</strong>ã€‚', p1_tech: 'å­¤ç«‹å”¤é†’è‡€å¤§è‚Œä¸Šéƒ¨ä¸ä¸‰è§’è‚Œä¸­æŸã€‚', p1_feel: 'ä½“ä¼šåˆ°ç›®æ ‡è‚Œè‚‰çš„<strong>æ·±å±‚é…¸èƒ€æ³µæ„Ÿ</strong>ã€‚',
                p2_name: 'å¼±ç‚¹åŒºåŸŸ3Dç‰©ç†å¡«å……', p2_w: 12, p2_goal: 'è¿«ä½¿è‚Œçº¤ç»´è¶…é‡æ¢å¤ï¼Œå®ç°<strong>å±€éƒ¨çš„é¥±æ»¡å¡«å……</strong>ã€‚', p2_tech: 'æ¸è¿›å¼è¶…è´Ÿè·ï¼Œè¿ç”¨æ…¢é€Ÿç¦»å¿ƒæ§åˆ¶ã€‚', p2_feel: '<strong>èœœæ¡ƒè‡€é€æ¸é¥±æ»¡ä¸Šç¿˜</strong>ï¼Œè‚©çº¿å¹³ç›´ã€‚',
                p3_name: 'è§†è§‰æ¯”ä¾‹æ‹‰æ‰¯ç²¾é›•', p3_w: 24, p3_goal: 'å¼ºè¡Œå‘ˆç°å‡º<strong>æè‡´çš„æ¼æ–—å½¢æ›²çº¿</strong>ã€‚', p3_tech: 'å¼ºåŒ–èƒŒéƒ¨é˜”åº¦ï¼Œæè‡´å‹ç¼©è…°å›´æ•°æ®ã€‚', p3_feel: 'Sæ›²çº¿å®Œå…¨å›ºåŒ–ï¼Œ<strong>æ‹ç…§è‡ªå¸¦é«˜çº§æ„Ÿ</strong>ã€‚',
                p4_name: 'ç»ç¾æ¯”ä¾‹ç»ˆæé”æ­»', p4_w: 48, p4_goal: '<strong>ç²¾é›•ç»†ç¢æ¯ä¸€å¯¸è‚Œè‚‰èµ°å‘</strong>ï¼Œå®ç°è¶…æ¨¡æ¯”ä¾‹ã€‚', p4_tech: 'é«˜é˜¶è‚ŒåŠ›å¾®è°ƒä¸æè‡´åˆ†ç¦»åº¦è®­ç»ƒã€‚', p4_feel: 'å®Œç¾é©¾é©­ä»»ä½•ç´§èº«è¡£ç‰©ï¼Œ<strong>æ°”åœºå…¨å¼€</strong>ã€‚',
                // å±€éƒ¨å”¤é†’ -> é¥±æ»¡è…°è‡€æ¯” -> æè‡´Så‹æ²™æ¼èº«æ
                img1: 'https://images.unsplash.com/photo-1584735935682-2f2b69dff9d2?auto=format&fit=crop&w=800&q=80', 
                img2: 'https://images.unsplash.com/photo-1594381898411-846e7d193883?auto=format&fit=crop&w=800&q=80', 
                img3: 'https://images.unsplash.com/photo-1581009146145-b5ef050c2e1e?auto=format&fit=crop&w=800&q=80', 
                img4: 'https://images.unsplash.com/photo-1574680096145-d05b474e2155?auto=format&fit=crop&w=800&q=80',
                txt1: 'åˆæœŸå”¤é†’ï¼šè‡€éƒ¨è‚Œè‚‰è‹é†’ï¼Œå‘åŠ›æ„Ÿå»ºç«‹', txt2: 'è¿›é˜¶å¡«å……ï¼šå±€éƒ¨é¥±æ»¡åº¦æå‡ï¼Œè‡€çº¿æ‹‰é«˜', txt3: 'æ·±åº¦å®šå‹ï¼šç»ç¾è…°è‡€æ¯”ï¼Œæå…·è§†è§‰æ€ä¼¤åŠ›', txt4: 'å¹´åº¦ç»´ç¨³ï¼šè¶…æ¨¡çº§æ›²çº¿é”æ­»ï¼Œè‚Œè‚‰è´¨æ„Ÿæè‡´'
            },
            'postpartum': {
                type: 'feature', icon: '<img src="https://cdn-icons-png.flaticon.com/512/779/779980.png">',
                title: 'äº§åæ ¸å¿ƒä¸ä½“å½¢æ¢å¤', desc: 'æ— ç—›å®‰å…¨ç¼åˆè…¹ç›´è‚Œè£‚éš™ï¼ŒåŠ©æ‚¨é‡è¿”å°‘å¥³çº§å¥åº·ä½“æ€ã€‚',
                p1_name: 'ç›†åº•è‚Œä¸å†…æºå®‰å…¨ä¿®å¤', p1_w: 4, p1_goal: 'é‡å»ºç›†åº•åŠŸèƒ½ï¼Œ<strong>ç»å¯¹ç¦æ­¢ä¼ ç»Ÿå·è…¹</strong>ã€‚', p1_tech: 'æ¨ªå‘å‘¼å¸æ³•æ¸©å’Œå”¤é†’è…¹æ¨ªè‚Œã€‚', p1_feel: '<strong>æ¼å°¿æ”¹å–„</strong>ï¼Œæ ¸å¿ƒè„å™¨æœ‰æ˜æ˜¾å½’ä½æ„Ÿã€‚',
                p2_name: 'è…¹ç›´è‚Œç‰©ç†é—­åˆ', p2_w: 12, p2_goal: 'å®‰å…¨ç¼åˆè…¹éƒ¨è£‚éš™ï¼Œæ”¹å–„<strong>éª¨ç›†è¿‡åº¦å‰å€¾</strong>ã€‚', p2_tech: 'æŠ—æ—‹è½¬ä¸æŠ—ä¼¸å±•è®­ç»ƒï¼Œå¼ºåŒ–æ·±å±‚æ ¸å¿ƒã€‚', p2_feel: 'è…¹ç›´è‚Œé—´è·è‚‰çœ¼æ”¶çª„ï¼Œ<strong>è…°èƒŒé…¸ç—›å¤§å¹…ç¼“è§£</strong>ã€‚',
                p3_name: 'æ¸©å’Œå‡è„‚ä¸çš®è‚¤æ”¶ç´§', p3_w: 24, p3_goal: 'åœ¨å®‰å…¨å‰æä¸‹ï¼Œ<strong>å‰¥ç¦»å­•æœŸå›¤ç§¯è„‚è‚ª</strong>ã€‚', p3_tech: 'æ— è·³è·ƒæ¸©å’ŒæŠ—é˜»ä»£è°¢ç»„ã€‚', p3_feel: 'é€æ­¥<strong>ç©¿å›å­•å‰å°ºç è¡£æœ</strong>ï¼Œçš®è‚¤æ¢å¤ç´§è‡´ã€‚',
                p4_name: 'è¾£å¦ˆå·…å³°ä½“æ€é‡é“¸', p4_w: 48, p4_goal: '<strong>å…¨é¢è¶…è¶Šäº§å‰èº«ä½“æœºèƒ½</strong>ï¼Œæ‰“é€ æå“è¾£å¦ˆã€‚', p4_tech: 'å…¨åŸŸåŠ›é‡ä¸ä½“æ€ç²¾é›•ç³»ç»Ÿæ–¹æ¡ˆã€‚', p4_feel: 'ä¸ä»…æ¢å¤å¦‚åˆï¼Œ<strong>ç”šè‡³æ¯”å­•å‰æ›´æŒºæ‹”è‡ªä¿¡</strong>ã€‚',
                // æ¸©å’Œå«ä¸Š -> é˜³å…‰å¹³å¦è…¹éƒ¨ -> è¶…è¶Šå­•å‰çš„ç´§è‡´
                img1: 'https://images.unsplash.com/photo-1556817411-31ae72fa3ea0?auto=format&fit=crop&w=800&q=80', 
                img2: 'https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?auto=format&fit=crop&w=800&q=80', 
                img3: 'https://images.unsplash.com/photo-1559148540-047391cb730a?auto=format&fit=crop&w=800&q=80', 
                img4: 'https://images.unsplash.com/photo-1524594152303-9fd13543fe6e?auto=format&fit=crop&w=800&q=80',
                txt1: 'åˆæœŸæ¢å¤ï¼šç›†åº•æ¿€æ´»ï¼Œå†…æºæ€§åŠŸèƒ½é‡å»º', txt2: 'è¿›é˜¶ç¼åˆï¼šè…¹ç›´è‚Œé—­åˆï¼Œæ ¸å¿ƒåŠ›é‡å›å½’', txt3: 'æ·±åº¦å®šå‹ï¼šé‡è¿”å°‘å¥³æ—¶ä»£ç´§è‡´èº«å‹', txt4: 'å¹´åº¦ç»´ç¨³ï¼šæœºèƒ½å…¨é¢è¶…è¶Šå­•å‰ï¼Œé¡¶çº§è¾£å¦ˆ'
            },
            'rehab': {
                type: 'feature', icon: '<img src="https://cdn-icons-png.flaticon.com/512/2906/2906460.png">',
                title: 'è¿åŠ¨åŠŸèƒ½æå‡ä¸é˜²æŠ¤', desc: 'ç²¾å‡†ç¥ç»è‚Œè‚‰è°ƒæ§ï¼Œé‡å»ºå—æŸå…³èŠ‚åŠ›å­¦ç¨³å®šæ€§ã€‚',
                p1_name: 'ç‚ç—‡æ¶ˆé™¤ä¸ä»£å¿åˆ‡æ–­', p1_w: 4, p1_goal: 'æ‰¾å‡ºå¼•èµ·ç–¼ç—›çš„<strong>é”™è¯¯å‘åŠ›æº</strong>ã€‚', p1_tech: 'æ¿€ç—›ç‚¹æŒ‰å‹æŠ€æœ¯é‡Šæ”¾ä»£å¿å…³èŠ‚ã€‚', p1_feel: '<strong>å¼¹å“æ˜æ˜¾å‡å°‘</strong>ï¼Œå°–é”åˆºç—›æ„Ÿæ¶ˆå¤±ã€‚',
                p2_name: 'å—æŸå…³èŠ‚è‚Œè‚‰æŠ¤ç”²æ„å»º', p2_w: 12, p2_goal: 'å¢å¼ºéŸ§å¸¦å¼ºåº¦ï¼Œæ‰“é€ <strong>ç”Ÿç‰©å­¦æŠ¤è†æŠ¤è…°</strong>ã€‚', p2_tech: 'æ— ç—›è§’åº¦å†…ç­‰é•¿æ”¶ç¼©å¼ºåŒ–æ·±å±‚å°è‚Œç¾¤ã€‚', p2_feel: 'å…³èŠ‚äº§ç”Ÿ<strong>æå¼ºåŒ…è£¹æ„Ÿ</strong>ï¼Œå‘åŠ›ä¸å‘è™šã€‚',
                p3_name: 'åŠ¨æ€è„±æ•ä¸èµ›åœºé‡è¿”', p3_w: 24, p3_goal: 'é‡å»ºæœ¬ä½“æ„Ÿè§‰ï¼Œ<strong>é€‚åº”å¤æ‚è¿åŠ¨è½¨è¿¹</strong>ã€‚', p3_tech: 'é—­é“¾ä¸ä¸å¹³è¡¡ä»‹è´¨é«˜é˜¶ç¥ç»è°ƒæ§ã€‚', p3_feel: 'èƒ½<strong>æå…¶è‡ªä¿¡åœ°å®Œæˆå¤æ‚åŠ¨ä½œ</strong>ï¼Œæ— æƒ§æŸä¼¤ã€‚',
                p4_name: 'é«˜é˜¶æŠ¤ç”²ä¸è¿åŠ¨è¡¨ç°', p4_w: 48, p4_goal: '<strong>ç»å¯¹æ¶ˆé™¤äºŒæ¬¡æŸä¼¤éšæ‚£</strong>ï¼Œæå‡çˆ†å‘åŠ›ã€‚', p4_tech: 'è¶…ç­‰é•¿æ”¶ç¼©ä¸ä¸“é¡¹è¿åŠ¨æœºèƒ½å¼ºåŒ–ã€‚', p4_feel: 'äº«å—è¿åŠ¨å¸¦æ¥çš„ç»å¯¹å¿«ä¹ï¼Œ<strong>æœºèƒ½ç™»é¡¶</strong>ã€‚',
                // å…³èŠ‚ç¨³å®š -> çˆ†å‘åŠ› -> å¥åº·è¿åŠ¨è¡¨ç°
                img1: 'https://images.unsplash.com/photo-1502825751399-28cbafbf8275?auto=format&fit=crop&w=800&q=80', 
                img2: 'https://images.unsplash.com/photo-1599058917212-d750089bc07e?auto=format&fit=crop&w=800&q=80', 
                img3: 'https://images.unsplash.com/photo-1517836357463-d25dfeac3438?auto=format&fit=crop&w=800&q=80', 
                img4: 'https://images.unsplash.com/photo-1534438327276-14e5300c3a48?auto=format&fit=crop&w=800&q=80',
                txt1: 'åˆæœŸé•‡ç—›ï¼šè½¯ç»„ç»‡å‹åŠ›é‡Šæ”¾ï¼Œç–¼ç—›æ¶ˆå¤±', txt2: 'è¿›é˜¶æŠ¤ç”²ï¼šå…³èŠ‚å‘¨å›´åŠ›é‡å¢å¼ºï¼Œå»ºç«‹ä¿æŠ¤', txt3: 'æ»¡è¡€é‡è¿”ï¼šæ— æƒ§ä»»ä½•å‘åŠ›ï¼Œé‡è¿”é«˜å¼ºåº¦', txt4: 'å¹´åº¦ç»´ç¨³ï¼šç»å¯¹æŠ¤ç”²é”å®šï¼Œå·…å³°è¿åŠ¨è¡¨ç°'
            },
            'antiaging': {
                type: 'regular', icon: '<img src="https://cdn-icons-png.flaticon.com/512/8407/8407060.png">',
                title: 'æ´»åŠ›ä½“èƒ½ä¸çŠ¶æ€ç„•æ–°', desc: 'æå‡éª¨å¯†åº¦ä¸è‚Œè‚‰å‚¨å¤‡ï¼Œä¸ºæ‚¨æ‰“é€ ä¸è€çš„è‚‰ä½“ç›”ç”²ã€‚',
                p1_name: 'æœºèƒ½å”¤é†’ä¸æ¶¦æ»‘ç³»ç»Ÿ', p1_w: 4, p1_goal: 'ä¿ƒè¿›æ»‘æ¶²åˆ†æ³Œï¼Œ<strong>å…¨é¢æ¢å¤ç”Ÿé”ˆå¡é¡¿çš„æœºèƒ½</strong>ã€‚', p1_tech: 'å…³èŠ‚æ´»åŠ¨åº¦æ‰“ç£¨ä¸å…¨èº«ç­‹è†œé“¾æ‹‰ä¼¸ã€‚', p1_feel: '<strong>æ™¨èµ·åƒµç¡¬æ„Ÿæ¶ˆå¤±ï¼Œæ·±åº¦ç¡çœ å»¶é•¿</strong>ã€‚',
                p2_name: 'éª¨å¯†åº¦ä¸é˜²æµå¤±å‚¨å¤‡', p2_w: 12, p2_goal: 'åˆºæ¿€æˆéª¨ç»†èƒæ´»è·ƒï¼Œ<strong>æš´åŠ›å¯¹æŠ—è‚Œè‚‰èç¼©</strong>ã€‚', p2_tech: 'é‡ç‰©æŠ—é˜»é…åˆæ…¢é€Ÿç¦»å¿ƒæ”¶ç¼©æŠ€æœ¯ã€‚', p2_feel: 'æ‹é‡ç‰©ä¸åƒåŠ›ï¼Œ<strong>ä¸‹æ¥¼æ¢¯è†ç›–ç»ä¸å‘è½¯</strong>ã€‚',
                p3_name: 'å¼•æ“é‡ç½®ä¸è·å°”è’™å”¤é†’', p3_w: 24, p3_goal: 'æå‡æœ€å¤§æ‘„æ°§é‡ï¼Œç”±å†…è€Œå¤–ç„•å‘<strong>æè‡´å¹´è½»æ€</strong>ã€‚', p3_tech: 'ç¨³æ€æœ‰æ°§é…åˆå¿ƒç‡å˜å¼‚ç‡ç§‘å­¦ç›‘æ§ã€‚', p3_feel: 'çˆ¬æ¥¼æ¢¯ä¸å–˜ï¼Œ<strong>æ°”è‰²çº¢æ¶¦ï¼Œç²¾åŠ›çˆ†è¡¨</strong>ã€‚',
                p4_name: 'ç»†èƒçº§æœºèƒ½ç»ˆèº«æŠ—è¡°', p4_w: 48, p4_goal: '<strong>çœŸæ­£å®ç°ç”Ÿç†å¹´é¾„çš„é€†è½¬</strong>ï¼Œå¸¸æ€åŒ–å†»é¾„ã€‚', p4_tech: 'å…¨å‘¨æœŸé«˜é˜¶ä½“èƒ½ä¸çº¿ç²’ä½“å¼ºåŒ–è®­ç»ƒã€‚', p4_feel: 'ç”±å†…è€Œå¤–æ•£å‘æ´»åŠ›ï¼Œ<strong>è¿œè¶…åŒé¾„äººçš„å·…å³°çŠ¶æ€</strong>ã€‚',
                // é˜³å…‰ä¼¸å±• -> çš®è‚¤å‘å…‰ã€å……æ»¡é’æ˜¥èƒ¶åŸè›‹ç™½
                img1: 'https://images.unsplash.com/photo-1579126031931-7911d74c291e?auto=format&fit=crop&w=800&q=80', 
                img2: 'https://images.unsplash.com/photo-1515886657613-9f3515b0c78f?auto=format&fit=crop&w=800&q=80', 
                img3: 'https://images.unsplash.com/photo-1508215885820-4585e5610ea0?auto=format&fit=crop&w=800&q=80', 
                img4: 'https://images.unsplash.com/photo-1607962837359-5da7858da5fb?auto=format&fit=crop&w=800&q=80',
                txt1: 'åˆæœŸå”¤é†’ï¼šå…³èŠ‚æ¶¦æ»‘ï¼Œèº«ä½“æ¢å¤æŸ”éŸ§è‡ªç”±', txt2: 'è¿›é˜¶å‚¨å¤‡ï¼šéª¨å¯†æå‡ï¼Œè‚Œè‚‰å¼ åŠ›é‡è¿”å¹´è½»', txt3: 'é€†é¾„å†»é¾„ï¼šå¿ƒè‚ºå¼•æ“é‡ç½®ï¼Œç»å¯¹å·…å³°æ´»åŠ›', txt4: 'å¹´åº¦ç»´ç¨³ï¼šå½»åº•å¯¹æŠ—å²æœˆï¼Œç”Ÿç†æœºèƒ½ç»ˆæå†»é¾„'
            }
        };

        // åˆå§‹åŒ–åŠ è½½ä¿å­˜åœ¨æµè§ˆå™¨çš„è€æ¿ç§å¯†ç…§ç‰‡
        for(let key in planData) {
            for(let i=1; i<=4; i++) {
                let savedImg = localStorage.getItem(`custom_${key}_img_${i}`);
                if(savedImg) planData[key][`img${i}`] = savedImg;
            }
        }

        let currentPlanKey = '';
        let globalTotalExact = 0; 
        let userFreq = 3; 
        let selectedUpsell = {};

        function openDetail(key) {
            currentPlanKey = key;
            userFreq = 3; 
            const data = planData[key];
            const modal = document.getElementById('detailModal');
            const body = document.getElementById('modalBody');
            
            // ğŸš¨ 6å¤§æ¿å—å…¨éƒ¨å¼€æ”¾è€æ¿ä¸“å±é…ç½®æŒ‰é’®
            let adminBtnHTML = `
                <div style="background: linear-gradient(135deg, rgba(212,175,55,0.15), rgba(212,175,55,0.05)); border: 1px dashed #D4AF37; color: #D4AF37; text-align: center; padding: 14px; border-radius: 12px; font-size: 13px; font-weight: bold; cursor: pointer; margin-bottom: 20px; letter-spacing: 1px; box-shadow: 0 5px 15px rgba(0,0,0,0.5);" onclick="openAdminModal()">
                    âœ¦ è€æ¿ä¸“å±é€šé“ï¼šè‡ªå®šä¹‰å½“å‰æ–¹æ¡ˆæŠ•å°„å›¾ âœ¦
                </div>
            `;

            body.innerHTML = `
                <div class="hero-banner">
                    <div class="hero-watermark">${data.icon}</div>
                    <div class="m-hero-title">${data.title}</div>
                    <div class="m-hero-desc">${data.desc}</div>
                </div>

                <div class="freq-panel">
                    <div class="freq-title">âœ¦ è®¾å®šé¢„æœŸæ¯å‘¨å‡ºå‹¤é¢‘ç‡ (ç”¨äºç§‘å­¦æ’è¯¾)</div>
                    <div class="freq-group">
                        <div class="freq-btn" data-f="1" onclick="setFreq(1)">1æ¬¡/å‘¨<br><span>ä¿æŒå”¤é†’</span></div>
                        <div class="freq-btn" data-f="2" onclick="setFreq(2)">2æ¬¡/å‘¨<br><span>ç¨³æ­¥èœ•å˜</span></div>
                        <div class="freq-btn active" data-f="3" onclick="setFreq(3)">3æ¬¡/å‘¨<br><span>é»„é‡‘é¢‘ç‡</span></div>
                        <div class="freq-btn" data-f="4" onclick="setFreq(4)">4æ¬¡/å‘¨<br><span>æé€Ÿå†²åˆº</span></div>
                        <div class="freq-btn" data-f="5" onclick="setFreq(5)">5æ¬¡+/å‘¨<br><span>æè‡´è‡ªå¾‹</span></div>
                    </div>
                </div>
                
                <div class="phase-title-main">è¯·ç‚¹é€‰æ‚¨æœŸæœ›è¾¾æˆçš„é‡å¡‘ç›®æ ‡é˜¶æ®µï¼š</div>
                
                <div class="phase-box" data-phase="1" data-weeks="${data.p1_w}" onclick="togglePhase(this, event)">
                    <div class="check-circle"></div>
                    <div class="p-step">â— PHASE 01 / é˜¶æ®µä¸€</div>
                    <div class="p-cycle-highlight">
                        <div class="cycle-row"><span class="icon">â±</span> é˜¶æ®µè€—æ—¶ï¼š<span class="highlight-text">${data.p1_w} å‘¨ (1ä¸ªæœˆ)</span></div>
                        <div class="cycle-row"><span class="icon">ğŸ¯</span> éœ€é…è¯¾æ—¶ï¼š<span class="highlight-text" id="p1-val">${data.p1_w * userFreq} èŠ‚</span></div>
                    </div>
                    <div class="p-name">${data.p1_name}</div>
                    <div class="sales-points">
                        <div class="sp-row"><div class="sp-tag tag-goal">ç›®æ ‡</div><div class="sp-text editable-text" contenteditable="true" spellcheck="false" onclick="event.stopPropagation();">${data.p1_goal}</div></div>
                        <div class="sp-row"><div class="sp-tag tag-tech">æŠ€æœ¯</div><div class="sp-text editable-text" contenteditable="true" spellcheck="false" onclick="event.stopPropagation();">${data.p1_tech}</div></div>
                        <div class="sp-row"><div class="sp-tag tag-feel">ä½“æ„Ÿ</div><div class="sp-text editable-text" contenteditable="true" spellcheck="false" onclick="event.stopPropagation();">${data.p1_feel}</div></div>
                    </div>
                </div>

                <div class="phase-box" data-phase="2" data-weeks="${data.p2_w}" onclick="togglePhase(this, event)">
                    <div class="check-circle"></div>
                    <div class="p-step">â— PHASE 02 / é˜¶æ®µäºŒ</div>
                    <div class="p-cycle-highlight">
                        <div class="cycle-row"><span class="icon">â±</span> é˜¶æ®µè€—æ—¶ï¼š<span class="highlight-text">${data.p2_w} å‘¨ (3ä¸ªæœˆ)</span></div>
                        <div class="cycle-row"><span class="icon">ğŸ¯</span> éœ€é…è¯¾æ—¶ï¼š<span class="highlight-text" id="p2-val">${data.p2_w * userFreq} èŠ‚</span></div>
                    </div>
                    <div class="p-name">${data.p2_name}</div>
                    <div class="sales-points">
                        <div class="sp-row"><div class="sp-tag tag-goal">ç›®æ ‡</div><div class="sp-text editable-text" contenteditable="true" spellcheck="false" onclick="event.stopPropagation();">${data.p2_goal}</div></div>
                        <div class="sp-row"><div class="sp-tag tag-tech">æŠ€æœ¯</div><div class="sp-text editable-text" contenteditable="true" spellcheck="false" onclick="event.stopPropagation();">${data.p2_tech}</div></div>
                        <div class="sp-row"><div class="sp-tag tag-feel">ä½“æ„Ÿ</div><div class="sp-text editable-text" contenteditable="true" spellcheck="false" onclick="event.stopPropagation();">${data.p2_feel}</div></div>
                    </div>
                </div>

                <div class="phase-box" data-phase="3" data-weeks="${data.p3_w}" onclick="togglePhase(this, event)">
                    <div class="check-circle"></div>
                    <div class="p-step">â— PHASE 03 / é˜¶æ®µä¸‰</div>
                    <div class="p-cycle-highlight">
                        <div class="cycle-row"><span class="icon">â±</span> é˜¶æ®µè€—æ—¶ï¼š<span class="highlight-text">${data.p3_w} å‘¨ (6ä¸ªæœˆ/åŠå¹´)</span></div>
                        <div class="cycle-row"><span class="icon">ğŸ¯</span> éœ€é…è¯¾æ—¶ï¼š<span class="highlight-text" id="p3-val">${data.p3_w * userFreq} èŠ‚</span></div>
                    </div>
                    <div class="p-name">${data.p3_name}</div>
                    <div class="sales-points">
                        <div class="sp-row"><div class="sp-tag tag-goal">ç›®æ ‡</div><div class="sp-text editable-text" contenteditable="true" spellcheck="false" onclick="event.stopPropagation();">${data.p3_goal}</div></div>
                        <div class="sp-row"><div class="sp-tag tag-tech">æŠ€æœ¯</div><div class="sp-text editable-text" contenteditable="true" spellcheck="false" onclick="event.stopPropagation();">${data.p3_tech}</div></div>
                        <div class="sp-row"><div class="sp-tag tag-feel">ä½“æ„Ÿ</div><div class="sp-text editable-text" contenteditable="true" spellcheck="false" onclick="event.stopPropagation();">${data.p3_feel}</div></div>
                    </div>
                </div>

                <div class="phase-box" data-phase="4" data-weeks="${data.p4_w}" onclick="togglePhase(this, event)">
                    <div class="check-circle"></div>
                    <div class="p-step">â— PHASE 04 / é˜¶æ®µå›› (VIPé™å®š)</div>
                    <div class="p-cycle-highlight">
                        <div class="cycle-row"><span class="icon">â±</span> é˜¶æ®µè€—æ—¶ï¼š<span class="highlight-text">${data.p4_w} å‘¨ (12ä¸ªæœˆ/å¹´åº¦)</span></div>
                        <div class="cycle-row"><span class="icon">ğŸ¯</span> éœ€é…è¯¾æ—¶ï¼š<span class="highlight-text" id="p4-val">${data.p4_w * userFreq} èŠ‚</span></div>
                    </div>
                    <div class="p-name">${data.p4_name}</div>
                    <div class="sales-points">
                        <div class="sp-row"><div class="sp-tag tag-goal">ç›®æ ‡</div><div class="sp-text editable-text" contenteditable="true" spellcheck="false" onclick="event.stopPropagation();">${data.p4_goal}</div></div>
                        <div class="sp-row"><div class="sp-tag tag-tech">æŠ€æœ¯</div><div class="sp-text editable-text" contenteditable="true" spellcheck="false" onclick="event.stopPropagation();">${data.p4_tech}</div></div>
                        <div class="sp-row"><div class="sp-tag tag-feel">ä½“æ„Ÿ</div><div class="sp-text editable-text" contenteditable="true" spellcheck="false" onclick="event.stopPropagation();">${data.p4_feel}</div></div>
                    </div>
                </div>

                <div class="phase-box combo-box" id="phase-5-box" onclick="togglePhase(this, event)">
                    <div class="check-circle"></div>
                    <div class="p-step">â˜… ç‰¹æ®Šé€šé“ / æ•™ç»ƒä¸“å±å®šåˆ¶ç»„åˆåŒ…</div>
                    <div class="p-name" style="margin-bottom: 15px;">çªç ´å•ä¸€å±€é™ï¼Œå…¨æ¯æ–¹æ¡ˆæ‰˜ç®¡</div>
                    
                    <div class="custom-builder">
                        <div class="cb-item">
                            <div class="cb-label">å¸¸è§„è®­ç»ƒè¯¾ <span>(å‡è„‚/å¢è‚Œ/å¡‘å½¢ <strong style="color:var(--primary);">60åˆ†é’Ÿ/èŠ‚</strong>)</span></div>
                            <div class="cb-ctrl">
                                <div class="cb-btn" onclick="chgVal('cb-reg', -1, event)">-</div>
                                <input type="number" id="cb-reg" class="cb-input" value="0" onclick="event.stopPropagation();" oninput="manualInput(this, event)">
                                <div class="cb-btn" onclick="chgVal('cb-reg', 1, event)">+</div>
                            </div>
                        </div>
                        <div class="cb-item">
                            <div class="cb-label">ç‰¹è‰²å¹²é¢„è¯¾ <span>(æ‹‰ä¼¸/æ™®æ‹‰æ/åº·å¤ç­‰ <strong style="color:var(--primary);">45åˆ†é’Ÿ/èŠ‚</strong>)</span></div>
                            <div class="cb-ctrl">
                                <div class="cb-btn" onclick="chgVal('cb-feat', -1, event)">-</div>
                                <input type="number" id="cb-feat" class="cb-input" value="0" onclick="event.stopPropagation();" oninput="manualInput(this, event)">
                                <div class="cb-btn" onclick="chgVal('cb-feat', 1, event)">+</div>
                            </div>
                        </div>
                        <div class="cb-item">
                            <div class="cb-label">åŒ…æœˆå‘¨æœŸè¯¾ <span>(æè‡´é«˜é¢‘æ‰“å¡ <strong style="color:var(--primary);">45åˆ†é’Ÿ/èŠ‚ï¼ŒæŒ‰æœˆ</strong>)</span></div>
                            <div class="cb-ctrl">
                                <div class="cb-btn" onclick="chgVal('cb-mon', -1, event)">-</div>
                                <input type="number" id="cb-mon" class="cb-input" value="0" onclick="event.stopPropagation();" oninput="manualInput(this, event)">
                                <div class="cb-btn" onclick="chgVal('cb-mon', 1, event)">+</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="visual-feedback-section" id="visual-sec">
                    ${adminBtnHTML}
                    <div class="scanning-line"></div>
                    <div class="fb-header">âœ¦ AI ç›®æ ‡å½¢æ€è§†è§‰æŠ•å°„ âœ¦</div>
                    <div class="visual-card">
                        <img id="visual-img" class="visual-img" src="${data.img1}" alt="å½¢æ€æ¼”å˜" style="filter: brightness(0.9);">
                        <div class="visual-overlay">
                            <div class="visual-title" id="visual-title">ç­‰å¾…æ¥å…¥é‡å¡‘ç½‘ç»œ...</div>
                            <div class="visual-desc" id="visual-desc">ç‚¹é€‰ä¸Šæ–¹é˜¶æ®µï¼ŒAIå°†ä¸ºæ‚¨æŠ•å°„å·…å³°å½¢æ€</div>
                        </div>
                    </div>
                </div>
            `;
            
            modal.classList.add('show');
            updateCheckout(); 
        }

        // ================= ğŸš¨ ä¸“å±å›¾åº“æ§åˆ¶å°é€»è¾‘ =================
        function openAdminModal() {
            document.getElementById('admin-subtitle').innerText = `å½“å‰æ–¹æ¡ˆï¼š${planData[currentPlanKey].title}`;
            for(let i=1; i<=4; i++) {
                document.getElementById(`admin-prev-${i}`).src = planData[currentPlanKey][`img${i}`];
            }
            document.getElementById('adminModalWrap').classList.add('show');
        }

        function closeAdmin() {
            document.getElementById('adminModalWrap').classList.remove('show');
        }

        function processAdminImg(event, phase) {
            const file = event.target.files[0];
            if(!file) return;
            const reader = new FileReader();
            reader.onload = function(e) {
                const img = new Image();
                img.onload = function() {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    // å‹ç¼©å›¾ç‰‡é˜²æ­¢æµè§ˆå™¨å†…å­˜å´©ç›˜
                    const scale = Math.min(600 / img.width, 1);
                    canvas.width = img.width * scale;
                    canvas.height = img.height * scale;
                    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                    
                    const base64 = canvas.toDataURL('image/jpeg', 0.8);
                    
                    // ç«‹å³æ›´æ–°é¢„è§ˆ
                    document.getElementById(`admin-prev-${phase}`).src = base64;
                    // æš‚å­˜åˆ°å½“å‰æ•°æ®ä¸­
                    planData[currentPlanKey][`img${phase}`] = base64;
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        function saveAdmin() {
            // å°†4ä¸ªé˜¶æ®µçš„å›¾æ°¸ä¹…ä¿å­˜åˆ°æœ¬åœ°ç¼“å­˜
            for(let i=1; i<=4; i++) {
                const base64 = planData[currentPlanKey][`img${i}`];
                localStorage.setItem(`custom_${currentPlanKey}_img_${i}`, base64);
            }
            closeAdmin();
            updateCheckout(); // åˆ·æ–°ä¸»ç•Œé¢å›¾ç‰‡
            alert("è€æ¿ï¼Œå½“å‰æ–¹æ¡ˆçš„ 4 å¼ ä¸“å±å¤§ç‰‡å·²æˆåŠŸé”å®šï¼");
        }

        function finishAndReturn() {
            document.getElementById('signatureModal').classList.remove('show');
            document.getElementById('detailModal').classList.remove('show');
            globalTotalExact = 0;
            currentPlanKey = '';
            selectedUpsell = {};
            document.getElementById('modalBody').innerHTML = ''; 
        }

        function closeDetail() { finishAndReturn(); }

        function setFreq(f) {
            userFreq = f;
            document.querySelectorAll('.freq-btn').forEach(b => b.classList.remove('active'));
            document.querySelector(`.freq-btn[data-f="${f}"]`).classList.add('active');
            updateCheckout(); 
        }

        function manualInput(el, event) {
            if(event) event.stopPropagation();
            let val = parseInt(el.value);
            if(isNaN(val) || val < 0) return; 
            
            let box = document.getElementById('phase-5-box');
            let r = parseInt(document.getElementById('cb-reg').value) || 0;
            let f = parseInt(document.getElementById('cb-feat').value) || 0;
            let m = parseInt(document.getElementById('cb-mon').value) || 0;
            let totalCustom = r + f + m;
            
            if (totalCustom > 0) {
                box.classList.add('selected');
                document.querySelectorAll('.phase-box:not(.combo-box)').forEach(b => b.classList.remove('selected'));
            } else if (totalCustom === 0) {
                box.classList.remove('selected');
            }
            updateCheckout();
        }

        function chgVal(id, delta, e) {
            if(e) e.stopPropagation(); 
            let el = document.getElementById(id);
            let val = parseInt(el.value);
            if(isNaN(val)) val = 0;
            val += delta;
            if (val < 0) val = 0;
            el.value = val;
            manualInput(el, e);
        }

        function togglePhase(el, e) {
            if(e) e.stopPropagation();
            if (el.id === 'phase-5-box') {
                document.querySelectorAll('.phase-box:not(.combo-box)').forEach(b => b.classList.remove('selected'));
                el.classList.toggle('selected');
                if (el.classList.contains('selected') && (parseInt(document.getElementById('cb-reg').value)||0) == 0 && (parseInt(document.getElementById('cb-feat').value)||0) == 0 && (parseInt(document.getElementById('cb-mon').value)||0) == 0) {
                    document.getElementById('cb-reg').value = 1; 
                } else if (!el.classList.contains('selected')) {
                    document.getElementById('cb-reg').value = 0;
                    document.getElementById('cb-feat').value = 0;
                    document.getElementById('cb-mon').value = 0;
                }
            } else {
                let cb = document.getElementById('phase-5-box');
                if(cb) {
                    cb.classList.remove('selected');
                    document.getElementById('cb-reg').value = 0;
                    document.getElementById('cb-feat').value = 0;
                    document.getElementById('cb-mon').value = 0;
                }
                el.classList.toggle('selected');
            }
            updateCheckout();
        }

        function triggerAIScan() {
            let sec = document.getElementById('visual-sec');
            sec.classList.remove('scanning-active');
            void sec.offsetWidth; 
            sec.classList.add('scanning-active');
        }

        function updateCheckout() {
            let totalExactSessions = 0;
            let maxPhaseSelected = 0;
            const data = planData[currentPlanKey];
            
            if(!data) return;

            let customBox = document.getElementById('phase-5-box');
            let isCustom = customBox && customBox.classList.contains('selected');

            document.getElementById('p1-val').innerText = `${userFreq * data.p1_w} èŠ‚`;
            document.getElementById('p2-val').innerText = `${userFreq * data.p2_w} èŠ‚`;
            document.getElementById('p3-val').innerText = `${userFreq * data.p3_w} èŠ‚`;
            document.getElementById('p4-val').innerText = `${userFreq * data.p4_w} èŠ‚`;

            if (isCustom) {
                let r = parseInt(document.getElementById('cb-reg').value) || 0;
                let f = parseInt(document.getElementById('cb-feat').value) || 0;
                let m = parseInt(document.getElementById('cb-mon').value) || 0;
                totalExactSessions = r + f + (m * 16); 
                maxPhaseSelected = 5; 
            } else {
                let totalWeeks = 0;
                document.querySelectorAll('.phase-box.selected:not(.combo-box)').forEach(box => {
                    totalWeeks += parseInt(box.getAttribute('data-weeks'));
                    let p = parseInt(box.getAttribute('data-phase'));
                    if(p > maxPhaseSelected) maxPhaseSelected = p;
                });
                totalExactSessions = totalWeeks * userFreq;
            }
            
            globalTotalExact = totalExactSessions; 
            
            const btn = document.getElementById('btn-checkout');
            const valDisplay = document.getElementById('calc-val');
            const vImg = document.getElementById('visual-img');
            const vTitle = document.getElementById('visual-title');
            const vDesc = document.getElementById('visual-desc');

            if(maxPhaseSelected === 0) {
                vImg.style.filter = 'brightness(0.9)'; 
                vTitle.innerText = 'ç­‰å¾…æ¥å…¥é‡å¡‘ç½‘ç»œ...';
                vDesc.innerText = 'ç‚¹é€‰ä¸Šæ–¹é˜¶æ®µï¼ŒAIå°†ä¸ºæ‚¨æŠ•å°„å·…å³°å½¢æ€';
                valDisplay.innerHTML = '<span style="color:#666; font-size:12px;">å¾…é€‰æ‹©ç›®æ ‡é˜¶æ®µ</span>';
                btn.classList.add('disabled');
            } else {
                triggerAIScan();
                if(maxPhaseSelected === 1) {
                    vImg.src = data.img1; vTitle.innerText = 'PHASE 01: åŸºç¡€ç„•æ–°'; vDesc.innerText = data.txt1;
                } else if(maxPhaseSelected === 2) {
                    vImg.src = data.img2; vTitle.innerText = 'PHASE 02: è¿›é˜¶èœ•å˜'; vDesc.innerText = data.txt2;
                } else if(maxPhaseSelected === 3) {
                    vImg.src = data.img3; vTitle.innerText = 'PHASE 03: æ·±åº¦å®šå‹'; vDesc.innerText = data.txt3;
                } else if(maxPhaseSelected === 4) {
                    vImg.src = data.img4; vTitle.innerText = 'PHASE 04: å¹´åº¦é¡¶é…'; vDesc.innerText = data.txt4;
                } else {
                    vImg.src = data.img4; vTitle.innerText = 'âœ¦ é¡¶çº§ç§æ•™VIPæ‰˜ç®¡ âœ¦'; vDesc.innerText = 'æ‰“ç ´ä¸€åˆ‡å±€é™ï¼ŒAIé”å®šæ‚¨çš„å…¨æ¯å·…å³°çŠ¶æ€';
                }
                
                vImg.style.filter = 'brightness(1.0) saturate(1.05)';

                if (isCustom) {
                    valDisplay.innerHTML = `${totalExactSessions} <span>èŠ‚ (å«åŒ…æœˆæŠ˜ç®—)</span>`;
                } else {
                    valDisplay.innerHTML = `${totalExactSessions} <span>èŠ‚ (ç³»ç»Ÿç²¾å‡†æ ¸ç®—)</span>`;
                }
                
                btn.classList.remove('disabled');
                if(navigator.vibrate) navigator.vibrate(50);
            }
        }

        function selectUpPlan(cardId, name, sessions, price) {
            document.querySelectorAll('.dash-card').forEach(c => c.classList.remove('selected-card'));
            document.getElementById(cardId).classList.add('selected-card');
            
            selectedUpsell = { name: name, sessions: sessions, price: price };
            
            let btn = document.getElementById('btn-submit');
            btn.innerHTML = `ç¡®è®¤é”å®š ${name} â”`;
            
            if(navigator.vibrate) navigator.vibrate(20);
        }

        function confirmUpsellSelection() {
            if(!selectedUpsell.name) return;
            openSignature(selectedUpsell.name, selectedUpsell.sessions, selectedUpsell.price);
        }

        function showUpsellModal() {
            if(globalTotalExact === 0) return;
            
            let customBox = document.getElementById('phase-5-box');
            let isCustom = customBox && customBox.classList.contains('selected');
            const data = planData[currentPlanKey];
            
            const baseOriPrice = (data.type === 'feature') ? 460 : 440;
            const newbiePrice = (data.type === 'feature') ? 380 : 350;

            let container = document.getElementById('upsell-cards-container');
            container.innerHTML = ''; 

            if (isCustom) {
                document.getElementById('up-sub-text').innerHTML = `ç³»ç»Ÿå·²ä¸ºæ‚¨æ ¸ç®—ä»¥ä¸‹ <strong style="color:var(--primary)">é«˜å®šç§äº«ç»„åˆ</strong>ï¼Œå«ä¸“å±ç ´å†°ç¦åˆ©ï¼š`;

                let r = parseInt(document.getElementById('cb-reg').value) || 0;
                let f = parseInt(document.getElementById('cb-feat').value) || 0;
                let m = parseInt(document.getElementById('cb-mon').value) || 0;

                let oriReg1 = r * 440; 
                let oriFeat1 = f * 460;
                let oriMon1 = m > 0 ? getMonthlyPrice(m) : 0;
                let totalOri1 = oriReg1 + oriFeat1 + oriMon1;

                let newReg1 = r * 350; let newFeat1 = f * 380;
                let totalNew1 = newReg1 + newFeat1 + oriMon1;
                let save1 = totalOri1 - totalNew1;

                let r2 = Math.ceil(r / 2); let f2 = Math.ceil(f / 2); let m2 = m;
                let unitR2 = getUnitPrice(r2, 'regular'); let unitF2 = getUnitPrice(f2, 'feature');
                let totalNew2 = (r2 * unitR2) + (f2 * unitF2) + (m2 > 0 ? getMonthlyPrice(m2) : 0); 

                let card1 = `
                    <div class="dash-card selected-card" id="card-scheme-1" onclick="selectUpPlan('card-scheme-1', 'ã€ä¸“å±é«˜å®šã€‘å…¨æ¯ç§äº«åŒ…', '${r+f}èŠ‚+${m}ä¸ªæœˆ', 'Â¥ ${formatMoney(totalNew1)}')">
                        ${save1 > 0 ? `<div class="save-tag">é¦–è´­çœ Â¥${formatMoney(save1)}</div>` : ''}
                        <div class="dc-title">æ–¹æ¡ˆä¸€ï¼šã€ä¸“å±é«˜å®šã€‘å…¨æ¯ç§äº«åŒ…</div>
                        <div class="dc-subtitle">é”å®šæ–°å®¢åº•ä»·ï¼Œè¦†ç›–æ•™ç»ƒä¸ºæ‚¨ç»„åˆçš„å®Œæ•´è®¡åˆ’</div>
                        <div class="dc-flex">
                            <div class="dc-left">
                                <div class="dc-ses">${r+f}<span>èŠ‚(+åŒ…æœˆ)</span></div>
                            </div>
                            <div class="dc-right">
                                <div class="dc-ori">æ•£å®¢åŸæ€»ä»· Â¥${formatMoney(totalOri1)}</div>
                                <div class="dc-new"><span>Â¥</span>${formatMoney(totalNew1)}</div>
                            </div>
                        </div>
                        <div class="dc-footer">
                            <div class="dc-f-ori">æŒ‰é¡¹æ··åˆè®¡ä»·</div>
                            <div class="dc-f-new">äº«é¦–è´­ç ´å†°ç‰¹æƒ</div>
                        </div>
                        <div class="check-ribbon">âœ“ å·²ä¼˜é€‰</div>
                    </div>
                `;

                let card2 = `
                    <div class="dash-card basic" id="card-scheme-2" onclick="selectUpPlan('card-scheme-2', 'ã€åŸä»·å¯åŠ¨ã€‘åŠç¨‹ä¿ç•™åŒ…', '${r2+f2}èŠ‚+${m2}ä¸ªæœˆ', 'Â¥ ${formatMoney(totalNew2)}')">
                        <div class="dc-title" style="color:#aaa;">æ–¹æ¡ˆäºŒï¼šã€åŸä»·å¯åŠ¨ã€‘åŠç¨‹ä¿ç•™åŒ…</div>
                        <div class="dc-subtitle">å…ˆä»¥åŸä»·å¯åŠ¨åŠç¨‹ï¼Œ2å‘¨å†…è¡¥å…¨å·®ä»·å³å¯è¿½æº¯ç‰¹æƒä»·</div>
                        <div class="dc-flex">
                            <div class="dc-left">
                                <div class="dc-ses" style="color:#fff;">${r2+f2}<span>èŠ‚(+åŒ…æœˆ)</span></div>
                            </div>
                            <div class="dc-right">
                                <div class="dc-new" style="color:#fff;"><span>Â¥</span>${formatMoney(totalNew2)}</div>
                            </div>
                        </div>
                        <div class="dc-footer">
                            <div class="dc-f-ori" style="text-decoration:none;">å¸¸è§„é˜¶æ¢¯ä»·è®¡ç®—</div>
                            <div class="dc-f-new" style="color:#aaa;">æš‚ä¸äº«ç‰¹æƒåº•ä»·</div>
                        </div>
                        <div class="check-ribbon" style="background:#555; color:#fff;">âœ“ å·²ä¼˜é€‰</div>
                    </div>
                `;

                container.innerHTML = card1 + card2 + `<div class="urgency-rule"><strong>âš ï¸ é”ä»·æ³•åˆ™ï¼š</strong> æ–¹æ¡ˆäºŒæŒ‰åŸé˜¶æ¢¯ä»·ç»“ç®—ã€‚<strong>2å‘¨å†…</strong>è¡¥é½å°¾æ¬¾ï¼Œå³å¯å°†å…¨éƒ¨è¯¾ç¨‹è¿½æº¯å‡çº§ä¸ºã€æ–¹æ¡ˆä¸€ã€‘çš„é¦–è´­ç‰¹æƒåº•ä»·ã€‚</div>`;
                selectUpPlan('card-scheme-1', 'ã€ä¸“å±é«˜å®šã€‘å…¨æ¯ç§äº«åŒ…', `${r+f}èŠ‚+${m}ä¸ªæœˆ`, `Â¥ ${formatMoney(totalNew1)}`);

            } else {
                let phaseNames = [];
                document.querySelectorAll('.phase-box.selected:not(.combo-box)').forEach(box => {
                    let pStep = box.querySelector('.p-step').innerText; 
                    let cleanName = pStep.split('/')[1].trim(); 
                    phaseNames.push(cleanName);
                });
                let targetName = phaseNames.join(" + ");
                if(!targetName) targetName = "ç›®æ ‡";

                document.getElementById('up-sub-text').innerHTML = `åŸºäºæ‚¨é€‰æ‹©çš„ <strong style="color:var(--primary)">ã€${targetName}ã€‘</strong>ï¼Œä¸ºæ‚¨åŒ¹é…ä»¥ä¸‹åŒè½¨æ–¹æ¡ˆï¼š`;

                let exactSessions = globalTotalExact; 
                let pkgCore = exactSessions; 
                
                let pkgEntry = Math.ceil(pkgCore / 2);
                if (pkgEntry < 1) pkgEntry = 1;

                let unitC = getUnitPrice(pkgEntry, data.type); 
                
                let totalOriB = pkgCore * baseOriPrice; 
                let totalNewB = pkgCore * newbiePrice; 
                let saveB = totalOriB - totalNewB;
                
                let totalNewC = pkgEntry * unitC; 

                let card1 = `
                    <div class="dash-card selected-card" id="card-scheme-1" onclick="selectUpPlan('card-scheme-1', '${targetName} ä¸“å±ç²¾å‡†åŒ…', '${pkgCore}èŠ‚', 'Â¥ ${formatMoney(totalNewB)}')">
                        ${saveB > 0 ? `<div class="save-tag">é¦–è´­çœ Â¥${formatMoney(saveB)}</div>` : ''}
                        <div class="dc-title">æ–¹æ¡ˆä¸€ï¼šã€${targetName}ã€‘ä¸“å±ç²¾å‡†åŒ…</div>
                        <div class="dc-subtitle">å®Œå…¨å¥‘åˆæ‚¨é€‰æ‹©çš„å‘¨æœŸä¸é¢‘æ¬¡ï¼Œæ•ˆæœæœ€å¤§åŒ–</div>
                        <div class="dc-flex">
                            <div class="dc-left">
                                <div class="dc-ses">${pkgCore}<span>èŠ‚</span></div>
                            </div>
                            <div class="dc-right">
                                <div class="dc-ori">æ•£å®¢åŸæ€»ä»· Â¥${formatMoney(totalOriB)}</div>
                                <div class="dc-new"><span>Â¥</span>${formatMoney(totalNewB)}</div>
                            </div>
                        </div>
                        <div class="dc-footer">
                            <div class="dc-f-ori">åŸæ•£å®¢ä»· <del>Â¥${baseOriPrice}/èŠ‚</del></div>
                            <div class="dc-f-new">é¦–è´­ç‰¹æƒ Â¥${newbiePrice}/èŠ‚</div>
                        </div>
                        <div class="check-ribbon">âœ“ å·²ä¼˜é€‰</div>
                    </div>
                `;

                let card2 = `
                    <div class="dash-card basic" id="card-scheme-2" onclick="selectUpPlan('card-scheme-2', 'ã€åŸä»·å¯åŠ¨ã€‘åŠç¨‹ä¿ç•™åŒ…', '${pkgEntry}èŠ‚', 'Â¥ ${formatMoney(totalNewC)}')">
                        <div class="dc-title" style="color:#aaa;">æ–¹æ¡ˆäºŒï¼šã€åŸä»·å¯åŠ¨ã€‘åŠç¨‹ä¿ç•™åŒ…</div>
                        <div class="dc-subtitle">å…ˆä»¥åŸä»·å¯åŠ¨åŠç¨‹ï¼Œ2å‘¨å†…è¡¥å…¨å·®ä»·å³å¯è¿½æº¯ç‰¹æƒä»·</div>
                        <div class="dc-flex">
                            <div class="dc-left">
                                <div class="dc-ses" style="color:#fff;">${pkgEntry}<span>èŠ‚</span></div>
                            </div>
                            <div class="dc-right">
                                <div class="dc-new" style="color:#fff;"><span>Â¥</span>${formatMoney(totalNewC)}</div>
                            </div>
                        </div>
                        <div class="dc-footer">
                            <div class="dc-f-ori" style="text-decoration:none;">æŒ‰åŸé˜¶æ¢¯æ‰§è¡Œ</div>
                            <div class="dc-f-new" style="color:#aaa;">åŸä»· Â¥${unitC}/èŠ‚</div>
                        </div>
                        <div class="check-ribbon" style="background:#555; color:#fff;">âœ“ å·²ä¼˜é€‰</div>
                    </div>
                `;

                container.innerHTML = card1 + card2 + `<div class="urgency-rule"><strong>âš ï¸ é”ä»·æ³•åˆ™ï¼š</strong> æ–¹æ¡ˆäºŒæŒ‰åŸé˜¶æ¢¯ä»·ç»“ç®—ã€‚<strong>2å‘¨å†…</strong>è¡¥é½å°¾æ¬¾ï¼Œå³å¯å°†å…¨éƒ¨è¯¾ç¨‹è¿½æº¯å‡çº§ä¸ºã€æ–¹æ¡ˆä¸€ã€‘çš„é¦–è´­ç‰¹æƒåº•ä»·ã€‚</div>`;
                selectUpPlan('card-scheme-1', `${targetName} ä¸“å±ç²¾å‡†åŒ…`, `${pkgCore}èŠ‚`, `Â¥ ${formatMoney(totalNewB)}`);
            }

            document.getElementById('upsellOverlay').classList.add('show');
            document.getElementById('upsellModal').classList.add('show');
        }

        function closeUpsellModal() {
            document.getElementById('upsellOverlay').classList.remove('show');
            document.getElementById('upsellModal').classList.remove('show');
        }

        let sigCanvas, sigCtx, isSigning = false;

        function openSignature(pkgName, sessions, price) {
            closeUpsellModal();
            document.getElementById('signatureModal').classList.add('show');
            
            document.getElementById('sig-pad-wrap').innerHTML = `
                <div class="sig-summary" id="sig-summary-box">
                    <div class="sig-sum-title">å³å°†ä¸ºæ‚¨é”å®šä»¥ä¸‹ä¸“å±é‡å¡‘æ–¹æ¡ˆï¼š</div>
                    <div style="font-size:12px; color:#888;">æ‰€å±ä½“ç³»: <span style="color:#ccc;">${planData[currentPlanKey].title}</span></div>
                    <div class="sig-sum-data">
                        <div class="sig-sum-name">${pkgName} <span style="font-size:12px; color:#fff;">(${sessions})</span></div>
                        <div class="sig-sum-price">${price}</div>
                    </div>
                </div>
                <div class="sig-pad-container">
                    <div class="sig-placeholder">è¯·åœ¨æ­¤å¤„æ‰‹å†™ç­¾å</div>
                    <canvas id="sigCanvas"></canvas>
                </div>
                <div class="sig-actions" id="sig-actions-box">
                    <button class="btn-clear" onclick="clearCanvas()">é‡æ–°ç­¾å</button>
                    <button class="btn-confirm-sig" onclick="generateContractImage()">ç¡®è®¤ä¿å­˜å¹¶ç”ŸæˆåˆåŒ</button>
                </div>
                <div style="margin-top: 5px; font-size: 10px; color: #666; text-align: center;" id="sig-footer-note">
                    * ç­¾ç½²å³ä»£è¡¨æ‚¨åŒæ„æœ¬é—¨åº—ä¹‹ã€Šè¯¾ç¨‹æœ‰æ•ˆæœŸåŠåœºåœ°ä½¿ç”¨è§„èŒƒã€‹ã€‚
                </div>
            `;

            setTimeout(() => {
                sigCanvas = document.getElementById('sigCanvas');
                sigCtx = sigCanvas.getContext('2d');
                let rect = sigCanvas.parentElement.getBoundingClientRect();
                sigCanvas.width = rect.width;
                sigCanvas.height = rect.height;
                
                sigCtx.strokeStyle = '#D4AF37'; 
                sigCtx.lineWidth = 4;
                sigCtx.lineCap = 'round';
                sigCtx.lineJoin = 'round';
                
                sigCanvas.addEventListener('touchstart', startSign, {passive: false});
                sigCanvas.addEventListener('touchmove', drawSign, {passive: false});
                sigCanvas.addEventListener('touchend', endSign);
                sigCanvas.addEventListener('mousedown', startSign);
                sigCanvas.addEventListener('mousemove', drawSign);
                sigCanvas.addEventListener('mouseup', endSign);
                sigCanvas.addEventListener('mouseout', endSign);
            }, 400);
        }

        function getSignPos(e) {
            let rect = sigCanvas.getBoundingClientRect();
            let x = e.clientX, y = e.clientY;
            if(e.touches && e.touches.length > 0) { x = e.touches[0].clientX; y = e.touches[0].clientY; }
            return { x: x - rect.left, y: y - rect.top };
        }

        function startSign(e) {
            e.preventDefault();
            isSigning = true;
            let pos = getSignPos(e);
            sigCtx.beginPath();
            sigCtx.moveTo(pos.x, pos.y);
            let ph = document.querySelector('.sig-placeholder');
            if(ph) ph.style.display = 'none'; 
        }

        function drawSign(e) {
            if(!isSigning) return;
            e.preventDefault();
            let pos = getSignPos(e);
            sigCtx.lineTo(pos.x, pos.y);
            sigCtx.stroke();
        }

        function endSign() { isSigning = false; sigCtx.closePath(); }
        function clearCanvas() {
            if(!sigCtx) return;
            sigCtx.clearRect(0, 0, sigCanvas.width, sigCanvas.height);
            let ph = document.querySelector('.sig-placeholder');
            if(ph) ph.style.display = 'block';
        }

        function generateContractImage() {
            if(!sigCtx) return;

            const finalCanvas = document.createElement('canvas');
            finalCanvas.width = 800;
            finalCanvas.height = 1100;
            const ctx = finalCanvas.getContext('2d');

            ctx.fillStyle = '#0D0D11';
            ctx.fillRect(0, 0, finalCanvas.width, finalCanvas.height);

            ctx.strokeStyle = '#D4AF37';
            ctx.lineWidth = 6;
            ctx.strokeRect(30, 30, finalCanvas.width - 60, finalCanvas.height - 60);

            ctx.fillStyle = '#D4AF37';
            ctx.font = 'bold 50px sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('LUXIOU å°Šäº«å®šåˆ¶åˆçº¦', 400, 120);
            
            ctx.fillStyle = '#444';
            ctx.font = '24px sans-serif';
            ctx.fillText('EXCLUSIVE CUSTOMIZED CONTRACT', 400, 165);

            ctx.textAlign = 'left';
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '32px sans-serif';
            
            const sysName = planData[currentPlanKey].title;
            const pkgName = selectedUpsell.name;
            const pkgSessions = selectedUpsell.sessions;
            const pkgPrice = selectedUpsell.price;

            ctx.fillText('æ‰€å±ä½“ç³»ï¼š' + sysName, 80, 280);
            ctx.fillText('é”å®šæ–¹æ¡ˆï¼š' + pkgName, 80, 360);
            ctx.fillText('åŒ…å«è¯¾æ—¶ï¼š' + pkgSessions, 80, 440);

            ctx.fillStyle = '#D4AF37';
            ctx.font = 'bold 46px sans-serif';
            ctx.fillText('æ ¸ç®—æ€»ä»·ï¼š' + pkgPrice, 80, 540);

            ctx.fillStyle = '#888888';
            ctx.font = '24px sans-serif';
            ctx.fillText('* æœ¬åˆçº¦åŒ…å«é—¨åº—å¸¸è§„è¯¾ç¨‹æœ‰æ•ˆæœŸåŠåœºåœ°ä½¿ç”¨æƒé™', 80, 620);
            ctx.fillText('* ç­¾å­—å³ä»£è¡¨è®¤åŒã€ŠLUXIOU é—¨åº—ä¼šå‘˜å¥åº·ç®¡ç†è§„ç« ã€‹', 80, 660);

            ctx.fillStyle = '#FFFFFF';
            ctx.font = 'bold 32px sans-serif';
            ctx.fillText('å®¢æˆ·æ‰‹å†™ç¡®è®¤ç­¾åï¼š', 80, 780);

            const scW = sigCanvas.width;
            const scH = sigCanvas.height;
            const scale = Math.min(640 / scW, 250 / scH);
            const dw = scW * scale;
            const dh = scH * scale;

            ctx.drawImage(sigCanvas, 80, 810, dw, dh);
            
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(80, 810 + dh + 10);
            ctx.lineTo(720, 810 + dh + 10);
            ctx.stroke();

            const dataURL = finalCanvas.toDataURL('image/png');

            document.getElementById('sig-pad-wrap').innerHTML = `
                <div style="text-align:center; color:var(--primary); margin-bottom:15px; font-weight:bold; font-size:18px;">
                    âœ¦ åˆåŒç”ŸæˆæˆåŠŸ âœ¦<br>
                    <span style="font-size:12px; color:#aaa; font-weight:normal;">è¯·é•¿æŒ‰ä¸‹æ–¹å›¾ç‰‡ï¼Œä¿å­˜è‡³æ‰‹æœºç›¸å†Œç•™å­˜</span>
                </div>
                <div style="flex:1; overflow-y:auto; border-radius:12px; box-shadow: 0 10px 40px rgba(212,175,55,0.25); border: 1px solid rgba(212,175,55,0.5);">
                    <img src="${dataURL}" style="width:100%; display:block;">
                </div>
                <div class="sig-actions" style="margin-top:20px;">
                    <button class="btn-confirm-master" onclick="finishAndReturn()">å®Œæˆç­¾çº¦ï¼Œè¿”å›é¦–é¡µ â”</button>
                </div>
            `;
        }
    </script>
</body>
</html>
