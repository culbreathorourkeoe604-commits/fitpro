<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Rç¥ç²¾è‡´å¥èº« | å·…å³°æŠ¥ä»·ä»ªè¡¨ç›˜</title>
    <style>
        /* é¡¶çº§é¦™æ§Ÿé»‘é‡‘é…è‰² */
        :root { --primary: #E8C37C; --primary-dark: #C69A45; --bg-deep: #050505; --card-light: #16161A; --card-dark: #0A0A0C; --text-main: #FFFFFF; --text-sub: #A0A0AB; --danger: #FF3B30;}
        
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; margin: 0; padding: 0; }
        html, body { width: 100%; height: 100%; overflow: hidden; background: var(--bg-deep); color: var(--text-main); font-family: "DIN Alternate", -apple-system, sans-serif; -webkit-font-smoothing: antialiased; display: flex; flex-direction: column; }
        
        body::before { content: ''; position: absolute; top: -10vh; left: 50%; transform: translateX(-50%); width: 150vw; height: 30vh; background: radial-gradient(ellipse, rgba(232, 195, 124, 0.15) 0%, transparent 70%); z-index: 0; pointer-events: none; }

        .header-brand { width: 100%; height: 60px; display: flex; align-items: center; justify-content: center; position: relative; z-index: 50; flex-shrink: 0;}
        .brand-text { font-size: 16px; font-weight: 900; color: var(--primary); letter-spacing: 3px; }

        .seg-control { display: flex; background: rgba(20,20,25,0.8); border-radius: 12px; padding: 5px; margin: 5px 20px 15px; border: 1px solid rgba(255,255,255,0.05); flex-shrink: 0; z-index: 10; backdrop-filter: blur(10px);}
        .seg-btn { flex: 1; text-align: center; padding: 10px 0; font-size: 13px; font-weight: bold; color: #666; border-radius: 8px; transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1); cursor: pointer; position: relative; z-index: 2;}
        .seg-btn.active { color: #000; text-shadow: none; font-weight: 900;}
        .seg-btn.active::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(135deg, var(--primary), var(--primary-dark)); border-radius: 8px; z-index: -1; box-shadow: 0 4px 12px rgba(232, 195, 124, 0.4); }

        .matrix-container { flex: 1; width: 100%; padding: 0 20px 90px; overflow-y: auto; -webkit-overflow-scrolling: touch; z-index: 5; position: relative; }
        .price-section { display: none; flex-direction: column; gap: 12px; animation: scaleUp 0.4s cubic-bezier(0.2, 0.8, 0.2, 1); }
        .price-section.active { display: flex; }
        @keyframes scaleUp { from { opacity: 0; transform: translateY(10px) scale(0.98); } to { opacity: 1; transform: translateY(0) scale(1); } }

        .grid-2x2 { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }
        
        .m-card { background: linear-gradient(145deg, var(--card-light), var(--card-dark)); border: 1px solid rgba(255,255,255,0.06); border-radius: 16px; padding: 18px 15px; position: relative; cursor: pointer; transition: all 0.3s cubic-bezier(0.2, 0.8, 0.2, 1); display: flex; flex-direction: column; gap: 10px; overflow: hidden; box-shadow: 0 8px 20px rgba(0,0,0,0.6);}
        .m-card:active { transform: scale(0.96); }
        
        .m-card.selected { border-color: var(--primary); background: linear-gradient(145deg, #221A0F, #0A0A0C); box-shadow: 0 10px 30px rgba(232, 195, 124, 0.2), inset 0 0 15px rgba(232, 195, 124, 0.1); transform: translateY(-2px);}
        .m-card.selected::after { content: 'âœ“'; position: absolute; bottom: 15px; right: 15px; color: #000; font-size: 12px; font-weight: bold; background: var(--primary); border-radius: 50%; width: 18px; height: 18px; text-align: center; line-height: 18px; box-shadow: 0 2px 8px rgba(232, 195, 124, 0.5);}

        .save-tag { position: absolute; top: 0; right: 0; background: linear-gradient(135deg, #FF4B40, #D91D12); color: #fff; font-size: 9px; font-weight: 900; padding: 4px 10px; border-radius: 0 0 0 12px; letter-spacing: 0.5px; box-shadow: -2px 2px 10px rgba(217, 29, 18, 0.3); z-index: 10;}
        .vip .save-tag { background: linear-gradient(135deg, var(--primary), #B58428); color: #000; box-shadow: -2px 2px 10px rgba(232, 195, 124, 0.4);}

        .mc-top { display: flex; justify-content: space-between; align-items: flex-end; }
        .mc-ses { font-size: 24px; font-weight: 900; color: #fff; line-height: 1;}
        .selected .mc-ses { color: var(--primary); }
        .mc-ses span { font-size: 10px; color: #888; font-weight: normal; margin-left: 2px;}
        
        .mc-mid { display: flex; flex-direction: column; gap: 2px; margin-top: 5px;}
        .mc-ori { font-size: 11px; color: #666; text-decoration: line-through; }
        .mc-new { font-size: 24px; font-weight: 900; color: #fff; display: flex; align-items: baseline; gap: 2px;}
        .selected .mc-new { color: var(--primary); text-shadow: 0 0 15px rgba(232, 195, 124, 0.3); font-size: 26px;}
        .mc-new span { font-size: 14px; }

        /* ğŸš¨ å¼ºåŒ–å•ä»·å¯¹æ¯”æ  */
        .mc-bot { font-size: 10px; color: #888; border-top: 1px dashed rgba(255,255,255,0.1); padding-top: 8px; margin-top: auto; display: flex; justify-content: space-between; align-items: center;}
        .selected .mc-bot { color: #ccc; border-top-color: rgba(232, 195, 124, 0.2);}
        .mc-bot-ori { color: #666; text-decoration: line-through; }
        .mc-bot-new { color: var(--primary); font-weight: bold; font-size: 11px;}

        .full-card { grid-column: span 2; display: flex; justify-content: space-between; align-items: center; padding: 18px 20px; border-style: dashed;}
        .fc-left .mc-ses { font-size: 20px; }
        .fc-left .mc-bot { border: none; padding-top: 4px; font-size: 11px;}
        .fc-right { text-align: right; }
        .fc-right .mc-new { font-size: 22px; justify-content: flex-end; color: var(--primary);}

        .action-bar { position: fixed; bottom: 0; left: 0; width: 100%; padding: 15px 20px 25px; background: linear-gradient(to top, rgba(5,5,5,1) 60%, rgba(5,5,5,0)); z-index: 100; }
        .btn-master { width: 100%; background: linear-gradient(135deg, var(--primary), var(--primary-dark)); color: #000; border: none; padding: 16px; border-radius: 12px; font-size: 16px; font-weight: 900; box-shadow: 0 8px 25px rgba(232, 195, 124, 0.3); cursor: pointer; transition: 0.2s; display: flex; justify-content: center; align-items: center; gap: 8px;}
        .btn-master:active { transform: scale(0.98); box-shadow: 0 4px 10px rgba(232, 195, 124, 0.2);}

        /* ğŸš¨ å…¨å±ç”µå­ç­¾ååˆåŒå°é˜²æ¼‚ç§» */
        .sig-modal { position: fixed; top: 100vh; left: 0; width: 100%; height: 100vh; background: #08080A; z-index: 2000; transition: top 0.4s cubic-bezier(0.2, 0.8, 0.2, 1); display: flex; flex-direction: column; overflow-x: hidden;}
        .sig-modal.show { top: 0; }
        .sig-header { height: 60px; display: flex; justify-content: space-between; align-items: center; padding: 0 20px; background: rgba(5,5,5,0.95); border-bottom: 1px solid rgba(212,175,55,0.3); flex-shrink:0;}
        .sig-title { font-size: 16px; font-weight: bold; color: var(--primary); }
        .sig-content { padding: 20px; flex: 1; display: flex; flex-direction: column; overflow-y: auto;}
        
        .sig-pad-wrap { flex: 1; display: flex; flex-direction: column; min-height: 300px;}
        
        .sig-summary { background: linear-gradient(145deg, #18181A, #0A0A0C); padding: 20px; border-radius: 12px; margin-bottom: 20px; border: 1px solid rgba(212,175,55,0.3); box-shadow: 0 10px 30px rgba(0,0,0,0.5);}
        .sig-sum-title { color: #fff; font-size: 14px; margin-bottom: 10px; font-weight: bold;}
        .sig-sum-data { display: flex; justify-content: space-between; align-items: flex-end; border-top: 1px dashed rgba(255,255,255,0.1); padding-top: 15px; margin-top: 10px;}
        .sig-sum-name { font-size: 16px; color: var(--primary); font-weight: 900;}
        .sig-sum-price { font-size: 24px; color: #fff; font-weight: 900;}

        .sig-pad-container { flex: 1; border: 1px dashed #555; border-radius: 12px; background: #111; position: relative; overflow: hidden; box-shadow: inset 0 0 20px rgba(0,0,0,0.8); min-height: 250px;}
        #sigCanvas { width: 100%; height: 100%; touch-action: none; cursor: crosshair; display: block;}
        .sig-placeholder { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #444; font-size: 24px; font-weight: bold; pointer-events: none; letter-spacing: 2px;}
        
        .sig-actions { display: flex; gap: 15px; margin-top: 20px; margin-bottom: 10px; flex-shrink:0;}
        .btn-clear { flex: 1; background: #222; color: #fff; padding: 16px; border-radius: 12px; text-align: center; border: 1px solid #444; font-weight: bold; font-size: 15px; cursor:pointer;}
        .btn-confirm-sig { flex: 2; background: linear-gradient(135deg, var(--primary), #AA8A2A); color: #000; padding: 16px; border-radius: 12px; text-align: center; border: none; font-weight: 900; font-size: 16px; box-shadow: 0 5px 20px rgba(212,175,55,0.3); cursor:pointer;}
    </style>
</head>
<body>

    <div class="header-brand">
        <div class="brand-text">Rç¥ç²¾è‡´å¥èº« | é¦–è´­ç‰¹æƒåº“</div>
    </div>

    <div class="seg-control">
        <div class="seg-btn active" onclick="switchView('regular', this)">å¸¸è§„æ–¹æ¡ˆ</div>
        <div class="seg-btn" onclick="switchView('feature', this)">ç‰¹è‰²é«˜å®š</div>
        <div class="seg-btn" onclick="switchView('monthly', this)">æé€ŸåŒ…æœˆ</div>
    </div>

    <div class="matrix-container">
        
        <div id="view-regular" class="price-section active">
            <div class="grid-2x2">
                <div class="m-card" onclick="selectCard(this, 'å¸¸è§„å‡è„‚/å¡‘å½¢', '12èŠ‚', 'Â¥ 4,200')">
                    <div class="save-tag">é¦–è´­çœ Â¥1,080</div>
                    <div class="mc-top"><div class="mc-ses">12<span>èŠ‚</span></div></div>
                    <div class="mc-mid">
                        <div class="mc-ori">åŸé˜¶æ¢¯æ€»ä»· Â¥5,280</div>
                        <div class="mc-new"><span>Â¥</span>4,200</div>
                    </div>
                    <div class="mc-bot">
                        <span class="mc-bot-ori">åŸ Â¥440/èŠ‚</span>
                        <span class="mc-bot-new">é¦–è´­ Â¥350/èŠ‚</span>
                    </div>
                </div>

                <div class="m-card" onclick="selectCard(this, 'å¸¸è§„å‡è„‚/å¡‘å½¢', '24èŠ‚', 'Â¥ 8,400')">
                    <div class="save-tag">é¦–è´­çœ Â¥1,680</div>
                    <div class="mc-top"><div class="mc-ses">24<span>èŠ‚</span></div></div>
                    <div class="mc-mid">
                        <div class="mc-ori">åŸé˜¶æ¢¯æ€»ä»· Â¥10,080</div>
                        <div class="mc-new"><span>Â¥</span>8,400</div>
                    </div>
                    <div class="mc-bot">
                        <span class="mc-bot-ori">åŸ Â¥420/èŠ‚</span>
                        <span class="mc-bot-new">é¦–è´­ Â¥350/èŠ‚</span>
                    </div>
                </div>

                <div class="m-card vip selected" onclick="selectCard(this, 'å¸¸è§„å‡è„‚/å¡‘å½¢', '48èŠ‚', 'Â¥ 16,800')">
                    <div class="save-tag">ç‹ç‰Œä¸»æ¨ çœ Â¥2,400</div>
                    <div class="mc-top"><div class="mc-ses">48<span>èŠ‚</span></div></div>
                    <div class="mc-mid">
                        <div class="mc-ori">åŸé˜¶æ¢¯æ€»ä»· Â¥19,200</div>
                        <div class="mc-new"><span>Â¥</span>16,800</div>
                    </div>
                    <div class="mc-bot">
                        <span class="mc-bot-ori">åŸ Â¥400/èŠ‚</span>
                        <span class="mc-bot-new">é¦–è´­ Â¥350/èŠ‚</span>
                    </div>
                </div>

                <div class="m-card" onclick="selectCard(this, 'å¸¸è§„å‡è„‚/å¡‘å½¢', '72èŠ‚', 'Â¥ 25,200')">
                    <div class="save-tag">é¦–è´­çœ Â¥2,160</div>
                    <div class="mc-top"><div class="mc-ses">72<span>èŠ‚</span></div></div>
                    <div class="mc-mid">
                        <div class="mc-ori">åŸé˜¶æ¢¯æ€»ä»· Â¥27,360</div>
                        <div class="mc-new"><span>Â¥</span>25,200</div>
                    </div>
                    <div class="mc-bot">
                        <span class="mc-bot-ori">åŸ Â¥380/èŠ‚</span>
                        <span class="mc-bot-new">é¦–è´­ Â¥350/èŠ‚</span>
                    </div>
                </div>
            </div>
            
            <div class="m-card full-card" onclick="selectCard(this, 'å¹´åº¦å¸¸è§„æ‰˜ç®¡', '100+èŠ‚', 'æŒ‰é˜¶æ¢¯æ ¸ç®—')">
                <div class="fc-left">
                    <div class="mc-ses">100+<span>èŠ‚</span></div>
                    <div class="mc-bot">å¹´åº¦ç»ˆèº«èº«ææ‰˜ç®¡</div>
                </div>
                <div class="fc-right">
                    <div class="mc-ori" style="margin-bottom:2px;">äº«é—¨åº—æœ€é«˜ä¼˜äº«æ’è¯¾æƒ</div>
                    <div class="mc-new" style="font-size:18px;"><span>ä½è‡³ Â¥</span>330<span>/èŠ‚èµ·</span></div>
                </div>
            </div>
        </div>

        <div id="view-feature" class="price-section">
            <div class="grid-2x2">
                <div class="m-card" onclick="selectCard(this, 'åº·å¤/æ™®æ‹‰æå¹²é¢„', '12èŠ‚', 'Â¥ 4,560')">
                    <div class="save-tag">é¦–è´­çœ Â¥960</div>
                    <div class="mc-top"><div class="mc-ses">12<span>èŠ‚</span></div></div>
                    <div class="mc-mid">
                        <div class="mc-ori">åŸé˜¶æ¢¯æ€»ä»· Â¥5,520</div>
                        <div class="mc-new"><span>Â¥</span>4,560</div>
                    </div>
                    <div class="mc-bot">
                        <span class="mc-bot-ori">åŸ Â¥460/èŠ‚</span>
                        <span class="mc-bot-new">é¦–è´­ Â¥380/èŠ‚</span>
                    </div>
                </div>

                <div class="m-card" onclick="selectCard(this, 'åº·å¤/æ™®æ‹‰æå¹²é¢„', '24èŠ‚', 'Â¥ 9,120')">
                    <div class="save-tag">é¦–è´­çœ Â¥1,440</div>
                    <div class="mc-top"><div class="mc-ses">24<span>èŠ‚</span></div></div>
                    <div class="mc-mid">
                        <div class="mc-ori">åŸé˜¶æ¢¯æ€»ä»· Â¥10,560</div>
                        <div class="mc-new"><span>Â¥</span>9,120</div>
                    </div>
                    <div class="mc-bot">
                        <span class="mc-bot-ori">åŸ Â¥440/èŠ‚</span>
                        <span class="mc-bot-new">é¦–è´­ Â¥380/èŠ‚</span>
                    </div>
                </div>

                <div class="m-card vip" onclick="selectCard(this, 'åº·å¤/æ™®æ‹‰æå¹²é¢„', '48èŠ‚', 'Â¥ 18,240')">
                    <div class="save-tag">ç‹ç‰Œä¸»æ¨ çœ Â¥1,920</div>
                    <div class="mc-top"><div class="mc-ses">48<span>èŠ‚</span></div></div>
                    <div class="mc-mid">
                        <div class="mc-ori">åŸé˜¶æ¢¯æ€»ä»· Â¥20,160</div>
                        <div class="mc-new"><span>Â¥</span>18,240</div>
                    </div>
                    <div class="mc-bot">
                        <span class="mc-bot-ori">åŸ Â¥420/èŠ‚</span>
                        <span class="mc-bot-new">é¦–è´­ Â¥380/èŠ‚</span>
                    </div>
                </div>

                <div class="m-card" onclick="selectCard(this, 'åº·å¤/æ™®æ‹‰æå¹²é¢„', '72èŠ‚', 'Â¥ 27,360')">
                    <div class="save-tag">é¦–è´­çœ Â¥1,440</div>
                    <div class="mc-top"><div class="mc-ses">72<span>èŠ‚</span></div></div>
                    <div class="mc-mid">
                        <div class="mc-ori">åŸé˜¶æ¢¯æ€»ä»· Â¥28,800</div>
                        <div class="mc-new"><span>Â¥</span>27,360</div>
                    </div>
                    <div class="mc-bot">
                        <span class="mc-bot-ori">åŸ Â¥400/èŠ‚</span>
                        <span class="mc-bot-new">é¦–è´­ Â¥380/èŠ‚</span>
                    </div>
                </div>
            </div>

            <div class="m-card full-card" onclick="selectCard(this, 'ç‰¹è‰²é¡¶çº§æŠ¤èˆª', '100+èŠ‚', 'æŒ‰é˜¶æ¢¯æ ¸ç®—')">
                <div class="fc-left">
                    <div class="mc-ses">100+<span>èŠ‚</span></div>
                    <div class="mc-bot">å…¨é¢è¦†ç›–åº·å¤ä¸ç²¾ç»†å¡‘å½¢</div>
                </div>
                <div class="fc-right">
                    <div class="mc-ori" style="margin-bottom:2px;">å®Œç¾èº«ä½“æ§åˆ¶åŠ›æŠ¤ç”²</div>
                    <div class="mc-new" style="font-size:18px;"><span>ä½è‡³ Â¥</span>350<span>/èŠ‚èµ·</span></div>
                </div>
            </div>
        </div>

        <div id="view-monthly" class="price-section">
            <div class="grid-2x2">
                <div class="m-card" onclick="selectCard(this, 'å°Šäº«åŒ…æœˆ', '1ä¸ªæœˆ', 'Â¥ 3,888')">
                    <div class="save-tag" style="background:#444;">çªå‡»é‡å¡‘</div>
                    <div class="mc-top"><div class="mc-ses">1<span>ä¸ªæœˆ</span></div></div>
                    <div class="mc-mid">
                        <div style="font-size:11px; color:#888;">æœ€é«˜å¯çº¦ 16 èŠ‚ç§æ•™</div>
                        <div class="mc-new"><span>Â¥</span>3,888</div>
                    </div>
                    <div class="mc-bot">
                        <span class="mc-bot-ori" style="text-decoration:none;">æ ‡å‡†æ ¸ç®—</span>
                        <span class="mc-bot-new">Â¥3888/æœˆ</span>
                    </div>
                </div>

                <div class="m-card" onclick="selectCard(this, 'å°Šäº«åŒ…æœˆ', '2ä¸ªæœˆ', 'Â¥ 7,200')">
                    <div class="save-tag" style="background:#555;">å¹³å°è·¨è¶Š</div>
                    <div class="mc-top"><div class="mc-ses">2<span>ä¸ªæœˆ</span></div></div>
                    <div class="mc-mid">
                        <div class="mc-ori">åŸæ ¸ç®— Â¥7,776</div>
                        <div class="mc-new"><span>Â¥</span>7,200</div>
                    </div>
                    <div class="mc-bot">
                        <span class="mc-bot-ori">åŸ Â¥3888/æœˆ</span>
                        <span class="mc-bot-new">ç° Â¥3600/æœˆ</span>
                    </div>
                </div>

                <div class="m-card vip" onclick="selectCard(this, 'å°Šäº«åŒ…æœˆ', '3ä¸ªæœˆ(å­£å¡)', 'Â¥ 9,600')">
                    <div class="save-tag">æè‡´æ€§ä»·æ¯” å­£å¡</div>
                    <div class="mc-top"><div class="mc-ses">3<span>ä¸ªæœˆ</span></div></div>
                    <div class="mc-mid">
                        <div class="mc-ori">åŸæ ¸ç®— Â¥11,664</div>
                        <div class="mc-new"><span>Â¥</span>9,600</div>
                    </div>
                    <div class="mc-bot">
                        <span class="mc-bot-ori">åŸ Â¥3888/æœˆ</span>
                        <span class="mc-bot-new">ç° Â¥3200/æœˆ</span>
                    </div>
                </div>

                <div class="m-card" onclick="selectCard(this, 'å°Šäº«åŒ…æœˆ', '6ä¸ªæœˆ(åŠå¹´)', 'Â¥ 18,000')">
                    <div class="save-tag">é¡¶çº§é€†é¾„ åŠå¹´å¡</div>
                    <div class="mc-top"><div class="mc-ses">6<span>ä¸ªæœˆ</span></div></div>
                    <div class="mc-mid">
                        <div class="mc-ori">åŸæ ¸ç®— Â¥23,328</div>
                        <div class="mc-new"><span>Â¥</span>18,000</div>
                    </div>
                    <div class="mc-bot">
                        <span class="mc-bot-ori">åŸ Â¥3888/æœˆ</span>
                        <span class="mc-bot-new">æå€¼ Â¥3000/æœˆ</span>
                    </div>
                </div>
            </div>

            <div class="m-card full-card" style="border-style: dashed; background: transparent; box-shadow: none;">
                <div style="font-size: 11px; color: #666; line-height: 1.6; width: 100%;">
                    <strong>* åŒ…æœˆè§„åˆ™è¯´æ˜ï¼š</strong><br>
                    1. å‘¨æœŸå†…è‡³å¤šå¯é¢„çº¦ 16 èŠ‚/æœˆ ä¸“ä¸šç§æ•™æŒ‡å¯¼ã€‚<br>
                    2. è¥ä¸šæ—¶é—´å†…å°Šäº«é—¨åº—åœºåœ°æ— é™åˆ¶è‡ªç”±è®­ç»ƒã€‚
                </div>
            </div>
        </div>

    </div>

    <div class="action-bar">
        <button class="btn-master" id="btn-submit" onclick="triggerSignature()">
            é”å®š 48èŠ‚ é¦–è´­ç‰¹æƒ â”
        </button>
    </div>

    <div class="sig-modal" id="signatureModal">
        <div class="sig-header">
            <div class="sig-title">âœ¦ ç”µå­åˆåŒç­¾ç½²ä¸­å¿ƒ âœ¦</div>
            <button class="close-btn" onclick="closeSignature()" style="font-size: 28px; color: #888;">Ã—</button>
        </div>
        <div class="sig-content">
            
            <div id="sig-pad-wrap" class="sig-pad-wrap">
                </div>

        </div>
    </div>

    <script>
        // åˆå§‹çŠ¶æ€
        let currentType = "å¸¸è§„ç‰¹è®­";
        let currentSessions = "48èŠ‚";
        let currentPrice = "Â¥ 16,800";

        function switchView(type, btn) {
            document.querySelectorAll('.seg-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');

            currentType = btn.innerText;

            document.querySelectorAll('.price-section').forEach(sec => sec.classList.remove('active'));
            
            setTimeout(() => {
                let activePanel = document.getElementById('view-' + type);
                activePanel.classList.add('active');
                
                let defaultVip = activePanel.querySelector('.m-card.vip');
                if(defaultVip) {
                    defaultVip.click();
                } else {
                    let firstCard = activePanel.querySelector('.m-card');
                    if(firstCard) firstCard.click();
                }
            }, 10);
        }

        function selectCard(card, typeName, sessions, price) {
            let parent = card.closest('.price-section');
            parent.querySelectorAll('.m-card').forEach(c => c.classList.remove('selected'));
            
            card.classList.add('selected');
            currentType = typeName;
            currentSessions = sessions;
            currentPrice = price;
            
            let btn = document.getElementById('btn-submit');
            if (sessions.includes('+')) {
                btn.innerHTML = `é”å®š ${sessions} ç»ˆèº«ç‰¹æƒ â”`;
            } else if (sessions.includes('ä¸ªæœˆ')) {
                btn.innerHTML = `é”å®š ${sessions} åŒ…æœˆç‰¹æƒ â”`;
            } else {
                btn.innerHTML = `é”å®š ${sessions} é¦–è´­ç¦åˆ© â”`;
            }
            
            if(navigator.vibrate) navigator.vibrate(15);
        }

        // ================= ç­¾åä¸åˆåŒç”Ÿæˆç³»ç»Ÿ =================
        let sigCanvas, sigCtx, isSigning = false;

        function triggerSignature() {
            openSignature(currentType, currentSessions, currentPrice);
        }

        function openSignature(pkgName, sessions, price) {
            document.getElementById('signatureModal').classList.add('show');
            
            // æ¢å¤é»˜è®¤ç”»æ¿ç»“æ„
            document.getElementById('sig-pad-wrap').innerHTML = `
                <div class="sig-summary" id="sig-summary-box">
                    <div class="sig-sum-title">å³å°†ä¸ºæ‚¨é”å®šä»¥ä¸‹é¦–è´­ç‰¹æƒæ–¹æ¡ˆï¼š</div>
                    <div style="font-size:12px; color:#888;">æ‰€å±ä½“ç³»: <span style="color:#ccc;">Rç¥ä¸“å±å®šåˆ¶</span></div>
                    <div class="sig-sum-data">
                        <div class="sig-sum-name">${pkgName} <span style="font-size:12px; color:#fff;">(${sessions})</span></div>
                        <div class="sig-sum-price">${price}</div>
                    </div>
                </div>
                <div class="sig-pad-container">
                    <div class="sig-placeholder">è¯·åœ¨æ­¤å¤„æ‰‹å†™ç­¾å</div>
                    <canvas id="sigCanvas"></canvas>
                </div>
                <div class="sig-actions" id="sig-actions-box">
                    <button class="btn-clear" onclick="clearCanvas()">é‡æ–°ç­¾å</button>
                    <button class="btn-confirm-sig" onclick="generateContractImage()">ç¡®è®¤ä¿å­˜å¹¶ç”ŸæˆåˆåŒ</button>
                </div>
                <div style="margin-top: 5px; font-size: 10px; color: #666; text-align: center;" id="sig-footer-note">
                    * ç­¾ç½²å³ä»£è¡¨æ‚¨åŒæ„æœ¬é—¨åº—ä¹‹ã€Šè¯¾ç¨‹æœ‰æ•ˆæœŸåŠåœºåœ°ä½¿ç”¨è§„èŒƒã€‹ã€‚
                </div>
            `;

            setTimeout(() => {
                sigCanvas = document.getElementById('sigCanvas');
                sigCtx = sigCanvas.getContext('2d');
                let rect = sigCanvas.parentElement.getBoundingClientRect();
                sigCanvas.width = rect.width;
                sigCanvas.height = rect.height;
                
                sigCtx.strokeStyle = '#E8C37C'; 
                sigCtx.lineWidth = 4;
                sigCtx.lineCap = 'round';
                sigCtx.lineJoin = 'round';
                
                sigCanvas.addEventListener('touchstart', startSign, {passive: false});
                sigCanvas.addEventListener('touchmove', drawSign, {passive: false});
                sigCanvas.addEventListener('touchend', endSign);
                sigCanvas.addEventListener('mousedown', startSign);
                sigCanvas.addEventListener('mousemove', drawSign);
                sigCanvas.addEventListener('mouseup', endSign);
                sigCanvas.addEventListener('mouseout', endSign);
            }, 400);
        }

        function closeSignature() {
            document.getElementById('signatureModal').classList.remove('show');
            clearCanvas();
        }

        function getSignPos(e) {
            let rect = sigCanvas.getBoundingClientRect();
            let x = e.clientX, y = e.clientY;
            if(e.touches && e.touches.length > 0) {
                x = e.touches[0].clientX;
                y = e.touches[0].clientY;
            }
            return { x: x - rect.left, y: y - rect.top };
        }

        function startSign(e) {
            e.preventDefault();
            isSigning = true;
            let pos = getSignPos(e);
            sigCtx.beginPath();
            sigCtx.moveTo(pos.x, pos.y);
            let ph = document.querySelector('.sig-placeholder');
            if(ph) ph.style.display = 'none'; 
        }

        function drawSign(e) {
            if(!isSigning) return;
            e.preventDefault();
            let pos = getSignPos(e);
            sigCtx.lineTo(pos.x, pos.y);
            sigCtx.stroke();
        }

        function endSign() {
            isSigning = false;
            sigCtx.closePath();
        }

        function clearCanvas() {
            if(!sigCtx) return;
            sigCtx.clearRect(0, 0, sigCanvas.width, sigCanvas.height);
            let ph = document.querySelector('.sig-placeholder');
            if(ph) ph.style.display = 'block';
        }

        // åˆæˆå¹¶ç”Ÿæˆå¯ä¿å­˜çš„å›¾ç‰‡
        function generateContractImage() {
            if(!sigCtx) return;

            const finalCanvas = document.createElement('canvas');
            finalCanvas.width = 800;
            finalCanvas.height = 1100;
            const ctx = finalCanvas.getContext('2d');

            ctx.fillStyle = '#0D0D11';
            ctx.fillRect(0, 0, finalCanvas.width, finalCanvas.height);

            ctx.strokeStyle = '#E8C37C';
            ctx.lineWidth = 6;
            ctx.strokeRect(30, 30, finalCanvas.width - 60, finalCanvas.height - 60);

            ctx.fillStyle = '#E8C37C';
            ctx.font = 'bold 50px sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('Rç¥ç²¾è‡´å¥èº« å°Šäº«åˆçº¦', 400, 120);
            
            ctx.fillStyle = '#444';
            ctx.font = '24px sans-serif';
            ctx.fillText('EXCLUSIVE VIP CONTRACT', 400, 165);

            ctx.textAlign = 'left';
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '32px sans-serif';
            
            const sysName = "Rç¥ä¸“å±å®šåˆ¶";
            const pkgName = currentType;
            const pkgSessions = currentSessions;
            const pkgPrice = currentPrice;

            ctx.fillText('æ‰€å±ä½“ç³»ï¼š' + sysName, 80, 280);
            ctx.fillText('é”å®šæ–¹æ¡ˆï¼š' + pkgName, 80, 360);
            ctx.fillText('åŒ…å«è¯¾æ—¶ï¼š' + pkgSessions, 80, 440);

            ctx.fillStyle = '#E8C37C';
            ctx.font = 'bold 46px sans-serif';
            ctx.fillText('é¦–è´­ç‰¹æƒä»·ï¼š' + pkgPrice, 80, 540);

            ctx.fillStyle = '#888888';
            ctx.font = '24px sans-serif';
            ctx.fillText('* æœ¬åˆçº¦åŒ…å«é—¨åº—å¸¸è§„è¯¾ç¨‹æœ‰æ•ˆæœŸåŠåœºåœ°ä½¿ç”¨æƒé™', 80, 620);
            ctx.fillText('* ç­¾å­—å³ä»£è¡¨è®¤åŒã€ŠRç¥é—¨åº—ä¼šå‘˜å¥åº·ç®¡ç†è§„ç« ã€‹', 80, 660);

            ctx.fillStyle = '#FFFFFF';
            ctx.font = 'bold 32px sans-serif';
            ctx.fillText('å®¢æˆ·æ‰‹å†™ç¡®è®¤ç­¾åï¼š', 80, 780);

            const scW = sigCanvas.width;
            const scH = sigCanvas.height;
            const scale = Math.min(640 / scW, 250 / scH);
            const dw = scW * scale;
            const dh = scH * scale;

            ctx.drawImage(sigCanvas, 80, 810, dw, dh);
            
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(80, 810 + dh + 10);
            ctx.lineTo(720, 810 + dh + 10);
            ctx.stroke();

            const dataURL = finalCanvas.toDataURL('image/png');

            document.getElementById('sig-pad-wrap').innerHTML = `
                <div style="text-align:center; color:var(--primary); margin-bottom:15px; font-weight:bold; font-size:18px;">
                    âœ¦ åˆçº¦ç”ŸæˆæˆåŠŸ âœ¦<br>
                    <span style="font-size:12px; color:#aaa; font-weight:normal;">è¯·é•¿æŒ‰ä¸‹æ–¹å›¾ç‰‡ï¼Œä¿å­˜è‡³æ‰‹æœºç›¸å†Œç•™å­˜</span>
                </div>
                <div style="flex:1; overflow-y:auto; border-radius:12px; box-shadow: 0 10px 40px rgba(232, 195, 124, 0.25); border: 1px solid rgba(232, 195, 124, 0.5);">
                    <img src="${dataURL}" style="width:100%; display:block;">
                </div>
                <div class="sig-actions" style="margin-top:20px;">
                    <button class="btn-confirm-master" onclick="closeSignature()">å®Œæˆç­¾çº¦ï¼Œè¿”å›ä¸»é¡µ â”</button>
                </div>
            `;
        }
    </script>
</body>
</html>
